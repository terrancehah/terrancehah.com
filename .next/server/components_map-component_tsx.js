"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "components_map-component_tsx";
exports.ids = ["components_map-component_tsx"];
exports.modules = {

/***/ "./components/map-component.tsx":
/*!**************************************!*\
  !*** ./components/map-component.tsx ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_script__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/script */ \"./node_modules/next/script.js\");\n/* harmony import */ var next_script__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_script__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_places_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/utils/places-utils */ \"./utils/places-utils.ts\");\n\n\n\n\n// Keep for backward compatibility\nconst globalSavedPlaces = _utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.savedPlacesManager.places;\nconst MapComponent = ({ city, apiKey })=>{\n    const mapRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const [map, setMap] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [markers, setMarkers] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(new Map());\n    const [infoWindow, setInfoWindow] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [error, setError] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [isLoading, setIsLoading] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(true);\n    const [scriptLoaded, setScriptLoaded] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [selectedPlace, setSelectedPlace] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [savedPlaces, setSavedPlaces] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(new Map());\n    const markersRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(new Map());\n    const infoWindowRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const [markerCount, setMarkerCount] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(0);\n    // Memoize getSavedPlaces to prevent unnecessary re-renders\n    // const getSavedPlaces = useCallback(() => {\n    //     const now = Date.now();\n    //     // Only update if more than 1000ms has passed since last update\n    //     if (now - lastUpdateRef.current < 1000) {\n    //         return savedPlacesRef.current;\n    //     }\n    //     lastUpdateRef.current = now;\n    //     return savedPlacesRef.current;\n    // }, []);\n    // Expose getSavedPlaces to window with debouncing\n    // useEffect(() => {\n    //     if (typeof window !== 'undefined') {\n    //         window.getSavedPlaces = getSavedPlaces;\n    //     }\n    //     return () => {\n    //         if (typeof window !== 'undefined') {\n    //             delete window.getSavedPlaces;\n    //         }\n    //     };\n    // }, [getSavedPlaces]);\n    // // Update savedPlacesRef when places are added/removed\n    // const updateSavedPlaces = useCallback((places: Place[]) => {\n    //     savedPlacesRef.current = places;\n    //     lastUpdateRef.current = Date.now();\n    // }, []);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        console.log(\"MapComponent: Received props:\", {\n            city,\n            apiKeyLength: apiKey?.length\n        });\n        if (!apiKey) {\n            console.error(\"MapComponent: Google Maps API key is missing\");\n            setError(\"Google Maps API key is missing\");\n            setIsLoading(false);\n            return;\n        }\n        if (!scriptLoaded || !mapRef.current) {\n            console.log(\"MapComponent: Waiting for script to load or map ref to be ready...\");\n            return;\n        }\n        console.log(\"MapComponent: Initializing map with city:\", city);\n        const initMap = async ()=>{\n            try {\n                // Import required libraries\n                const { Map: Map1 } = await window.google.maps.importLibrary(\"maps\");\n                const { AdvancedMarkerElement } = await google.maps.importLibrary(\"marker\");\n                const geocoder = new window.google.maps.Geocoder();\n                geocoder.geocode({\n                    address: city\n                }, async (results, status)=>{\n                    console.log(\"Geocoding response:\", {\n                        status,\n                        resultsLength: results?.length\n                    });\n                    if (status !== \"OK\" || !results?.[0]?.geometry?.location) {\n                        console.error(\"Geocoding failed:\", status);\n                        setError(`Could not find location for ${city}`);\n                        setIsLoading(false);\n                        return;\n                    }\n                    try {\n                        const location = results[0].geometry.location;\n                        const newMap = new Map1(mapRef.current, {\n                            center: location,\n                            zoom: 12,\n                            mapId: \"2d604af04a7c7fa8\"\n                        });\n                        setMap(newMap);\n                        const newInfoWindow = new google.maps.InfoWindow({\n                            maxWidth: 400\n                        });\n                        setInfoWindow(newInfoWindow);\n                        infoWindowRef.current = newInfoWindow;\n                        const createCityInfoWindowContent = async (city, location)=>{\n                            try {\n                                // Search for the city to get its details including photos\n                                const cityPlace = await (0,_utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.searchPlaceByText)(city, {\n                                    latitude: location.lat(),\n                                    longitude: location.lng()\n                                }, city);\n                                if (!cityPlace) return null;\n                                // Create a photo carousel HTML\n                                const photoCarousel = cityPlace.photos && cityPlace.photos.length > 0 ? `\n                                            <div class=\"relative w-full\" style=\"height: 200px;\">\n                                                <div class=\"carousel-container overflow-hidden w-full h-full\">\n                                                    <div class=\"carousel-track flex transition-transform duration-500\" style=\"height: 100%;\">\n                                                        ${cityPlace.photos.slice(0, 5).map((photo, index)=>`\n                                                            <div class=\"carousel-slide w-full h-full flex-none\">\n                                                                <img src=\"https://places.googleapis.com/v1/${photo.name}/media?maxHeightPx=340&maxWidthPx=340&key=${apiKey}\"\n                                                                    alt=\"${city}\"\n                                                                    class=\"w-full h-full object-cover\"\n                                                                />\n                                                            </div>\n                                                        `).join(\"\")}\n                                                    </div>\n                                                </div>\n                                                <button onclick=\"window.prevSlide()\" class=\"absolute left-2 top-1/2 transform -translate-y-1/2 bg-white/80 rounded-full p-1 shadow-md hover:bg-white\">\n                                                    <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" class=\"w-5 h-5\">\n                                                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M15.75 19.5L8.25 12l7.5-7.5\" />\n                                                    </svg>\n                                                </button>\n                                                <button onclick=\"window.nextSlide()\" class=\"absolute right-2 top-1/2 transform -translate-y-1/2 bg-white/80 rounded-full p-1 shadow-md hover:bg-white\">\n                                                    <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" class=\"w-5 h-5\">\n                                                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M8.25 4.5l7.5 7.5-7.5 7.5\" />\n                                                    </svg>\n                                                </button>\n                                                <div class=\"absolute bottom-2 left-0 right-0 flex justify-center gap-1\">\n                                                    ${cityPlace.photos.slice(0, 5).map((_, index)=>`\n                                                        <button onclick=\"window.goToSlide(${index})\" class=\"w-2 h-2 rounded-full bg-white/80 hover:bg-white shadow-sm carousel-dot\" data-index=\"${index}\">\n                                                        </button>\n                                                    `).join(\"\")}\n                                                </div>\n                                            </div>\n                                        ` : \"\";\n                                // Add carousel control functions to window\n                                if (cityPlace.photos && cityPlace.photos.length > 0) {\n                                    const numSlides = Math.min(cityPlace.photos.length, 5);\n                                    window.currentSlide = 0;\n                                    window.updateCarousel = ()=>{\n                                        const track = document.querySelector(\".carousel-track\");\n                                        if (track) {\n                                            track.style.transform = `translateX(-${window.currentSlide * 100}%)`;\n                                            // Update dots\n                                            document.querySelectorAll(\".carousel-dot\").forEach((dot, index)=>{\n                                                if (index === window.currentSlide) {\n                                                    dot.classList.add(\"bg-white\");\n                                                    dot.classList.remove(\"bg-white/80\");\n                                                } else {\n                                                    dot.classList.remove(\"bg-white\");\n                                                    dot.classList.add(\"bg-white/80\");\n                                                }\n                                            });\n                                        }\n                                    };\n                                    window.nextSlide = ()=>{\n                                        window.currentSlide = (window.currentSlide + 1) % numSlides;\n                                        window.updateCarousel();\n                                    };\n                                    window.prevSlide = ()=>{\n                                        window.currentSlide = (window.currentSlide - 1 + numSlides) % numSlides;\n                                        window.updateCarousel();\n                                    };\n                                    window.goToSlide = (index)=>{\n                                        window.currentSlide = index;\n                                        window.updateCarousel();\n                                    };\n                                }\n                                return `\n                                        <div class=\"bg-white rounded-lg shadow-sm\" style=\"max-width: 340px;\">\n                                            ${photoCarousel}\n                                            <div class=\"p-4\">\n                                                <h2 class=\"text-xl font-semibold text-gray-900 mb-2\">${city}</h2>\n                                                ${cityPlace.formattedAddress ? `<p class=\"text-sm text-gray-500 mb-2\">${cityPlace.formattedAddress}</p>` : \"\"}\n                                            </div>\n                                        </div>\n                                    `;\n                            } catch (error) {\n                                console.error(\"Error creating city info window:\", error);\n                                return null;\n                            }\n                        };\n                        // Create a marker for the city\n                        const cityMarker = new google.maps.marker.AdvancedMarkerElement({\n                            map: newMap,\n                            position: location,\n                            title: city\n                        });\n                        // Add click listener to the marker\n                        cityMarker.addListener(\"gmp-click\", async ()=>{\n                            if (infoWindow) {\n                                const content = createCityInfoWindowContent(city, location);\n                                if (content) {\n                                    infoWindow.setContent(await content);\n                                    infoWindow.open(newMap, cityMarker);\n                                }\n                            }\n                        });\n                        markers.set(city, cityMarker);\n                        // Add click listener for future interaction\n                        cityMarker.addListener(\"gmp-click\", async ()=>{\n                            const content = await createCityInfoWindowContent(city, location);\n                            if (content) {\n                                newInfoWindow.setContent(content);\n                                newInfoWindow.open({\n                                    anchor: cityMarker,\n                                    map: newMap\n                                });\n                            }\n                        });\n                    } catch (err) {\n                        console.error(\"Error setting up map:\", err);\n                        setError(\"Failed to initialize map\");\n                    }\n                });\n            } catch (err) {\n                console.error(\"Error initializing map:\", err);\n                setError(\"Failed to initialize map\");\n                setIsLoading(false);\n            }\n        };\n        initMap();\n    }, [\n        city,\n        scriptLoaded,\n        apiKey\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        if (!map) return;\n        window.removePlaceFromMap = (placeId)=>{\n            console.log(\"Debug - Starting removal process for placeId:\", placeId);\n            // Remove from global storage\n            _utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.savedPlacesManager.removePlace(placeId);\n            try {\n                const marker = markersRef.current.get(placeId);\n                if (marker) {\n                    console.log(\"Debug - Found marker:\", marker);\n                    // Simply set the map to null to remove the marker\n                    marker.position = null;\n                    // Close info window if open\n                    if (infoWindowRef.current) {\n                        infoWindowRef.current.close();\n                    }\n                    // Remove event listeners\n                    google.maps.event.clearInstanceListeners(marker);\n                    // Clean up references\n                    markersRef.current.delete(placeId);\n                    _utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.savedPlacesManager.removePlace(placeId);\n                    // Force update component state\n                    setMarkerCount((prev)=>prev - 1);\n                    setSavedPlaces(new Map(_utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.savedPlacesManager.places));\n                    console.log(\"Debug - After removal markers:\", [\n                        ...markersRef.current.entries()\n                    ]);\n                    console.log(\"Debug - Successfully removed marker and place:\", placeId);\n                } else {\n                    console.warn(\"Debug - Could not find marker for placeId:\", placeId);\n                }\n            } catch (error) {\n                console.error(\"Debug - Error during marker removal:\", error);\n            }\n            // Notify components that places changed\n            window.dispatchEvent(new CustomEvent(\"savedPlacesChanged\", {\n                detail: {\n                    places: Array.from(_utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.savedPlacesManager.places.values()),\n                    count: _utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.savedPlacesManager.places.size\n                }\n            }));\n        };\n        window.addPlaceToMap = async (data)=>{\n            try {\n                // Add this check at the start of the function\n                const markerId = data.place?.id;\n                if (!markerId) {\n                    console.error(\"Debug - No place ID provided\");\n                    return;\n                }\n                // Add this check for duplicates\n                if (_utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.savedPlacesManager.hasPlace(markerId)) {\n                    console.log(\"Debug - Place already exists:\", markerId);\n                    return;\n                }\n                // Add to global storage first\n                if (data.place) {\n                    _utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.savedPlacesManager.addPlace(data.place);\n                    // Force a re-render when adding a marker\n                    setMarkerCount((prev)=>prev + 1);\n                    setSavedPlaces(new Map(_utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.savedPlacesManager.places));\n                    console.log(\"Debug - Added place:\", _utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.savedPlacesManager.places);\n                }\n                const [{ AdvancedMarkerElement }, { PinElement }] = await Promise.all([\n                    google.maps.importLibrary(\"marker\"),\n                    google.maps.importLibrary(\"marker\")\n                ]);\n                const pinElement = new google.maps.marker.PinElement({\n                    scale: 1\n                });\n                console.log(\"Debug - Creating marker with ID:\", markerId);\n                // Remove existing marker if it exists\n                if (markersRef.current.has(markerId)) {\n                    const existingMarker = markersRef.current.get(markerId);\n                    if (existingMarker) {\n                        existingMarker.map = null;\n                        if (existingMarker.element) {\n                            existingMarker.element.remove();\n                        }\n                        markersRef.current.delete(markerId);\n                    }\n                }\n                const marker = new google.maps.marker.AdvancedMarkerElement({\n                    position: {\n                        lat: data.latitude,\n                        lng: data.longitude\n                    },\n                    title: data.title,\n                    content: pinElement.element,\n                    gmpDraggable: false\n                });\n                // Set the map property after creation\n                marker.map = map;\n                // Add click listener\n                marker.addListener(\"gmp-click\", ()=>{\n                    if (data.place) {\n                        window.currentInfoWindowMarker = {\n                            markerId: markerId,\n                            marker: marker\n                        };\n                        const content = createPlaceInfoWindowContent(data.place, markerId);\n                        if (content && infoWindowRef.current) {\n                            infoWindowRef.current.setContent(content);\n                            infoWindowRef.current.open(map, marker);\n                        }\n                    }\n                });\n                // Store the marker reference\n                // markersRef.current.set(markerId, marker);\n                // if (data.place) {\n                //     savedPlacesManager.addPlace(data.place);\n                //     // Force a re-render when adding a marker\n                //     setMarkerCount(prev => prev + 1);\n                //     setSavedPlaces(new Map(savedPlacesManager.places));\n                //     console.log('Debug - Added place:', savedPlacesManager.places);\n                // }\n                // console.log('Debug - Marker added successfully');\n                // Notify components that places changed\n                window.dispatchEvent(new CustomEvent(\"savedPlacesChanged\", {\n                    detail: {\n                        places: Array.from(_utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.savedPlacesManager.places.values()),\n                        count: _utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.savedPlacesManager.places.size\n                    }\n                }));\n            } catch (err) {\n                console.error(\"Error adding place marker:\", err);\n            }\n        };\n        window.getSavedPlaces = ()=>{\n            return _utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.savedPlacesManager.getPlaces();\n        };\n    }, [\n        map,\n        infoWindow,\n        markerCount\n    ]);\n    // // Add a useEffect to monitor savedPlaces changes\n    // useEffect(() => {\n    //     console.log('Current saved places:', [...globalSavedPlaces.entries()]);\n    // }, [savedPlaces]);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        const handleVisibilityChange = ()=>{\n            if (document.visibilityState === \"visible\" && map) {\n                window.google?.maps?.event?.trigger(map, \"resize\");\n            }\n        };\n        document.addEventListener(\"visibilitychange\", handleVisibilityChange);\n        return ()=>{\n            document.removeEventListener(\"visibilitychange\", handleVisibilityChange);\n        };\n    }, [\n        map\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        // Load saved places from session storage on mount\n        const sessionData = sessionStorage.getItem(\"travelPlannerSession\");\n        if (sessionData) {\n            try {\n                const parsed = JSON.parse(sessionData);\n                if (parsed.savedPlaces) {\n                    parsed.savedPlaces.forEach((place)=>{\n                        if (place.id) {\n                            _utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.savedPlacesManager.addPlace(place);\n                        }\n                    });\n                    // Notify components of initial load\n                    window.dispatchEvent(new CustomEvent(\"savedPlacesChanged\", {\n                        detail: {\n                            places: Array.from(_utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.savedPlacesManager.places.values()),\n                            count: _utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.savedPlacesManager.places.size\n                        }\n                    }));\n                }\n            } catch (error) {\n                console.error(\"Error loading saved places from session:\", error);\n            }\n        }\n    }, []);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        // Save to session storage when places change\n        const sessionData = sessionStorage.getItem(\"travelPlannerSession\");\n        if (sessionData) {\n            try {\n                const parsed = JSON.parse(sessionData);\n                sessionStorage.setItem(\"travelPlannerSession\", JSON.stringify({\n                    ...parsed,\n                    savedPlaces: _utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.savedPlacesManager.getPlaces()\n                }));\n            } catch (error) {\n                console.error(\"Error saving places to session:\", error);\n            }\n        }\n    }, [\n        savedPlaces\n    ]);\n    const getPhotoUrl = (photo, index)=>{\n        return photo.getURI?.() || \"\";\n    };\n    const handleSlideChange = (_, index)=>{\n        if (window.currentSlide !== undefined) {\n            window.currentSlide = index;\n        }\n    };\n    const createPlaceInfoWindowContent = (place, markerId)=>{\n        console.log(\"Debug - Creating info window content for markerId:\", markerId);\n        const photoUrl = place.photos && place.photos[0] ? `https://places.googleapis.com/v1/${place.photos[0].name}/media?maxHeightPx=200&maxWidthPx=300&key=${apiKey}` : \"\";\n        const placeTitle = typeof place.displayName === \"string\" ? place.displayName : place.displayName.text;\n        return `\n            <div class=\"bg-white rounded-lg shadow-sm\" style=\"max-width: 300px;\">\n                ${photoUrl ? `\n                    <div style=\"height: 150px; width: 100%;\">\n                        <img src=\"${photoUrl}\" \n                            alt=\"${placeTitle}\"\n                            style=\"width: 100%; height: 100%; object-fit: cover; border-top-left-radius: 0.5rem; border-top-right-radius: 0.5rem;\"\n                        />\n                    </div>\n                ` : \"\"}\n\n                <div class=\"p-3\">\n                    <div class=\"flex justify-between items-start\">\n                        <h3 class=\"text-lg font-semibold text-gray-900 mb-1\">\n                            ${placeTitle}\n                        </h3>\n                        <button \n                            onclick=\"\n                                (function() {\n                                    console.log('Debug - Delete button clicked for markerId:', '${markerId}');\n                                    if (window.removePlaceFromMap) {\n                                        window.removePlaceFromMap('${markerId}');\n                                        // Close the info window after deletion\n                                        if (window.currentInfoWindow) {\n                                            window.currentInfoWindow.close();\n                                        }\n                                    }\n                                })();\n                            \"\n                            class=\"p-1 hover:bg-red-50 rounded-full\"\n                            aria-label=\"Remove place\"\n                        >\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-5 w-5 text-red-500\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                <path fill-rule=\"evenodd\" d=\"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z\" clip-rule=\"evenodd\" />\n                            </svg>\n                        </button>\n                    </div>\n                    ${place.primaryTypeDisplayName ? `<div class=\"text-sm text-gray-600 mb-1\">${place.primaryTypeDisplayName.text}</div>` : \"\"}\n                    ${place.formattedAddress ? `<p class=\"text-sm text-gray-500\">${place.formattedAddress}</p>` : \"\"}\n                </div>\n            </div>\n        `;\n    };\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"relative w-full h-full\",\n        children: [\n            apiKey && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)((next_script__WEBPACK_IMPORTED_MODULE_2___default()), {\n                src: `https://maps.googleapis.com/maps/api/js?key=${apiKey}&libraries=places,marker&v=beta&callback=Function.prototype`,\n                strategy: \"afterInteractive\",\n                onLoad: ()=>{\n                    console.log(\"Google Maps script loaded\");\n                    setScriptLoaded(true);\n                },\n                onError: (e)=>{\n                    console.error(\"Failed to load Google Maps script:\", e);\n                    setError(\"Failed to load Google Maps\");\n                    setIsLoading(false);\n                }\n            }, void 0, false, {\n                fileName: \"/Users/terrancehah/Documents/terrancehah.com/components/map-component.tsx\",\n                lineNumber: 598,\n                columnNumber: 17\n            }, undefined),\n            error && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"absolute inset-0 flex items-center justify-center bg-gray-100 text-red-500 p-4 text-center\",\n                children: error\n            }, void 0, false, {\n                fileName: \"/Users/terrancehah/Documents/terrancehah.com/components/map-component.tsx\",\n                lineNumber: 613,\n                columnNumber: 17\n            }, undefined),\n            isLoading && !error && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"absolute inset-0 flex items-center justify-center bg-gray-100\",\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"text-gray-600\",\n                    children: [\n                        \"Loading map...\",\n                        !apiKey && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            children: \"Waiting for API key...\"\n                        }, void 0, false, {\n                            fileName: \"/Users/terrancehah/Documents/terrancehah.com/components/map-component.tsx\",\n                            lineNumber: 621,\n                            columnNumber: 37\n                        }, undefined)\n                    ]\n                }, void 0, true, {\n                    fileName: \"/Users/terrancehah/Documents/terrancehah.com/components/map-component.tsx\",\n                    lineNumber: 619,\n                    columnNumber: 21\n                }, undefined)\n            }, void 0, false, {\n                fileName: \"/Users/terrancehah/Documents/terrancehah.com/components/map-component.tsx\",\n                lineNumber: 618,\n                columnNumber: 17\n            }, undefined),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                ref: mapRef,\n                className: \"w-full h-full\"\n            }, void 0, false, {\n                fileName: \"/Users/terrancehah/Documents/terrancehah.com/components/map-component.tsx\",\n                lineNumber: 625,\n                columnNumber: 13\n            }, undefined)\n        ]\n    }, void 0, true, {\n        fileName: \"/Users/terrancehah/Documents/terrancehah.com/components/map-component.tsx\",\n        lineNumber: 596,\n        columnNumber: 9\n    }, undefined);\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (MapComponent);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkFBZ0IsR0FDbEIsQ0FBQyxpQ0FBaUMsRUFBRWtDLE1BQU1sQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsR0FDaEUsR0FBRzs7O1FBR3JCLENBQUM7SUFDTDtJQUVBLHFCQUNJLDhEQUFDeUU7UUFBSUMsV0FBVTs7WUFDVjdKLHdCQUNHLDhEQUFDUCxvREFBTUE7Z0JBQ0hxSyxLQUFLLENBQUMsNENBQTRDLEVBQUU5SixPQUFPLDJEQUEyRCxDQUFDO2dCQUN2SCtKLFVBQVM7Z0JBQ1RDLFFBQVE7b0JBQ0p6SSxRQUFRQyxHQUFHLENBQUM7b0JBQ1pWLGdCQUFnQjtnQkFDcEI7Z0JBQ0FtSixTQUFTLENBQUNDO29CQUNOM0ksUUFBUWQsS0FBSyxDQUFDLHNDQUFzQ3lKO29CQUNwRHhKLFNBQVM7b0JBQ1RFLGFBQWE7Z0JBQ2pCOzs7Ozs7WUFHUEgsdUJBQ0csOERBQUNtSjtnQkFBSUMsV0FBVTswQkFDVnBKOzs7Ozs7WUFHUkUsYUFBYSxDQUFDRix1QkFDWCw4REFBQ21KO2dCQUFJQyxXQUFVOzBCQUNYLDRFQUFDRDtvQkFBSUMsV0FBVTs7d0JBQWdCO3dCQUUxQixDQUFDN0osd0JBQVUsOERBQUM0SjtzQ0FBSTs7Ozs7Ozs7Ozs7Ozs7Ozs7MEJBSTdCLDhEQUFDQTtnQkFBSU8sS0FBS2xLO2dCQUFRNEosV0FBVTs7Ozs7Ozs7Ozs7O0FBU3hDO0FBRUEsaUVBQWUvSixZQUFZQSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJhdmVsLXJpenovLi9jb21wb25lbnRzL21hcC1jb21wb25lbnQudHN4PzM0MGYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCwgdXNlUmVmLCB1c2VTdGF0ZSwgdXNlQ2FsbGJhY2ssIHVzZU1lbW8gfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgU2NyaXB0IGZyb20gJ25leHQvc2NyaXB0JztcbmltcG9ydCB7IFBsYWNlLCBzYXZlZFBsYWNlc01hbmFnZXIsIHNlYXJjaFBsYWNlQnlUZXh0IH0gZnJvbSAnQC91dGlscy9wbGFjZXMtdXRpbHMnO1xuXG5pbnRlcmZhY2UgTWFwQ29tcG9uZW50UHJvcHMge1xuICAgIGNpdHk6IHN0cmluZztcbiAgICBhcGlLZXk6IHN0cmluZztcbn1cblxuLy8gS2VlcCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuY29uc3QgZ2xvYmFsU2F2ZWRQbGFjZXMgPSBzYXZlZFBsYWNlc01hbmFnZXIucGxhY2VzO1xuXG5kZWNsYXJlIGdsb2JhbCB7XG4gICAgaW50ZXJmYWNlIFdpbmRvdyB7XG4gICAgICAgIGluaXRNYXA6ICgpID0+IHZvaWQ7XG4gICAgICAgIGN1cnJlbnRTbGlkZTogbnVtYmVyO1xuICAgICAgICBjdXJyZW50SW5mb1dpbmRvdz86IGdvb2dsZS5tYXBzLkluZm9XaW5kb3c7XG4gICAgICAgIHVwZGF0ZUNhcm91c2VsOiAoKSA9PiB2b2lkO1xuICAgICAgICBuZXh0U2xpZGU6ICgpID0+IHZvaWQ7XG4gICAgICAgIHByZXZTbGlkZTogKCkgPT4gdm9pZDtcbiAgICAgICAgZ29Ub1NsaWRlOiAoaW5kZXg6IG51bWJlcikgPT4gdm9pZDtcbiAgICAgICAgZ29vZ2xlOiB0eXBlb2YgZ29vZ2xlO1xuICAgICAgICByZW1vdmVQbGFjZUZyb21NYXA/OiAodGl0bGU6IHN0cmluZykgPT4gdm9pZDtcbiAgICAgICAgY3VycmVudEluZm9XaW5kb3dNYXJrZXI/OiB7XG4gICAgICAgICAgICBtYXJrZXJJZDogc3RyaW5nO1xuICAgICAgICAgICAgbWFya2VyOiBnb29nbGUubWFwcy5tYXJrZXIuQWR2YW5jZWRNYXJrZXJFbGVtZW50O1xuICAgICAgICB9O1xuICAgICAgICBhZGRQbGFjZVRvTWFwPzogKHBsYWNlOiB7IFxuICAgICAgICAgICAgbGF0aXR1ZGU6IG51bWJlcjsgXG4gICAgICAgICAgICBsb25naXR1ZGU6IG51bWJlcjsgXG4gICAgICAgICAgICB0aXRsZT86IHN0cmluZztcbiAgICAgICAgICAgIHBsYWNlPzogUGxhY2U7XG4gICAgICAgIH0pID0+IHZvaWQ7XG4gICAgICAgIGNsZWFyUGxhY2VNYXJrZXJzPzogKCkgPT4gdm9pZDtcbiAgICAgICAgc2F2ZWRQbGFjZXM6IFBsYWNlW107XG4gICAgICAgIGdldFNhdmVkUGxhY2VzPzogKCkgPT4gUGxhY2VbXTtcbiAgICB9XG59XG5cbi8vIE1vZGlmeSBtYXAtY29tcG9uZW50LnRzeCB0byBleHBvc2UgYSBwcm9wZXIgZ2xvYmFsIGludGVyZmFjZVxuLy8gQXQgdGhlIHRvcCBvZiBmaWxlXG5pbnRlcmZhY2UgU2F2ZWRQbGFjZXNNYW5hZ2VyIHtcbiAgICBhZGRQbGFjZTogKHBsYWNlOiBQbGFjZSkgPT4gdm9pZDtcbiAgICByZW1vdmVQbGFjZTogKHBsYWNlSWQ6IHN0cmluZykgPT4gdm9pZDtcbiAgICBnZXRQbGFjZXM6ICgpID0+IFBsYWNlW107XG4gICAgaGFzUGxhY2U6IChwbGFjZUlkOiBzdHJpbmcpID0+IGJvb2xlYW47XG59XG5cbi8vIEV4cG9zZSB0eXBlLXNhZmUgZ2xvYmFsIG1ldGhvZHNcbmRlY2xhcmUgZ2xvYmFsIHtcbiAgICBpbnRlcmZhY2UgV2luZG93IHtcbiAgICAgICAgc2F2ZWRQbGFjZXNNYW5hZ2VyOiBTYXZlZFBsYWNlc01hbmFnZXI7XG4gICAgfVxufVxuXG5kZWNsYXJlIGdsb2JhbCB7XG4gICAgbmFtZXNwYWNlIGdvb2dsZS5tYXBzIHtcbiAgICAgICAgaW50ZXJmYWNlIE1hcmtlckxpYnJhcnkge1xuICAgICAgICAgICAgQWR2YW5jZWRNYXJrZXJFbGVtZW50OiB0eXBlb2YgZ29vZ2xlLm1hcHMubWFya2VyLkFkdmFuY2VkTWFya2VyRWxlbWVudDtcbiAgICAgICAgICAgIFBpbkVsZW1lbnQ6IHR5cGVvZiBnb29nbGUubWFwcy5tYXJrZXIuUGluRWxlbWVudDtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuXG5jb25zdCBNYXBDb21wb25lbnQ6IFJlYWN0LkZDPE1hcENvbXBvbmVudFByb3BzPiA9ICh7IGNpdHksIGFwaUtleSB9KSA9PiB7XG4gICAgY29uc3QgbWFwUmVmID0gdXNlUmVmPEhUTUxEaXZFbGVtZW50PihudWxsKTtcbiAgICBjb25zdCBbbWFwLCBzZXRNYXBdID0gdXNlU3RhdGU8Z29vZ2xlLm1hcHMuTWFwIHwgbnVsbD4obnVsbCk7XG4gICAgY29uc3QgW21hcmtlcnMsIHNldE1hcmtlcnNdID0gdXNlU3RhdGU8TWFwPHN0cmluZywgZ29vZ2xlLm1hcHMubWFya2VyLkFkdmFuY2VkTWFya2VyRWxlbWVudD4+KG5ldyBNYXAoKSk7XG4gICAgY29uc3QgW2luZm9XaW5kb3csIHNldEluZm9XaW5kb3ddID0gdXNlU3RhdGU8Z29vZ2xlLm1hcHMuSW5mb1dpbmRvdyB8IG51bGw+KG51bGwpO1xuICAgIGNvbnN0IFtlcnJvciwgc2V0RXJyb3JdID0gdXNlU3RhdGU8c3RyaW5nIHwgbnVsbD4obnVsbCk7XG4gICAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlKHRydWUpO1xuICAgIGNvbnN0IFtzY3JpcHRMb2FkZWQsIHNldFNjcmlwdExvYWRlZF0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gICAgY29uc3QgW3NlbGVjdGVkUGxhY2UsIHNldFNlbGVjdGVkUGxhY2VdID0gdXNlU3RhdGU8UGxhY2UgfCBudWxsPihudWxsKTtcbiAgICBjb25zdCBbc2F2ZWRQbGFjZXMsIHNldFNhdmVkUGxhY2VzXSA9IHVzZVN0YXRlPE1hcDxzdHJpbmcsIFBsYWNlPj4obmV3IE1hcCgpKTtcbiAgICBjb25zdCBtYXJrZXJzUmVmID0gdXNlUmVmPE1hcDxzdHJpbmcsIGdvb2dsZS5tYXBzLm1hcmtlci5BZHZhbmNlZE1hcmtlckVsZW1lbnQ+PihuZXcgTWFwKCkpO1xuICAgIGNvbnN0IGluZm9XaW5kb3dSZWYgPSB1c2VSZWY8Z29vZ2xlLm1hcHMuSW5mb1dpbmRvdyB8IG51bGw+KG51bGwpO1xuICAgIGNvbnN0IFttYXJrZXJDb3VudCwgc2V0TWFya2VyQ291bnRdID0gdXNlU3RhdGUoMCk7XG5cbiAgICAvLyBNZW1vaXplIGdldFNhdmVkUGxhY2VzIHRvIHByZXZlbnQgdW5uZWNlc3NhcnkgcmUtcmVuZGVyc1xuICAgIC8vIGNvbnN0IGdldFNhdmVkUGxhY2VzID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIC8vICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIC8vICAgICAvLyBPbmx5IHVwZGF0ZSBpZiBtb3JlIHRoYW4gMTAwMG1zIGhhcyBwYXNzZWQgc2luY2UgbGFzdCB1cGRhdGVcbiAgICAvLyAgICAgaWYgKG5vdyAtIGxhc3RVcGRhdGVSZWYuY3VycmVudCA8IDEwMDApIHtcbiAgICAvLyAgICAgICAgIHJldHVybiBzYXZlZFBsYWNlc1JlZi5jdXJyZW50O1xuICAgIC8vICAgICB9XG4gICAgLy8gICAgIGxhc3RVcGRhdGVSZWYuY3VycmVudCA9IG5vdztcbiAgICAvLyAgICAgcmV0dXJuIHNhdmVkUGxhY2VzUmVmLmN1cnJlbnQ7XG4gICAgLy8gfSwgW10pO1xuXG4gICAgLy8gRXhwb3NlIGdldFNhdmVkUGxhY2VzIHRvIHdpbmRvdyB3aXRoIGRlYm91bmNpbmdcbiAgICAvLyB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIC8vICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAvLyAgICAgICAgIHdpbmRvdy5nZXRTYXZlZFBsYWNlcyA9IGdldFNhdmVkUGxhY2VzO1xuICAgIC8vICAgICB9XG4gICAgLy8gICAgIHJldHVybiAoKSA9PiB7XG4gICAgLy8gICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAvLyAgICAgICAgICAgICBkZWxldGUgd2luZG93LmdldFNhdmVkUGxhY2VzO1xuICAgIC8vICAgICAgICAgfVxuICAgIC8vICAgICB9O1xuICAgIC8vIH0sIFtnZXRTYXZlZFBsYWNlc10pO1xuXG4gICAgLy8gLy8gVXBkYXRlIHNhdmVkUGxhY2VzUmVmIHdoZW4gcGxhY2VzIGFyZSBhZGRlZC9yZW1vdmVkXG4gICAgLy8gY29uc3QgdXBkYXRlU2F2ZWRQbGFjZXMgPSB1c2VDYWxsYmFjaygocGxhY2VzOiBQbGFjZVtdKSA9PiB7XG4gICAgLy8gICAgIHNhdmVkUGxhY2VzUmVmLmN1cnJlbnQgPSBwbGFjZXM7XG4gICAgLy8gICAgIGxhc3RVcGRhdGVSZWYuY3VycmVudCA9IERhdGUubm93KCk7XG4gICAgLy8gfSwgW10pO1xuXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ01hcENvbXBvbmVudDogUmVjZWl2ZWQgcHJvcHM6JywgeyBjaXR5LCBhcGlLZXlMZW5ndGg6IGFwaUtleT8ubGVuZ3RoIH0pO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFhcGlLZXkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ01hcENvbXBvbmVudDogR29vZ2xlIE1hcHMgQVBJIGtleSBpcyBtaXNzaW5nJyk7XG4gICAgICAgICAgICBzZXRFcnJvcignR29vZ2xlIE1hcHMgQVBJIGtleSBpcyBtaXNzaW5nJyk7XG4gICAgICAgICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFzY3JpcHRMb2FkZWQgfHwgIW1hcFJlZi5jdXJyZW50KSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnTWFwQ29tcG9uZW50OiBXYWl0aW5nIGZvciBzY3JpcHQgdG8gbG9hZCBvciBtYXAgcmVmIHRvIGJlIHJlYWR5Li4uJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zb2xlLmxvZygnTWFwQ29tcG9uZW50OiBJbml0aWFsaXppbmcgbWFwIHdpdGggY2l0eTonLCBjaXR5KTtcbiAgICAgICAgY29uc3QgaW5pdE1hcCA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gSW1wb3J0IHJlcXVpcmVkIGxpYnJhcmllc1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgTWFwIH0gPSBhd2FpdCB3aW5kb3cuZ29vZ2xlLm1hcHMuaW1wb3J0TGlicmFyeShcIm1hcHNcIikgYXMgZ29vZ2xlLm1hcHMuTWFwc0xpYnJhcnk7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBBZHZhbmNlZE1hcmtlckVsZW1lbnQgfSA9IGF3YWl0IGdvb2dsZS5tYXBzLmltcG9ydExpYnJhcnkoXCJtYXJrZXJcIikgYXMgZ29vZ2xlLm1hcHMuTWFya2VyTGlicmFyeTtcbiAgICAgICAgICAgICAgICBjb25zdCBnZW9jb2RlciA9IG5ldyB3aW5kb3cuZ29vZ2xlLm1hcHMuR2VvY29kZXIoKTtcblxuICAgICAgICAgICAgICAgIGdlb2NvZGVyLmdlb2NvZGUoXG4gICAgICAgICAgICAgICAgICAgIHsgYWRkcmVzczogY2l0eSB9LFxuICAgICAgICAgICAgICAgICAgICBhc3luYyAocmVzdWx0cywgc3RhdHVzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnR2VvY29kaW5nIHJlc3BvbnNlOicsIHsgc3RhdHVzLCByZXN1bHRzTGVuZ3RoOiByZXN1bHRzPy5sZW5ndGggfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGF0dXMgIT09ICdPSycgfHwgIXJlc3VsdHM/LlswXT8uZ2VvbWV0cnk/LmxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignR2VvY29kaW5nIGZhaWxlZDonLCBzdGF0dXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldEVycm9yKGBDb3VsZCBub3QgZmluZCBsb2NhdGlvbiBmb3IgJHtjaXR5fWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxvY2F0aW9uID0gcmVzdWx0c1swXS5nZW9tZXRyeS5sb2NhdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdNYXAgPSBuZXcgTWFwKG1hcFJlZi5jdXJyZW50ISwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZW50ZXI6IGxvY2F0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB6b29tOiAxMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwSWQ6ICcyZDYwNGFmMDRhN2M3ZmE4JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRNYXAobmV3TWFwKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0luZm9XaW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFdpZHRoOiA0MDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRJbmZvV2luZG93KG5ld0luZm9XaW5kb3cpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3dSZWYuY3VycmVudCA9IG5ld0luZm9XaW5kb3c7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjcmVhdGVDaXR5SW5mb1dpbmRvd0NvbnRlbnQgPSBhc3luYyAoY2l0eTogc3RyaW5nLCBsb2NhdGlvbjogZ29vZ2xlLm1hcHMuTGF0TG5nKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTZWFyY2ggZm9yIHRoZSBjaXR5IHRvIGdldCBpdHMgZGV0YWlscyBpbmNsdWRpbmcgcGhvdG9zXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaXR5UGxhY2UgPSBhd2FpdCBzZWFyY2hQbGFjZUJ5VGV4dChjaXR5LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF0aXR1ZGU6IGxvY2F0aW9uLmxhdCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvbmdpdHVkZTogbG9jYXRpb24ubG5nKCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgY2l0eSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY2l0eVBsYWNlKSByZXR1cm4gbnVsbDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIGEgcGhvdG8gY2Fyb3VzZWwgSFRNTFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGhvdG9DYXJvdXNlbCA9IGNpdHlQbGFjZS5waG90b3MgJiYgY2l0eVBsYWNlLnBob3Rvcy5sZW5ndGggPiAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJyZWxhdGl2ZSB3LWZ1bGxcIiBzdHlsZT1cImhlaWdodDogMjAwcHg7XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2Fyb3VzZWwtY29udGFpbmVyIG92ZXJmbG93LWhpZGRlbiB3LWZ1bGwgaC1mdWxsXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNhcm91c2VsLXRyYWNrIGZsZXggdHJhbnNpdGlvbi10cmFuc2Zvcm0gZHVyYXRpb24tNTAwXCIgc3R5bGU9XCJoZWlnaHQ6IDEwMCU7XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7Y2l0eVBsYWNlLnBob3Rvcy5zbGljZSgwLCA1KS5tYXAoKHBob3RvLCBpbmRleCkgPT4gYFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNhcm91c2VsLXNsaWRlIHctZnVsbCBoLWZ1bGwgZmxleC1ub25lXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9XCJodHRwczovL3BsYWNlcy5nb29nbGVhcGlzLmNvbS92MS8ke3Bob3RvLm5hbWV9L21lZGlhP21heEhlaWdodFB4PTM0MCZtYXhXaWR0aFB4PTM0MCZrZXk9JHthcGlLZXl9XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWx0PVwiJHtjaXR5fVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzPVwidy1mdWxsIGgtZnVsbCBvYmplY3QtY292ZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYCkuam9pbignJyl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz1cIndpbmRvdy5wcmV2U2xpZGUoKVwiIGNsYXNzPVwiYWJzb2x1dGUgbGVmdC0yIHRvcC0xLzIgdHJhbnNmb3JtIC10cmFuc2xhdGUteS0xLzIgYmctd2hpdGUvODAgcm91bmRlZC1mdWxsIHAtMSBzaGFkb3ctbWQgaG92ZXI6Ymctd2hpdGVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBmaWxsPVwibm9uZVwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBzdHJva2Utd2lkdGg9XCIxLjVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBjbGFzcz1cInctNSBoLTVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIgZD1cIk0xNS43NSAxOS41TDguMjUgMTJsNy41LTcuNVwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zdmc+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz1cIndpbmRvdy5uZXh0U2xpZGUoKVwiIGNsYXNzPVwiYWJzb2x1dGUgcmlnaHQtMiB0b3AtMS8yIHRyYW5zZm9ybSAtdHJhbnNsYXRlLXktMS8yIGJnLXdoaXRlLzgwIHJvdW5kZWQtZnVsbCBwLTEgc2hhZG93LW1kIGhvdmVyOmJnLXdoaXRlXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgZmlsbD1cIm5vbmVcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgc3Ryb2tlLXdpZHRoPVwiMS41XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgY2xhc3M9XCJ3LTUgaC01XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiIGQ9XCJNOC4yNSA0LjVsNy41IDcuNS03LjUgNy41XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImFic29sdXRlIGJvdHRvbS0yIGxlZnQtMCByaWdodC0wIGZsZXgganVzdGlmeS1jZW50ZXIgZ2FwLTFcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2NpdHlQbGFjZS5waG90b3Muc2xpY2UoMCwgNSkubWFwKChfLCBpbmRleCkgPT4gYFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9XCJ3aW5kb3cuZ29Ub1NsaWRlKCR7aW5kZXh9KVwiIGNsYXNzPVwidy0yIGgtMiByb3VuZGVkLWZ1bGwgYmctd2hpdGUvODAgaG92ZXI6Ymctd2hpdGUgc2hhZG93LXNtIGNhcm91c2VsLWRvdFwiIGRhdGEtaW5kZXg9XCIke2luZGV4fVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgKS5qb2luKCcnKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnJztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIGNhcm91c2VsIGNvbnRyb2wgZnVuY3Rpb25zIHRvIHdpbmRvd1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNpdHlQbGFjZS5waG90b3MgJiYgY2l0eVBsYWNlLnBob3Rvcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbnVtU2xpZGVzID0gTWF0aC5taW4oY2l0eVBsYWNlLnBob3Rvcy5sZW5ndGgsIDUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jdXJyZW50U2xpZGUgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy51cGRhdGVDYXJvdXNlbCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdHJhY2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2Fyb3VzZWwtdHJhY2snKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRyYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAodHJhY2sgYXMgSFRNTEVsZW1lbnQpLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKC0ke3dpbmRvdy5jdXJyZW50U2xpZGUgKiAxMDB9JSlgO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIGRvdHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jYXJvdXNlbC1kb3QnKS5mb3JFYWNoKChkb3QsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID09PSB3aW5kb3cuY3VycmVudFNsaWRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvdC5jbGFzc0xpc3QuYWRkKCdiZy13aGl0ZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb3QuY2xhc3NMaXN0LnJlbW92ZSgnYmctd2hpdGUvODAnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb3QuY2xhc3NMaXN0LnJlbW92ZSgnYmctd2hpdGUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG90LmNsYXNzTGlzdC5hZGQoJ2JnLXdoaXRlLzgwJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm5leHRTbGlkZSA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmN1cnJlbnRTbGlkZSA9ICh3aW5kb3cuY3VycmVudFNsaWRlICsgMSkgJSBudW1TbGlkZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy51cGRhdGVDYXJvdXNlbCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cucHJldlNsaWRlID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY3VycmVudFNsaWRlID0gKHdpbmRvdy5jdXJyZW50U2xpZGUgLSAxICsgbnVtU2xpZGVzKSAlIG51bVNsaWRlcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnVwZGF0ZUNhcm91c2VsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5nb1RvU2xpZGUgPSAoaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmN1cnJlbnRTbGlkZSA9IGluZGV4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cudXBkYXRlQ2Fyb3VzZWwoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJiZy13aGl0ZSByb3VuZGVkLWxnIHNoYWRvdy1zbVwiIHN0eWxlPVwibWF4LXdpZHRoOiAzNDBweDtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtwaG90b0Nhcm91c2VsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwicC00XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDIgY2xhc3M9XCJ0ZXh0LXhsIGZvbnQtc2VtaWJvbGQgdGV4dC1ncmF5LTkwMCBtYi0yXCI+JHtjaXR5fTwvaDI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2NpdHlQbGFjZS5mb3JtYXR0ZWRBZGRyZXNzIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gYDxwIGNsYXNzPVwidGV4dC1zbSB0ZXh0LWdyYXktNTAwIG1iLTJcIj4ke2NpdHlQbGFjZS5mb3JtYXR0ZWRBZGRyZXNzfTwvcD5gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnJ31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2l0eSBpbmZvIHdpbmRvdzonLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgYSBtYXJrZXIgZm9yIHRoZSBjaXR5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2l0eU1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5tYXJrZXIuQWR2YW5jZWRNYXJrZXJFbGVtZW50KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwOiBuZXdNYXAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBsb2NhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGNpdHlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZCBjbGljayBsaXN0ZW5lciB0byB0aGUgbWFya2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2l0eU1hcmtlci5hZGRMaXN0ZW5lcignZ21wLWNsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5mb1dpbmRvdykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGNyZWF0ZUNpdHlJbmZvV2luZG93Q29udGVudChjaXR5LCBsb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3cuc2V0Q29udGVudChhd2FpdCBjb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93Lm9wZW4obmV3TWFwLCBjaXR5TWFya2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2Vycy5zZXQoY2l0eSwgY2l0eU1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIGNsaWNrIGxpc3RlbmVyIGZvciBmdXR1cmUgaW50ZXJhY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaXR5TWFya2VyLmFkZExpc3RlbmVyKCdnbXAtY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBjcmVhdGVDaXR5SW5mb1dpbmRvd0NvbnRlbnQoY2l0eSwgbG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3SW5mb1dpbmRvdy5zZXRDb250ZW50KGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3SW5mb1dpbmRvdy5vcGVuKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmNob3I6IGNpdHlNYXJrZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwOiBuZXdNYXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNldHRpbmcgdXAgbWFwOicsIGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0RXJyb3IoJ0ZhaWxlZCB0byBpbml0aWFsaXplIG1hcCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluaXRpYWxpemluZyBtYXA6JywgZXJyKTtcbiAgICAgICAgICAgICAgICBzZXRFcnJvcignRmFpbGVkIHRvIGluaXRpYWxpemUgbWFwJyk7XG4gICAgICAgICAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBpbml0TWFwKCk7XG4gICAgfSwgW2NpdHksIHNjcmlwdExvYWRlZCwgYXBpS2V5XSk7XG5cbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoIW1hcCkgcmV0dXJuO1xuXG4gICAgICAgIHdpbmRvdy5yZW1vdmVQbGFjZUZyb21NYXAgPSAocGxhY2VJZDogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnRGVidWcgLSBTdGFydGluZyByZW1vdmFsIHByb2Nlc3MgZm9yIHBsYWNlSWQ6JywgcGxhY2VJZCk7XG4gICAgICAgICAgICAgLy8gUmVtb3ZlIGZyb20gZ2xvYmFsIHN0b3JhZ2VcbiAgICAgICAgICAgIHNhdmVkUGxhY2VzTWFuYWdlci5yZW1vdmVQbGFjZShwbGFjZUlkKTtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBtYXJrZXIgPSBtYXJrZXJzUmVmLmN1cnJlbnQuZ2V0KHBsYWNlSWQpO1xuICAgICAgICAgICAgICAgIGlmIChtYXJrZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0RlYnVnIC0gRm91bmQgbWFya2VyOicsIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBTaW1wbHkgc2V0IHRoZSBtYXAgdG8gbnVsbCB0byByZW1vdmUgdGhlIG1hcmtlclxuICAgICAgICAgICAgICAgICAgICBtYXJrZXIucG9zaXRpb24gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2xvc2UgaW5mbyB3aW5kb3cgaWYgb3BlblxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5mb1dpbmRvd1JlZi5jdXJyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93UmVmLmN1cnJlbnQuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBldmVudCBsaXN0ZW5lcnNcbiAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuY2xlYXJJbnN0YW5jZUxpc3RlbmVycyhtYXJrZXIpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIENsZWFuIHVwIHJlZmVyZW5jZXNcbiAgICAgICAgICAgICAgICAgICAgbWFya2Vyc1JlZi5jdXJyZW50LmRlbGV0ZShwbGFjZUlkKTtcbiAgICAgICAgICAgICAgICAgICAgc2F2ZWRQbGFjZXNNYW5hZ2VyLnJlbW92ZVBsYWNlKHBsYWNlSWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEZvcmNlIHVwZGF0ZSBjb21wb25lbnQgc3RhdGVcbiAgICAgICAgICAgICAgICAgICAgc2V0TWFya2VyQ291bnQocHJldiA9PiBwcmV2IC0gMSk7XG4gICAgICAgICAgICAgICAgICAgIHNldFNhdmVkUGxhY2VzKG5ldyBNYXAoc2F2ZWRQbGFjZXNNYW5hZ2VyLnBsYWNlcykpO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdEZWJ1ZyAtIEFmdGVyIHJlbW92YWwgbWFya2VyczonLCBbLi4ubWFya2Vyc1JlZi5jdXJyZW50LmVudHJpZXMoKV0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRGVidWcgLSBTdWNjZXNzZnVsbHkgcmVtb3ZlZCBtYXJrZXIgYW5kIHBsYWNlOicsIHBsYWNlSWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignRGVidWcgLSBDb3VsZCBub3QgZmluZCBtYXJrZXIgZm9yIHBsYWNlSWQ6JywgcGxhY2VJZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdEZWJ1ZyAtIEVycm9yIGR1cmluZyBtYXJrZXIgcmVtb3ZhbDonLCBlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBOb3RpZnkgY29tcG9uZW50cyB0aGF0IHBsYWNlcyBjaGFuZ2VkXG4gICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ3NhdmVkUGxhY2VzQ2hhbmdlZCcsIHtcbiAgICAgICAgICAgICAgICBkZXRhaWw6IHtcbiAgICAgICAgICAgICAgICAgICAgcGxhY2VzOiBBcnJheS5mcm9tKHNhdmVkUGxhY2VzTWFuYWdlci5wbGFjZXMudmFsdWVzKCkpLFxuICAgICAgICAgICAgICAgICAgICBjb3VudDogc2F2ZWRQbGFjZXNNYW5hZ2VyLnBsYWNlcy5zaXplXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHdpbmRvdy5hZGRQbGFjZVRvTWFwID0gYXN5bmMgKGRhdGE6IHsgXG4gICAgICAgICAgICBsYXRpdHVkZTogbnVtYmVyOyBcbiAgICAgICAgICAgIGxvbmdpdHVkZTogbnVtYmVyOyBcbiAgICAgICAgICAgIHRpdGxlPzogc3RyaW5nO1xuICAgICAgICAgICAgcGxhY2U/OiBQbGFjZTtcbiAgICAgICAgfSkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBBZGQgdGhpcyBjaGVjayBhdCB0aGUgc3RhcnQgb2YgdGhlIGZ1bmN0aW9uXG4gICAgICAgICAgICAgICAgY29uc3QgbWFya2VySWQgPSBkYXRhLnBsYWNlPy5pZDtcbiAgICAgICAgICAgICAgICBpZiAoIW1hcmtlcklkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0RlYnVnIC0gTm8gcGxhY2UgSUQgcHJvdmlkZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIEFkZCB0aGlzIGNoZWNrIGZvciBkdXBsaWNhdGVzXG4gICAgICAgICAgICAgICAgaWYgKHNhdmVkUGxhY2VzTWFuYWdlci5oYXNQbGFjZShtYXJrZXJJZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0RlYnVnIC0gUGxhY2UgYWxyZWFkeSBleGlzdHM6JywgbWFya2VySWQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgIC8vIEFkZCB0byBnbG9iYWwgc3RvcmFnZSBmaXJzdFxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnBsYWNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNhdmVkUGxhY2VzTWFuYWdlci5hZGRQbGFjZShkYXRhLnBsYWNlKTtcbiAgICAgICAgICAgICAgICAgICAgIC8vIEZvcmNlIGEgcmUtcmVuZGVyIHdoZW4gYWRkaW5nIGEgbWFya2VyXG4gICAgICAgICAgICAgICAgICAgIHNldE1hcmtlckNvdW50KHByZXYgPT4gcHJldiArIDEpO1xuICAgICAgICAgICAgICAgICAgICBzZXRTYXZlZFBsYWNlcyhuZXcgTWFwKHNhdmVkUGxhY2VzTWFuYWdlci5wbGFjZXMpKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0RlYnVnIC0gQWRkZWQgcGxhY2U6Jywgc2F2ZWRQbGFjZXNNYW5hZ2VyLnBsYWNlcyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29uc3QgW3sgQWR2YW5jZWRNYXJrZXJFbGVtZW50IH0sIHsgUGluRWxlbWVudCB9XSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuaW1wb3J0TGlicmFyeShcIm1hcmtlclwiKSBhcyBQcm9taXNlPGdvb2dsZS5tYXBzLk1hcmtlckxpYnJhcnk+LFxuICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5pbXBvcnRMaWJyYXJ5KFwibWFya2VyXCIpIGFzIFByb21pc2U8Z29vZ2xlLm1hcHMuTWFya2VyTGlicmFyeT5cbiAgICAgICAgICAgICAgICBdKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHBpbkVsZW1lbnQgPSBuZXcgZ29vZ2xlLm1hcHMubWFya2VyLlBpbkVsZW1lbnQoe1xuICAgICAgICAgICAgICAgICAgICBzY2FsZTogMVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0RlYnVnIC0gQ3JlYXRpbmcgbWFya2VyIHdpdGggSUQ6JywgbWFya2VySWQpO1xuXG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGV4aXN0aW5nIG1hcmtlciBpZiBpdCBleGlzdHNcbiAgICAgICAgICAgICAgICBpZiAobWFya2Vyc1JlZi5jdXJyZW50LmhhcyhtYXJrZXJJZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdNYXJrZXIgPSBtYXJrZXJzUmVmLmN1cnJlbnQuZ2V0KG1hcmtlcklkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nTWFya2VyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBleGlzdGluZ01hcmtlci5tYXAgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nTWFya2VyLmVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGlzdGluZ01hcmtlci5lbGVtZW50LnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbWFya2Vyc1JlZi5jdXJyZW50LmRlbGV0ZShtYXJrZXJJZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zdCBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMubWFya2VyLkFkdmFuY2VkTWFya2VyRWxlbWVudCh7XG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXQ6IGRhdGEubGF0aXR1ZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBsbmc6IGRhdGEubG9uZ2l0dWRlXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBwaW5FbGVtZW50LmVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgIGdtcERyYWdnYWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIG1hcCBwcm9wZXJ0eSBhZnRlciBjcmVhdGlvblxuICAgICAgICAgICAgICAgIG1hcmtlci5tYXAgPSBtYXA7XG5cbiAgICAgICAgICAgICAgICAvLyBBZGQgY2xpY2sgbGlzdGVuZXJcbiAgICAgICAgICAgICAgICBtYXJrZXIuYWRkTGlzdGVuZXIoJ2dtcC1jbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEucGxhY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jdXJyZW50SW5mb1dpbmRvd01hcmtlciA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXJJZDogbWFya2VySWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyOiBtYXJrZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gY3JlYXRlUGxhY2VJbmZvV2luZG93Q29udGVudChkYXRhLnBsYWNlLCBtYXJrZXJJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGVudCAmJiBpbmZvV2luZG93UmVmLmN1cnJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93UmVmLmN1cnJlbnQuc2V0Q29udGVudChjb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93UmVmLmN1cnJlbnQub3BlbihtYXAsIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vIFN0b3JlIHRoZSBtYXJrZXIgcmVmZXJlbmNlXG4gICAgICAgICAgICAgICAgLy8gbWFya2Vyc1JlZi5jdXJyZW50LnNldChtYXJrZXJJZCwgbWFya2VyKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBpZiAoZGF0YS5wbGFjZSkge1xuICAgICAgICAgICAgICAgIC8vICAgICBzYXZlZFBsYWNlc01hbmFnZXIuYWRkUGxhY2UoZGF0YS5wbGFjZSk7XG4gICAgICAgICAgICAgICAgLy8gICAgIC8vIEZvcmNlIGEgcmUtcmVuZGVyIHdoZW4gYWRkaW5nIGEgbWFya2VyXG4gICAgICAgICAgICAgICAgLy8gICAgIHNldE1hcmtlckNvdW50KHByZXYgPT4gcHJldiArIDEpO1xuICAgICAgICAgICAgICAgIC8vICAgICBzZXRTYXZlZFBsYWNlcyhuZXcgTWFwKHNhdmVkUGxhY2VzTWFuYWdlci5wbGFjZXMpKTtcbiAgICAgICAgICAgICAgICAvLyAgICAgY29uc29sZS5sb2coJ0RlYnVnIC0gQWRkZWQgcGxhY2U6Jywgc2F2ZWRQbGFjZXNNYW5hZ2VyLnBsYWNlcyk7XG4gICAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdEZWJ1ZyAtIE1hcmtlciBhZGRlZCBzdWNjZXNzZnVsbHknKTtcblxuICAgICAgICAgICAgICAgIC8vIE5vdGlmeSBjb21wb25lbnRzIHRoYXQgcGxhY2VzIGNoYW5nZWRcbiAgICAgICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ3NhdmVkUGxhY2VzQ2hhbmdlZCcsIHtcbiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFjZXM6IEFycmF5LmZyb20oc2F2ZWRQbGFjZXNNYW5hZ2VyLnBsYWNlcy52YWx1ZXMoKSksXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudDogc2F2ZWRQbGFjZXNNYW5hZ2VyLnBsYWNlcy5zaXplXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGFkZGluZyBwbGFjZSBtYXJrZXI6JywgZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICB3aW5kb3cuZ2V0U2F2ZWRQbGFjZXMgPSAoKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gc2F2ZWRQbGFjZXNNYW5hZ2VyLmdldFBsYWNlcygpO1xuICAgICAgICB9O1xuICAgICAgICBcbiAgICB9LCBbbWFwLCBpbmZvV2luZG93LCBtYXJrZXJDb3VudF0pO1xuXG4gICAgLy8gLy8gQWRkIGEgdXNlRWZmZWN0IHRvIG1vbml0b3Igc2F2ZWRQbGFjZXMgY2hhbmdlc1xuICAgIC8vIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgLy8gICAgIGNvbnNvbGUubG9nKCdDdXJyZW50IHNhdmVkIHBsYWNlczonLCBbLi4uZ2xvYmFsU2F2ZWRQbGFjZXMuZW50cmllcygpXSk7XG4gICAgLy8gfSwgW3NhdmVkUGxhY2VzXSk7XG5cbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBjb25zdCBoYW5kbGVWaXNpYmlsaXR5Q2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PT0gJ3Zpc2libGUnICYmIG1hcCkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5nb29nbGU/Lm1hcHM/LmV2ZW50Py50cmlnZ2VyKG1hcCwgJ3Jlc2l6ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Zpc2liaWxpdHljaGFuZ2UnLCBoYW5kbGVWaXNpYmlsaXR5Q2hhbmdlKTtcbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Zpc2liaWxpdHljaGFuZ2UnLCBoYW5kbGVWaXNpYmlsaXR5Q2hhbmdlKTtcbiAgICAgICAgfTtcbiAgICB9LCBbbWFwXSk7XG5cbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICAvLyBMb2FkIHNhdmVkIHBsYWNlcyBmcm9tIHNlc3Npb24gc3RvcmFnZSBvbiBtb3VudFxuICAgICAgICBjb25zdCBzZXNzaW9uRGF0YSA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3RyYXZlbFBsYW5uZXJTZXNzaW9uJyk7XG4gICAgICAgIGlmIChzZXNzaW9uRGF0YSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKHNlc3Npb25EYXRhKTtcbiAgICAgICAgICAgICAgICBpZiAocGFyc2VkLnNhdmVkUGxhY2VzKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcnNlZC5zYXZlZFBsYWNlcy5mb3JFYWNoKChwbGFjZTogUGxhY2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwbGFjZS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhdmVkUGxhY2VzTWFuYWdlci5hZGRQbGFjZShwbGFjZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAvLyBOb3RpZnkgY29tcG9uZW50cyBvZiBpbml0aWFsIGxvYWRcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdzYXZlZFBsYWNlc0NoYW5nZWQnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZXM6IEFycmF5LmZyb20oc2F2ZWRQbGFjZXNNYW5hZ2VyLnBsYWNlcy52YWx1ZXMoKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ6IHNhdmVkUGxhY2VzTWFuYWdlci5wbGFjZXMuc2l6ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb2FkaW5nIHNhdmVkIHBsYWNlcyBmcm9tIHNlc3Npb246JywgZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwgW10pO1xuXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgLy8gU2F2ZSB0byBzZXNzaW9uIHN0b3JhZ2Ugd2hlbiBwbGFjZXMgY2hhbmdlXG4gICAgICAgIGNvbnN0IHNlc3Npb25EYXRhID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgndHJhdmVsUGxhbm5lclNlc3Npb24nKTtcbiAgICAgICAgaWYgKHNlc3Npb25EYXRhKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2Uoc2Vzc2lvbkRhdGEpO1xuICAgICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ3RyYXZlbFBsYW5uZXJTZXNzaW9uJywgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICAuLi5wYXJzZWQsXG4gICAgICAgICAgICAgICAgICAgIHNhdmVkUGxhY2VzOiBzYXZlZFBsYWNlc01hbmFnZXIuZ2V0UGxhY2VzKClcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNhdmluZyBwbGFjZXMgdG8gc2Vzc2lvbjonLCBlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCBbc2F2ZWRQbGFjZXNdKTtcblxuICAgIGNvbnN0IGdldFBob3RvVXJsID0gKHBob3RvOiBnb29nbGUubWFwcy5wbGFjZXMuUGhvdG8sIGluZGV4OiBudW1iZXIpID0+IHtcbiAgICAgICAgcmV0dXJuIHBob3RvLmdldFVSST8uKCkgfHwgJyc7XG4gICAgfTtcblxuICAgIGNvbnN0IGhhbmRsZVNsaWRlQ2hhbmdlID0gKF86IGFueSwgaW5kZXg6IG51bWJlcikgPT4ge1xuICAgICAgICBpZiAod2luZG93LmN1cnJlbnRTbGlkZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB3aW5kb3cuY3VycmVudFNsaWRlID0gaW5kZXg7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uc3QgY3JlYXRlUGxhY2VJbmZvV2luZG93Q29udGVudCA9IChwbGFjZTogUGxhY2UsIG1hcmtlcklkOiBzdHJpbmcpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ0RlYnVnIC0gQ3JlYXRpbmcgaW5mbyB3aW5kb3cgY29udGVudCBmb3IgbWFya2VySWQ6JywgbWFya2VySWQpO1xuICAgICAgICBjb25zdCBwaG90b1VybCA9IHBsYWNlLnBob3RvcyAmJiBwbGFjZS5waG90b3NbMF0gXG4gICAgICAgICAgICA/IGBodHRwczovL3BsYWNlcy5nb29nbGVhcGlzLmNvbS92MS8ke3BsYWNlLnBob3Rvc1swXS5uYW1lfS9tZWRpYT9tYXhIZWlnaHRQeD0yMDAmbWF4V2lkdGhQeD0zMDAma2V5PSR7YXBpS2V5fWBcbiAgICAgICAgICAgIDogJyc7XG5cbiAgICAgICAgY29uc3QgcGxhY2VUaXRsZSA9IHR5cGVvZiBwbGFjZS5kaXNwbGF5TmFtZSA9PT0gJ3N0cmluZycgPyBwbGFjZS5kaXNwbGF5TmFtZSA6IHBsYWNlLmRpc3BsYXlOYW1lLnRleHQ7XG5cbiAgICAgICAgcmV0dXJuIGBcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJiZy13aGl0ZSByb3VuZGVkLWxnIHNoYWRvdy1zbVwiIHN0eWxlPVwibWF4LXdpZHRoOiAzMDBweDtcIj5cbiAgICAgICAgICAgICAgICAke3Bob3RvVXJsID8gYFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPVwiaGVpZ2h0OiAxNTBweDsgd2lkdGg6IDEwMCU7XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz1cIiR7cGhvdG9Vcmx9XCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWx0PVwiJHtwbGFjZVRpdGxlfVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9XCJ3aWR0aDogMTAwJTsgaGVpZ2h0OiAxMDAlOyBvYmplY3QtZml0OiBjb3ZlcjsgYm9yZGVyLXRvcC1sZWZ0LXJhZGl1czogMC41cmVtOyBib3JkZXItdG9wLXJpZ2h0LXJhZGl1czogMC41cmVtO1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICBgIDogJyd9XG5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwicC0zXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJmbGV4IGp1c3RpZnktYmV0d2VlbiBpdGVtcy1zdGFydFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGgzIGNsYXNzPVwidGV4dC1sZyBmb250LXNlbWlib2xkIHRleHQtZ3JheS05MDAgbWItMVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7cGxhY2VUaXRsZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvaDM+XG4gICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uY2xpY2s9XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0RlYnVnIC0gRGVsZXRlIGJ1dHRvbiBjbGlja2VkIGZvciBtYXJrZXJJZDonLCAnJHttYXJrZXJJZH0nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3cucmVtb3ZlUGxhY2VGcm9tTWFwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnJlbW92ZVBsYWNlRnJvbU1hcCgnJHttYXJrZXJJZH0nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDbG9zZSB0aGUgaW5mbyB3aW5kb3cgYWZ0ZXIgZGVsZXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LmN1cnJlbnRJbmZvV2luZG93KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jdXJyZW50SW5mb1dpbmRvdy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzPVwicC0xIGhvdmVyOmJnLXJlZC01MCByb3VuZGVkLWZ1bGxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyaWEtbGFiZWw9XCJSZW1vdmUgcGxhY2VcIlxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIGNsYXNzPVwiaC01IHctNSB0ZXh0LXJlZC01MDBcIiB2aWV3Qm94PVwiMCAwIDIwIDIwXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cGF0aCBmaWxsLXJ1bGU9XCJldmVub2RkXCIgZD1cIk05IDJhMSAxIDAgMDAtLjg5NC41NTNMNy4zODIgNEg0YTEgMSAwIDAwMCAydjEwYTIgMiAwIDAwMiAyaDhhMiAyIDAgMDAyLTJWNmExIDEgMCAxMDAtMmgtMy4zODJsLS43MjQtMS40NDdBMSAxIDAgMDAxMSAySDl6TTcgOGExIDEgMCAwMTIgMHY2YTEgMSAwIDExLTIgMFY4em01LTFhMSAxIDAgMDAtMSAxdjZhMSAxIDAgMTAyIDBWOGExIDEgMCAwMC0xLTF6XCIgY2xpcC1ydWxlPVwiZXZlbm9kZFwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zdmc+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICR7cGxhY2UucHJpbWFyeVR5cGVEaXNwbGF5TmFtZSBcbiAgICAgICAgICAgICAgICAgICAgICAgID8gYDxkaXYgY2xhc3M9XCJ0ZXh0LXNtIHRleHQtZ3JheS02MDAgbWItMVwiPiR7cGxhY2UucHJpbWFyeVR5cGVEaXNwbGF5TmFtZS50ZXh0fTwvZGl2PmBcbiAgICAgICAgICAgICAgICAgICAgICAgIDogJyd9XG4gICAgICAgICAgICAgICAgICAgICR7cGxhY2UuZm9ybWF0dGVkQWRkcmVzcyBcbiAgICAgICAgICAgICAgICAgICAgICAgID8gYDxwIGNsYXNzPVwidGV4dC1zbSB0ZXh0LWdyYXktNTAwXCI+JHtwbGFjZS5mb3JtYXR0ZWRBZGRyZXNzfTwvcD5gXG4gICAgICAgICAgICAgICAgICAgICAgICA6ICcnfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIGA7XG4gICAgfTtcblxuICAgIHJldHVybiAoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicmVsYXRpdmUgdy1mdWxsIGgtZnVsbFwiPlxuICAgICAgICAgICAge2FwaUtleSAmJiAoXG4gICAgICAgICAgICAgICAgPFNjcmlwdFxuICAgICAgICAgICAgICAgICAgICBzcmM9e2BodHRwczovL21hcHMuZ29vZ2xlYXBpcy5jb20vbWFwcy9hcGkvanM/a2V5PSR7YXBpS2V5fSZsaWJyYXJpZXM9cGxhY2VzLG1hcmtlciZ2PWJldGEmY2FsbGJhY2s9RnVuY3Rpb24ucHJvdG90eXBlYH1cbiAgICAgICAgICAgICAgICAgICAgc3RyYXRlZ3k9XCJhZnRlckludGVyYWN0aXZlXCJcbiAgICAgICAgICAgICAgICAgICAgb25Mb2FkPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnR29vZ2xlIE1hcHMgc2NyaXB0IGxvYWRlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0U2NyaXB0TG9hZGVkKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICBvbkVycm9yPXsoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgR29vZ2xlIE1hcHMgc2NyaXB0OicsIGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0RXJyb3IoJ0ZhaWxlZCB0byBsb2FkIEdvb2dsZSBNYXBzJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApfVxuICAgICAgICAgICAge2Vycm9yICYmIChcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFic29sdXRlIGluc2V0LTAgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgYmctZ3JheS0xMDAgdGV4dC1yZWQtNTAwIHAtNCB0ZXh0LWNlbnRlclwiPlxuICAgICAgICAgICAgICAgICAgICB7ZXJyb3J9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApfVxuICAgICAgICAgICAge2lzTG9hZGluZyAmJiAhZXJyb3IgJiYgKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWJzb2x1dGUgaW5zZXQtMCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBiZy1ncmF5LTEwMFwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtZ3JheS02MDBcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIExvYWRpbmcgbWFwLi4uXG4gICAgICAgICAgICAgICAgICAgICAgICB7IWFwaUtleSAmJiA8ZGl2PldhaXRpbmcgZm9yIEFQSSBrZXkuLi48L2Rpdj59XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDxkaXYgcmVmPXttYXBSZWZ9IGNsYXNzTmFtZT1cInctZnVsbCBoLWZ1bGxcIiAvPlxuICAgICAgICAgICAgey8qIHtzZWxlY3RlZFBsYWNlICYmIChcbiAgICAgICAgICAgICAgICA8U21hbGxQbGFjZUNhcmQgXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlPXtzZWxlY3RlZFBsYWNlfSBcbiAgICAgICAgICAgICAgICAgICAgb25DbG9zZT17KCkgPT4gc2V0U2VsZWN0ZWRQbGFjZShudWxsKX0gXG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICl9ICovfVxuICAgICAgICA8L2Rpdj5cbiAgICApO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgTWFwQ29tcG9uZW50OyJdLCJuYW1lcyI6WyJSZWFjdCIsInVzZUVmZmVjdCIsInVzZVJlZiIsInVzZVN0YXRlIiwiU2NyaXB0Iiwic2F2ZWRQbGFjZXNNYW5hZ2VyIiwic2VhcmNoUGxhY2VCeVRleHQiLCJnbG9iYWxTYXZlZFBsYWNlcyIsInBsYWNlcyIsIk1hcENvbXBvbmVudCIsImNpdHkiLCJhcGlLZXkiLCJtYXBSZWYiLCJtYXAiLCJzZXRNYXAiLCJtYXJrZXJzIiwic2V0TWFya2VycyIsIk1hcCIsImluZm9XaW5kb3ciLCJzZXRJbmZvV2luZG93IiwiZXJyb3IiLCJzZXRFcnJvciIsImlzTG9hZGluZyIsInNldElzTG9hZGluZyIsInNjcmlwdExvYWRlZCIsInNldFNjcmlwdExvYWRlZCIsInNlbGVjdGVkUGxhY2UiLCJzZXRTZWxlY3RlZFBsYWNlIiwic2F2ZWRQbGFjZXMiLCJzZXRTYXZlZFBsYWNlcyIsIm1hcmtlcnNSZWYiLCJpbmZvV2luZG93UmVmIiwibWFya2VyQ291bnQiLCJzZXRNYXJrZXJDb3VudCIsImNvbnNvbGUiLCJsb2ciLCJhcGlLZXlMZW5ndGgiLCJsZW5ndGgiLCJjdXJyZW50IiwiaW5pdE1hcCIsIndpbmRvdyIsImdvb2dsZSIsIm1hcHMiLCJpbXBvcnRMaWJyYXJ5IiwiQWR2YW5jZWRNYXJrZXJFbGVtZW50IiwiZ2VvY29kZXIiLCJHZW9jb2RlciIsImdlb2NvZGUiLCJhZGRyZXNzIiwicmVzdWx0cyIsInN0YXR1cyIsInJlc3VsdHNMZW5ndGgiLCJnZW9tZXRyeSIsImxvY2F0aW9uIiwibmV3TWFwIiwiY2VudGVyIiwiem9vbSIsIm1hcElkIiwibmV3SW5mb1dpbmRvdyIsIkluZm9XaW5kb3ciLCJtYXhXaWR0aCIsImNyZWF0ZUNpdHlJbmZvV2luZG93Q29udGVudCIsImNpdHlQbGFjZSIsImxhdGl0dWRlIiwibGF0IiwibG9uZ2l0dWRlIiwibG5nIiwicGhvdG9DYXJvdXNlbCIsInBob3RvcyIsInNsaWNlIiwicGhvdG8iLCJpbmRleCIsIm5hbWUiLCJqb2luIiwiXyIsIm51bVNsaWRlcyIsIk1hdGgiLCJtaW4iLCJjdXJyZW50U2xpZGUiLCJ1cGRhdGVDYXJvdXNlbCIsInRyYWNrIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwic3R5bGUiLCJ0cmFuc2Zvcm0iLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImRvdCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsIm5leHRTbGlkZSIsInByZXZTbGlkZSIsImdvVG9TbGlkZSIsImZvcm1hdHRlZEFkZHJlc3MiLCJjaXR5TWFya2VyIiwibWFya2VyIiwicG9zaXRpb24iLCJ0aXRsZSIsImFkZExpc3RlbmVyIiwiY29udGVudCIsInNldENvbnRlbnQiLCJvcGVuIiwic2V0IiwiYW5jaG9yIiwiZXJyIiwicmVtb3ZlUGxhY2VGcm9tTWFwIiwicGxhY2VJZCIsInJlbW92ZVBsYWNlIiwiZ2V0IiwiY2xvc2UiLCJldmVudCIsImNsZWFySW5zdGFuY2VMaXN0ZW5lcnMiLCJkZWxldGUiLCJwcmV2IiwiZW50cmllcyIsIndhcm4iLCJkaXNwYXRjaEV2ZW50IiwiQ3VzdG9tRXZlbnQiLCJkZXRhaWwiLCJBcnJheSIsImZyb20iLCJ2YWx1ZXMiLCJjb3VudCIsInNpemUiLCJhZGRQbGFjZVRvTWFwIiwiZGF0YSIsIm1hcmtlcklkIiwicGxhY2UiLCJpZCIsImhhc1BsYWNlIiwiYWRkUGxhY2UiLCJQaW5FbGVtZW50IiwiUHJvbWlzZSIsImFsbCIsInBpbkVsZW1lbnQiLCJzY2FsZSIsImhhcyIsImV4aXN0aW5nTWFya2VyIiwiZWxlbWVudCIsImdtcERyYWdnYWJsZSIsImN1cnJlbnRJbmZvV2luZG93TWFya2VyIiwiY3JlYXRlUGxhY2VJbmZvV2luZG93Q29udGVudCIsImdldFNhdmVkUGxhY2VzIiwiZ2V0UGxhY2VzIiwiaGFuZGxlVmlzaWJpbGl0eUNoYW5nZSIsInZpc2liaWxpdHlTdGF0ZSIsInRyaWdnZXIiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNlc3Npb25EYXRhIiwic2Vzc2lvblN0b3JhZ2UiLCJnZXRJdGVtIiwicGFyc2VkIiwiSlNPTiIsInBhcnNlIiwic2V0SXRlbSIsInN0cmluZ2lmeSIsImdldFBob3RvVXJsIiwiZ2V0VVJJIiwiaGFuZGxlU2xpZGVDaGFuZ2UiLCJ1bmRlZmluZWQiLCJwaG90b1VybCIsInBsYWNlVGl0bGUiLCJkaXNwbGF5TmFtZSIsInRleHQiLCJwcmltYXJ5VHlwZURpc3BsYXlOYW1lIiwiZGl2IiwiY2xhc3NOYW1lIiwic3JjIiwic3RyYXRlZ3kiLCJvbkxvYWQiLCJvbkVycm9yIiwiZSIsInJlZiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./components/map-component.tsx\n");

/***/ }),

/***/ "./managers/stage-manager.ts":
/*!***********************************!*\
  !*** ./managers/stage-manager.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   STAGE_LIMITS: () => (/* binding */ STAGE_LIMITS),\n/* harmony export */   validateStageProgression: () => (/* binding */ validateStageProgression)\n/* harmony export */ });\n// Validation functions for each stage\nconst STAGE_LIMITS = {\n    3: {\n        maxPrompts: 5,\n        upgradeMessage: `I'm sorry to tell you that you have reached the prompts limit in the free version. \n    Would you like to upgrade to unlock unlimited places browsing and premium features? \n    This will give you access to personalized recommendations, detailed scheduling, and local insights.`\n    }\n};\nconst STAGE_VALIDATORS = {\n    // Stage 1: Initial Parameter Check\n    1: {\n        validate: (details)=>{\n            const missingRequirements = [];\n            if (!details.destination) missingRequirements.push(\"destination\");\n            if (!details.startDate) missingRequirements.push(\"start date\");\n            if (!details.endDate) missingRequirements.push(\"end date\");\n            if (!details.preferences?.length) missingRequirements.push(\"preferences\");\n            if (!details.language) missingRequirements.push(\"language\");\n            return {\n                isValid: missingRequirements.length === 0,\n                missingRequirements\n            };\n        }\n    },\n    // Stage 2: City Introduction\n    2: {\n        validate: (details, metrics)=>{\n            return {\n                isValid: true,\n                missingRequirements: []\n            };\n        }\n    },\n    // Stage 3: Places Introduction\n    3: {\n        validate: (_, metrics)=>{\n            const stagePrompts = metrics.stagePrompts?.[3] || 0;\n            const maxPrompts = STAGE_LIMITS[3].maxPrompts;\n            if (stagePrompts >= maxPrompts) {\n                return {\n                    isValid: true,\n                    missingRequirements: [\n                        \"Maximum places limit reached. Ready for upgrade.\"\n                    ],\n                    upgradeRequired: true\n                };\n            }\n            return {\n                isValid: false,\n                missingRequirements: [\n                    \"Continue adding places\"\n                ]\n            };\n        }\n    },\n    // Stage 4: Itinerary Review (with payment check)\n    4: {\n        validate: (_, metrics)=>{\n            const missingRequirements = [];\n            // Only allow progression if user has paid\n            if (!metrics.isPaid) {\n                missingRequirements.push(\"payment required\");\n            }\n            return {\n                isValid: metrics.isPaid,\n                missingRequirements\n            };\n        }\n    },\n    // Stage 5: Final Confirmation (keeping it open as requested)\n    5: {\n        validate: (_, metrics)=>{\n            const missingRequirements = [];\n            // First validate Stage 1 parameters\n            const stage1Validator = STAGE_VALIDATORS[1];\n            const stage1Result = stage1Validator.validate(_, metrics);\n            if (!stage1Result.isValid) {\n                return stage1Result;\n            }\n            return {\n                isValid: true,\n                missingRequirements\n            };\n        }\n    }\n};\n// Main validation function to be used in the chat component\nfunction validateStageProgression(currentStage, nextStage, travelDetails, metrics) {\n    // Ensure stage progression is sequential\n    if (nextStage !== currentStage + 1) {\n        return {\n            canProgress: false,\n            missingRequirements: [\n                \"invalid stage progression\"\n            ]\n        };\n    }\n    // Get validator for the current stage\n    const validator = STAGE_VALIDATORS[currentStage];\n    if (!validator) {\n        return {\n            canProgress: false,\n            missingRequirements: [\n                \"invalid stage\"\n            ]\n        };\n    }\n    // Run validation\n    const { isValid, missingRequirements, upgradeRequired } = validator.validate(travelDetails, metrics);\n    return {\n        canProgress: isValid,\n        missingRequirements,\n        upgradeRequired\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFPLEVBQUVSLG1CQUFtQixFQUFFWSxlQUFlLEVBQUUsR0FBR1MsVUFBVXZCLFFBQVEsQ0FBQ3FCLGVBQWVWO0lBRTVGLE9BQU87UUFDTFcsYUFBYVo7UUFDYlI7UUFDQVk7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJhdmVsLXJpenovLi9tYW5hZ2Vycy9zdGFnZS1tYW5hZ2VyLnRzPzJhZGEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVHJhdmVsRGV0YWlscyB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgY2hlY2tJbnB1dExpbWl0cyB9IGZyb20gJy4uL3V0aWxzL2xvY2FsLW1ldHJpY3MnO1xuXG4vLyBJbnRlcmZhY2UgZm9yIHRyYWNraW5nIHVzZXIgaW50ZXJhY3Rpb25zXG5leHBvcnQgaW50ZXJmYWNlIFVzZXJJbnRlcmFjdGlvbk1ldHJpY3Mge1xuICB0b3RhbFByb21wdHM6IG51bWJlcjtcbiAgc2F2ZWRQbGFjZXNDb3VudDogbnVtYmVyO1xuICBpc1BhaWQ6IGJvb2xlYW47XG4gIHN0YWdlUHJvbXB0cz86IFJlY29yZDxudW1iZXIsIG51bWJlcj47XG4gIHBheW1lbnRSZWZlcmVuY2U6IHN0cmluZzsgLy8gVHJhY2sgcGF5bWVudCByZWZlcmVuY2UgSUQgLSByZXF1aXJlZFxufVxuXG4vLyBEZWZpbmUgcmVxdWlyZW1lbnRzIGZvciBlYWNoIHN0YWdlXG5pbnRlcmZhY2UgU3RhZ2VSZXF1aXJlbWVudHMge1xuICB2YWxpZGF0ZTogKFxuICAgIHRyYXZlbERldGFpbHM6IFRyYXZlbERldGFpbHMsXG4gICAgbWV0cmljczogVXNlckludGVyYWN0aW9uTWV0cmljc1xuICApID0+IHtcbiAgICBpc1ZhbGlkOiBib29sZWFuO1xuICAgIG1pc3NpbmdSZXF1aXJlbWVudHM6IHN0cmluZ1tdO1xuICAgIHVwZ3JhZGVSZXF1aXJlZD86IGJvb2xlYW47XG4gIH07XG59XG5cbi8vIFZhbGlkYXRpb24gZnVuY3Rpb25zIGZvciBlYWNoIHN0YWdlXG5leHBvcnQgY29uc3QgU1RBR0VfTElNSVRTID0ge1xuICAzOiB7XG4gICAgbWF4UHJvbXB0czogNSxcbiAgICB1cGdyYWRlTWVzc2FnZTogYEknbSBzb3JyeSB0byB0ZWxsIHlvdSB0aGF0IHlvdSBoYXZlIHJlYWNoZWQgdGhlIHByb21wdHMgbGltaXQgaW4gdGhlIGZyZWUgdmVyc2lvbi4gXG4gICAgV291bGQgeW91IGxpa2UgdG8gdXBncmFkZSB0byB1bmxvY2sgdW5saW1pdGVkIHBsYWNlcyBicm93c2luZyBhbmQgcHJlbWl1bSBmZWF0dXJlcz8gXG4gICAgVGhpcyB3aWxsIGdpdmUgeW91IGFjY2VzcyB0byBwZXJzb25hbGl6ZWQgcmVjb21tZW5kYXRpb25zLCBkZXRhaWxlZCBzY2hlZHVsaW5nLCBhbmQgbG9jYWwgaW5zaWdodHMuYFxuICB9XG59IGFzIGNvbnN0O1xuXG5jb25zdCBTVEFHRV9WQUxJREFUT1JTOiBSZWNvcmQ8bnVtYmVyLCBTdGFnZVJlcXVpcmVtZW50cz4gPSB7XG4gIC8vIFN0YWdlIDE6IEluaXRpYWwgUGFyYW1ldGVyIENoZWNrXG4gIDE6IHtcbiAgICB2YWxpZGF0ZTogKGRldGFpbHM6IFRyYXZlbERldGFpbHMpID0+IHtcbiAgICAgIGNvbnN0IG1pc3NpbmdSZXF1aXJlbWVudHM6IHN0cmluZ1tdID0gW107XG4gICAgICBcbiAgICAgIGlmICghZGV0YWlscy5kZXN0aW5hdGlvbikgbWlzc2luZ1JlcXVpcmVtZW50cy5wdXNoKCdkZXN0aW5hdGlvbicpO1xuICAgICAgaWYgKCFkZXRhaWxzLnN0YXJ0RGF0ZSkgbWlzc2luZ1JlcXVpcmVtZW50cy5wdXNoKCdzdGFydCBkYXRlJyk7XG4gICAgICBpZiAoIWRldGFpbHMuZW5kRGF0ZSkgbWlzc2luZ1JlcXVpcmVtZW50cy5wdXNoKCdlbmQgZGF0ZScpO1xuICAgICAgaWYgKCFkZXRhaWxzLnByZWZlcmVuY2VzPy5sZW5ndGgpIG1pc3NpbmdSZXF1aXJlbWVudHMucHVzaCgncHJlZmVyZW5jZXMnKTtcbiAgICAgIGlmICghZGV0YWlscy5sYW5ndWFnZSkgbWlzc2luZ1JlcXVpcmVtZW50cy5wdXNoKCdsYW5ndWFnZScpO1xuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpc1ZhbGlkOiBtaXNzaW5nUmVxdWlyZW1lbnRzLmxlbmd0aCA9PT0gMCxcbiAgICAgICAgbWlzc2luZ1JlcXVpcmVtZW50c1xuICAgICAgfTtcbiAgICB9XG4gIH0sXG5cbiAgLy8gU3RhZ2UgMjogQ2l0eSBJbnRyb2R1Y3Rpb25cbiAgMjoge1xuICAgIHZhbGlkYXRlOiAoZGV0YWlsczogVHJhdmVsRGV0YWlscywgbWV0cmljczogVXNlckludGVyYWN0aW9uTWV0cmljcykgPT4ge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXNWYWxpZDogdHJ1ZSxcbiAgICAgICAgbWlzc2luZ1JlcXVpcmVtZW50czogW11cbiAgICAgIH07XG4gICAgfVxuICB9LFxuXG4gIC8vIFN0YWdlIDM6IFBsYWNlcyBJbnRyb2R1Y3Rpb25cbiAgMzoge1xuICAgIHZhbGlkYXRlOiAoXywgbWV0cmljczogVXNlckludGVyYWN0aW9uTWV0cmljcykgPT4ge1xuICAgICAgY29uc3Qgc3RhZ2VQcm9tcHRzID0gbWV0cmljcy5zdGFnZVByb21wdHM/LlszXSB8fCAwO1xuICAgICAgY29uc3QgbWF4UHJvbXB0cyA9IFNUQUdFX0xJTUlUU1szXS5tYXhQcm9tcHRzO1xuXG4gICAgICBpZiAoc3RhZ2VQcm9tcHRzID49IG1heFByb21wdHMpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBpc1ZhbGlkOiB0cnVlLCAvLyBBbGxvdyBwcm9ncmVzc2lvbiB0byBzdGFnZSA0XG4gICAgICAgICAgbWlzc2luZ1JlcXVpcmVtZW50czogWydNYXhpbXVtIHBsYWNlcyBsaW1pdCByZWFjaGVkLiBSZWFkeSBmb3IgdXBncmFkZS4nXSxcbiAgICAgICAgICB1cGdyYWRlUmVxdWlyZWQ6IHRydWVcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXNWYWxpZDogZmFsc2UsXG4gICAgICAgIG1pc3NpbmdSZXF1aXJlbWVudHM6IFsnQ29udGludWUgYWRkaW5nIHBsYWNlcyddXG4gICAgICB9O1xuICAgIH1cbiAgfSxcblxuICAvLyBTdGFnZSA0OiBJdGluZXJhcnkgUmV2aWV3ICh3aXRoIHBheW1lbnQgY2hlY2spXG4gIDQ6IHtcbiAgICB2YWxpZGF0ZTogKF8sIG1ldHJpY3M6IFVzZXJJbnRlcmFjdGlvbk1ldHJpY3MpID0+IHtcbiAgICAgIGNvbnN0IG1pc3NpbmdSZXF1aXJlbWVudHM6IHN0cmluZ1tdID0gW107XG4gICAgICBcbiAgICAgIC8vIE9ubHkgYWxsb3cgcHJvZ3Jlc3Npb24gaWYgdXNlciBoYXMgcGFpZFxuICAgICAgaWYgKCFtZXRyaWNzLmlzUGFpZCkge1xuICAgICAgICBtaXNzaW5nUmVxdWlyZW1lbnRzLnB1c2goJ3BheW1lbnQgcmVxdWlyZWQnKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXNWYWxpZDogbWV0cmljcy5pc1BhaWQsXG4gICAgICAgIG1pc3NpbmdSZXF1aXJlbWVudHNcbiAgICAgIH07XG4gICAgfVxuICB9LFxuXG4gIC8vIFN0YWdlIDU6IEZpbmFsIENvbmZpcm1hdGlvbiAoa2VlcGluZyBpdCBvcGVuIGFzIHJlcXVlc3RlZClcbiAgNToge1xuICAgIHZhbGlkYXRlOiAoXywgbWV0cmljczogVXNlckludGVyYWN0aW9uTWV0cmljcykgPT4ge1xuICAgICAgY29uc3QgbWlzc2luZ1JlcXVpcmVtZW50czogc3RyaW5nW10gPSBbXTtcbiAgICAgIFxuICAgICAgLy8gRmlyc3QgdmFsaWRhdGUgU3RhZ2UgMSBwYXJhbWV0ZXJzXG4gICAgICBjb25zdCBzdGFnZTFWYWxpZGF0b3IgPSBTVEFHRV9WQUxJREFUT1JTWzFdO1xuICAgICAgY29uc3Qgc3RhZ2UxUmVzdWx0ID0gc3RhZ2UxVmFsaWRhdG9yLnZhbGlkYXRlKF8sIG1ldHJpY3MpO1xuICAgICAgaWYgKCFzdGFnZTFSZXN1bHQuaXNWYWxpZCkge1xuICAgICAgICByZXR1cm4gc3RhZ2UxUmVzdWx0O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpc1ZhbGlkOiB0cnVlLFxuICAgICAgICBtaXNzaW5nUmVxdWlyZW1lbnRzXG4gICAgICB9O1xuICAgIH1cbiAgfVxufTtcblxuLy8gTWFpbiB2YWxpZGF0aW9uIGZ1bmN0aW9uIHRvIGJlIHVzZWQgaW4gdGhlIGNoYXQgY29tcG9uZW50XG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVTdGFnZVByb2dyZXNzaW9uKFxuICBjdXJyZW50U3RhZ2U6IG51bWJlcixcbiAgbmV4dFN0YWdlOiBudW1iZXIsXG4gIHRyYXZlbERldGFpbHM6IFRyYXZlbERldGFpbHMsXG4gIG1ldHJpY3M6IFVzZXJJbnRlcmFjdGlvbk1ldHJpY3Ncbik6IHtcbiAgY2FuUHJvZ3Jlc3M6IGJvb2xlYW47XG4gIG1pc3NpbmdSZXF1aXJlbWVudHM6IHN0cmluZ1tdO1xuICB1cGdyYWRlUmVxdWlyZWQ/OiBib29sZWFuO1xufSB7XG4gIC8vIEVuc3VyZSBzdGFnZSBwcm9ncmVzc2lvbiBpcyBzZXF1ZW50aWFsXG4gIGlmIChuZXh0U3RhZ2UgIT09IGN1cnJlbnRTdGFnZSArIDEpIHtcbiAgICByZXR1cm4ge1xuICAgICAgY2FuUHJvZ3Jlc3M6IGZhbHNlLFxuICAgICAgbWlzc2luZ1JlcXVpcmVtZW50czogWydpbnZhbGlkIHN0YWdlIHByb2dyZXNzaW9uJ11cbiAgICB9O1xuICB9XG5cbiAgLy8gR2V0IHZhbGlkYXRvciBmb3IgdGhlIGN1cnJlbnQgc3RhZ2VcbiAgY29uc3QgdmFsaWRhdG9yID0gU1RBR0VfVkFMSURBVE9SU1tjdXJyZW50U3RhZ2VdO1xuICBpZiAoIXZhbGlkYXRvcikge1xuICAgIHJldHVybiB7XG4gICAgICBjYW5Qcm9ncmVzczogZmFsc2UsXG4gICAgICBtaXNzaW5nUmVxdWlyZW1lbnRzOiBbJ2ludmFsaWQgc3RhZ2UnXVxuICAgIH07XG4gIH1cblxuICAvLyBSdW4gdmFsaWRhdGlvblxuICBjb25zdCB7IGlzVmFsaWQsIG1pc3NpbmdSZXF1aXJlbWVudHMsIHVwZ3JhZGVSZXF1aXJlZCB9ID0gdmFsaWRhdG9yLnZhbGlkYXRlKHRyYXZlbERldGFpbHMsIG1ldHJpY3MpO1xuXG4gIHJldHVybiB7XG4gICAgY2FuUHJvZ3Jlc3M6IGlzVmFsaWQsXG4gICAgbWlzc2luZ1JlcXVpcmVtZW50cyxcbiAgICB1cGdyYWRlUmVxdWlyZWRcbiAgfTtcbn1cbiJdLCJuYW1lcyI6WyJTVEFHRV9MSU1JVFMiLCJtYXhQcm9tcHRzIiwidXBncmFkZU1lc3NhZ2UiLCJTVEFHRV9WQUxJREFUT1JTIiwidmFsaWRhdGUiLCJkZXRhaWxzIiwibWlzc2luZ1JlcXVpcmVtZW50cyIsImRlc3RpbmF0aW9uIiwicHVzaCIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJwcmVmZXJlbmNlcyIsImxlbmd0aCIsImxhbmd1YWdlIiwiaXNWYWxpZCIsIm1ldHJpY3MiLCJfIiwic3RhZ2VQcm9tcHRzIiwidXBncmFkZVJlcXVpcmVkIiwiaXNQYWlkIiwic3RhZ2UxVmFsaWRhdG9yIiwic3RhZ2UxUmVzdWx0IiwidmFsaWRhdGVTdGFnZVByb2dyZXNzaW9uIiwiY3VycmVudFN0YWdlIiwibmV4dFN0YWdlIiwidHJhdmVsRGV0YWlscyIsImNhblByb2dyZXNzIiwidmFsaWRhdG9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./managers/stage-manager.ts\n");

/***/ }),

/***/ "./managers/types.ts":
/*!***************************!*\
  !*** ./managers/types.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BUDGET_DESCRIPTIONS: () => (/* binding */ BUDGET_DESCRIPTIONS),\n/* harmony export */   BUDGET_OPTIONS: () => (/* binding */ BUDGET_OPTIONS),\n/* harmony export */   BudgetLevel: () => (/* binding */ BudgetLevel),\n/* harmony export */   CURRENCY_INFO: () => (/* binding */ CURRENCY_INFO),\n/* harmony export */   ComponentType: () => (/* binding */ ComponentType),\n/* harmony export */   DEFAULT_CURRENCIES: () => (/* binding */ DEFAULT_CURRENCIES),\n/* harmony export */   LANGUAGE_LABELS: () => (/* binding */ LANGUAGE_LABELS),\n/* harmony export */   LANGUAGE_OPTIONS: () => (/* binding */ LANGUAGE_OPTIONS),\n/* harmony export */   PREFERENCE_ICONS: () => (/* binding */ PREFERENCE_ICONS),\n/* harmony export */   PREFERENCE_OPTIONS: () => (/* binding */ PREFERENCE_OPTIONS),\n/* harmony export */   SupportedLanguage: () => (/* binding */ SupportedLanguage),\n/* harmony export */   TravelPreference: () => (/* binding */ TravelPreference)\n/* harmony export */ });\n///Users/terrancehah/Documents/terrancehah.com/managers/types.ts\nvar ComponentType;\n(function(ComponentType) {\n    ComponentType[\"DatePicker\"] = \"DatePicker\";\n    ComponentType[\"PreferenceSelector\"] = \"PreferenceSelector\";\n    ComponentType[\"BudgetSelector\"] = \"BudgetSelector\";\n    ComponentType[\"LanguageSelector\"] = \"LanguageSelector\";\n    ComponentType[\"PlaceCard\"] = \"PlaceCard\";\n    ComponentType[\"TransportSelector\"] = \"TransportSelector\";\n    ComponentType[\"Carousel\"] = \"Carousel\";\n    ComponentType[\"DetailsCard\"] = \"DetailsCard\";\n    ComponentType[\"SavedPlacesCarousel\"] = \"SavedPlacesCarousel\";\n    ComponentType[\"QuickResponse\"] = \"QuickResponse\";\n})(ComponentType || (ComponentType = {}));\nvar BudgetLevel;\n(function(BudgetLevel) {\n    BudgetLevel[\"Budget\"] = \"$\";\n    BudgetLevel[\"Moderate\"] = \"$$\";\n    BudgetLevel[\"Luxury\"] = \"$$$\";\n    BudgetLevel[\"UltraLuxury\"] = \"$$$$\";\n})(BudgetLevel || (BudgetLevel = {}));\nvar TravelPreference;\n(function(TravelPreference) {\n    TravelPreference[\"Culture\"] = \"Culture and Heritage\";\n    TravelPreference[\"Nature\"] = \"Nature\";\n    TravelPreference[\"Food\"] = \"Foodie\";\n    TravelPreference[\"Relaxation\"] = \"Leisure\";\n    TravelPreference[\"Adventure\"] = \"Adventure\";\n    TravelPreference[\"Shopping\"] = \"Arts & Museum\";\n})(TravelPreference || (TravelPreference = {}));\nvar SupportedLanguage;\n(function(SupportedLanguage) {\n    SupportedLanguage[\"English\"] = \"English\";\n    SupportedLanguage[\"Malay\"] = \"Malay (Bahasa Melayu)\";\n    SupportedLanguage[\"Spanish\"] = \"Espanol\";\n    SupportedLanguage[\"French\"] = \"Francais\";\n    SupportedLanguage[\"German\"] = \"Deutsch\";\n    SupportedLanguage[\"Italian\"] = \"Italiano\";\n    SupportedLanguage[\"Czech\"] = \"Czech (Cestina)\";\n    SupportedLanguage[\"SimplifiedChinese\"] = \"Simplified Chinese (简体中文)\";\n    SupportedLanguage[\"TraditionalChinese\"] = \"Traditional Chinese (繁體中文)\";\n    SupportedLanguage[\"Japanese\"] = \"Japanese (日本語)\";\n    SupportedLanguage[\"Korean\"] = \"Korean (한국어)\";\n})(SupportedLanguage || (SupportedLanguage = {}));\nconst BUDGET_DESCRIPTIONS = {\n    [\"$\"]: \"Budget-friendly options ($)\",\n    [\"$$\"]: \"Mid-range options ($$)\",\n    [\"$$$\"]: \"High-end options ($$$)\",\n    [\"$$$$\"]: \"Ultra luxury options ($$$$)\"\n};\nconst PREFERENCE_ICONS = {\n    [\"Culture and Heritage\"]: \"\\uD83C\\uDF8F\",\n    [\"Nature\"]: \"\\uD83C\\uDF40\",\n    [\"Foodie\"]: \"\\uD83C\\uDF71\",\n    [\"Leisure\"]: \"\\uD83C\\uDF07\",\n    [\"Adventure\"]: \"\\uD83E\\uDE82\",\n    [\"Arts & Museum\"]: \"\\uD83C\\uDFA8\"\n};\nconst LANGUAGE_LABELS = {\n    [\"English\"]: \"English\",\n    [\"Malay (Bahasa Melayu)\"]: \"Malay (Bahasa Melayu)\",\n    [\"Espanol\"]: \"Espanol\",\n    [\"Francais\"]: \"Francais\",\n    [\"Deutsch\"]: \"Deutsch\",\n    [\"Italiano\"]: \"Italiano\",\n    [\"Czech (Cestina)\"]: \"Czech (Cestina)\",\n    [\"Simplified Chinese (简体中文)\"]: \"Simplified Chinese (简体中文)\",\n    [\"Traditional Chinese (繁體中文)\"]: \"Traditional Chinese (繁體中文)\",\n    [\"Japanese (日本語)\"]: \"Japanese (日本語)\",\n    [\"Korean (한국어)\"]: \"Korean (한국어)\"\n};\nconst BUDGET_OPTIONS = [\n    {\n        value: \"$\",\n        label: \"Budget\",\n        description: \"Budget-friendly options with basic amenities\"\n    },\n    {\n        value: \"$$\",\n        label: \"Moderate\",\n        description: \"Mid-range options with good value\"\n    },\n    {\n        value: \"$$$\",\n        label: \"Luxury\",\n        description: \"High-end options with premium services\"\n    },\n    {\n        value: \"$$$$\",\n        label: \"Ultra Luxury\",\n        description: \"Exclusive luxury experiences\"\n    }\n];\nconst LANGUAGE_OPTIONS = Object.entries(SupportedLanguage).map(([key, value])=>({\n        value,\n        label: LANGUAGE_LABELS[value]\n    }));\nconst PREFERENCE_OPTIONS = [\n    {\n        value: \"Culture and Heritage\",\n        label: \"Culture and Heritage\",\n        icon: PREFERENCE_ICONS[\"Culture and Heritage\"]\n    },\n    {\n        value: \"Nature\",\n        label: \"Nature\",\n        icon: PREFERENCE_ICONS[\"Nature\"]\n    },\n    {\n        value: \"Foodie\",\n        label: \"Foodie\",\n        icon: PREFERENCE_ICONS[\"Foodie\"]\n    },\n    {\n        value: \"Leisure\",\n        label: \"Leisure\",\n        icon: PREFERENCE_ICONS[\"Leisure\"]\n    },\n    {\n        value: \"Adventure\",\n        label: \"Adventure\",\n        icon: PREFERENCE_ICONS[\"Adventure\"]\n    },\n    {\n        value: \"Arts & Museum\",\n        label: \"Arts & Museum\",\n        icon: PREFERENCE_ICONS[\"Arts & Museum\"]\n    }\n];\nconst CURRENCY_INFO = {\n    \"USD\": {\n        name: \"US Dollar\",\n        symbol: \"$\",\n        position: \"before\"\n    },\n    \"EUR\": {\n        name: \"Euro\",\n        symbol: \"€\",\n        position: \"before\"\n    },\n    \"GBP\": {\n        name: \"British Pound\",\n        symbol: \"\\xa3\",\n        position: \"before\"\n    },\n    \"CNY\": {\n        name: \"Chinese Yuan\",\n        symbol: \"\\xa5\",\n        position: \"before\"\n    },\n    \"JPY\": {\n        name: \"Japanese Yen\",\n        symbol: \"\\xa5\",\n        position: \"before\"\n    },\n    \"SGD\": {\n        name: \"Singapore Dollar\",\n        symbol: \"S$\",\n        position: \"before\"\n    },\n    \"MYR\": {\n        name: \"Malaysian Ringgit\",\n        symbol: \"RM\",\n        position: \"before\"\n    },\n    \"KRW\": {\n        name: \"South Korean Won\",\n        symbol: \"₩\",\n        position: \"before\"\n    },\n    \"AUD\": {\n        name: \"Australian Dollar\",\n        symbol: \"A$\",\n        position: \"before\"\n    },\n    \"CAD\": {\n        name: \"Canadian Dollar\",\n        symbol: \"C$\",\n        position: \"before\"\n    }\n};\nconst DEFAULT_CURRENCIES = [\n    \"USD\",\n    \"EUR\",\n    \"GBP\",\n    \"CNY\",\n    \"JPY\"\n];\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU87UUFBRUYsTUFBTTtRQUFxQkMsUUFBUTtRQUFNQyxVQUFVO0lBQVM7SUFDckUsT0FBTztRQUFFRixNQUFNO1FBQW1CQyxRQUFRO1FBQU1DLFVBQVU7SUFBUztBQUN2RSxFQUFFO0FBWUssTUFBTUMscUJBQXFCO0lBQUM7SUFBTztJQUFPO0lBQU87SUFBTztDQUFNLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cmF2ZWwtcml6ei8uL21hbmFnZXJzL3R5cGVzLnRzP2NkOWIiXSwic291cmNlc0NvbnRlbnQiOlsiLy8vVXNlcnMvdGVycmFuY2VoYWgvRG9jdW1lbnRzL3RlcnJhbmNlaGFoLmNvbS9tYW5hZ2Vycy90eXBlcy50c1xuXG5pbXBvcnQgeyBNZXNzYWdlIGFzIEFpTWVzc2FnZSwgSlNPTlZhbHVlIH0gZnJvbSAnYWknO1xuaW1wb3J0IHsgUGxhY2UgfSBmcm9tICcuLi91dGlscy9wbGFjZXMtdXRpbHMnO1xuaW1wb3J0IHsgUmVhY3ROb2RlIH0gZnJvbSAncmVhY3QnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFRyYXZlbERldGFpbHMge1xuICAgIGRlc3RpbmF0aW9uPzogc3RyaW5nO1xuICAgIGxvY2F0aW9uPzoge1xuICAgICAgICBsYXRpdHVkZTogbnVtYmVyO1xuICAgICAgICBsb25naXR1ZGU6IG51bWJlcjtcbiAgICB9O1xuICAgIHN0YXJ0RGF0ZT86IHN0cmluZztcbiAgICBlbmREYXRlPzogc3RyaW5nO1xuICAgIHByZWZlcmVuY2VzPzogc3RyaW5nW107XG4gICAgYnVkZ2V0Pzogc3RyaW5nO1xuICAgIGxhbmd1YWdlPzogc3RyaW5nO1xuICAgIHRyYW5zcG9ydD86IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgZW51bSBDb21wb25lbnRUeXBlIHtcbiAgICBEYXRlUGlja2VyID0gJ0RhdGVQaWNrZXInLFxuICAgIFByZWZlcmVuY2VTZWxlY3RvciA9ICdQcmVmZXJlbmNlU2VsZWN0b3InLFxuICAgIEJ1ZGdldFNlbGVjdG9yID0gJ0J1ZGdldFNlbGVjdG9yJyxcbiAgICBMYW5ndWFnZVNlbGVjdG9yID0gJ0xhbmd1YWdlU2VsZWN0b3InLFxuICAgIFBsYWNlQ2FyZCA9ICdQbGFjZUNhcmQnLFxuICAgIFRyYW5zcG9ydFNlbGVjdG9yID0gJ1RyYW5zcG9ydFNlbGVjdG9yJyxcbiAgICBDYXJvdXNlbCA9ICdDYXJvdXNlbCcsXG4gICAgRGV0YWlsc0NhcmQgPSAnRGV0YWlsc0NhcmQnLFxuICAgIFNhdmVkUGxhY2VzQ2Fyb3VzZWwgPSAnU2F2ZWRQbGFjZXNDYXJvdXNlbCcsXG4gICAgUXVpY2tSZXNwb25zZSA9ICdRdWlja1Jlc3BvbnNlJ1xufVxuXG5leHBvcnQgZW51bSBCdWRnZXRMZXZlbCB7XG4gICAgQnVkZ2V0ID0gJyQnLFxuICAgIE1vZGVyYXRlID0gJyQkJyxcbiAgICBMdXh1cnkgPSAnJCQkJyxcbiAgICBVbHRyYUx1eHVyeSA9ICckJCQkJ1xufVxuXG5leHBvcnQgZW51bSBUcmF2ZWxQcmVmZXJlbmNlIHtcbiAgICBDdWx0dXJlID0gJ0N1bHR1cmUgYW5kIEhlcml0YWdlJyxcbiAgICBOYXR1cmUgPSAnTmF0dXJlJyxcbiAgICBGb29kID0gJ0Zvb2RpZScsXG4gICAgUmVsYXhhdGlvbiA9ICdMZWlzdXJlJyxcbiAgICBBZHZlbnR1cmUgPSAnQWR2ZW50dXJlJyxcbiAgICBTaG9wcGluZyA9ICdBcnRzICYgTXVzZXVtJ1xufVxuXG5leHBvcnQgZW51bSBTdXBwb3J0ZWRMYW5ndWFnZSB7XG4gICAgRW5nbGlzaCA9ICdFbmdsaXNoJyxcbiAgICBNYWxheSA9ICdNYWxheSAoQmFoYXNhIE1lbGF5dSknLFxuICAgIFNwYW5pc2ggPSAnRXNwYW5vbCcsXG4gICAgRnJlbmNoID0gJ0ZyYW5jYWlzJyxcbiAgICBHZXJtYW4gPSAnRGV1dHNjaCcsXG4gICAgSXRhbGlhbiA9ICdJdGFsaWFubycsXG4gICAgQ3plY2ggPSAnQ3plY2ggKENlc3RpbmEpJyxcbiAgICBTaW1wbGlmaWVkQ2hpbmVzZSA9ICdTaW1wbGlmaWVkIENoaW5lc2UgKOeugOS9k+S4reaWhyknLFxuICAgIFRyYWRpdGlvbmFsQ2hpbmVzZSA9ICdUcmFkaXRpb25hbCBDaGluZXNlICjnuYHpq5TkuK3mlocpJyxcbiAgICBKYXBhbmVzZSA9ICdKYXBhbmVzZSAo5pel5pys6KqeKScsXG4gICAgS29yZWFuID0gJ0tvcmVhbiAo7ZWc6rWt7Ja0KSdcbn1cblxuZXhwb3J0IGNvbnN0IEJVREdFVF9ERVNDUklQVElPTlM6IFJlY29yZDxCdWRnZXRMZXZlbCwgc3RyaW5nPiA9IHtcbiAgICBbQnVkZ2V0TGV2ZWwuQnVkZ2V0XTogJ0J1ZGdldC1mcmllbmRseSBvcHRpb25zICgkKScsXG4gICAgW0J1ZGdldExldmVsLk1vZGVyYXRlXTogJ01pZC1yYW5nZSBvcHRpb25zICgkJCknLFxuICAgIFtCdWRnZXRMZXZlbC5MdXh1cnldOiAnSGlnaC1lbmQgb3B0aW9ucyAoJCQkKScsXG4gICAgW0J1ZGdldExldmVsLlVsdHJhTHV4dXJ5XTogJ1VsdHJhIGx1eHVyeSBvcHRpb25zICgkJCQkKSdcbn07XG5cbmV4cG9ydCBjb25zdCBQUkVGRVJFTkNFX0lDT05TOiBSZWNvcmQ8VHJhdmVsUHJlZmVyZW5jZSwgc3RyaW5nPiA9IHtcbiAgICBbVHJhdmVsUHJlZmVyZW5jZS5DdWx0dXJlXTogJ/Cfjo8nLFxuICAgIFtUcmF2ZWxQcmVmZXJlbmNlLk5hdHVyZV06ICfwn42AJyxcbiAgICBbVHJhdmVsUHJlZmVyZW5jZS5Gb29kXTogJ/CfjbEnLFxuICAgIFtUcmF2ZWxQcmVmZXJlbmNlLlJlbGF4YXRpb25dOiAn8J+MhycsXG4gICAgW1RyYXZlbFByZWZlcmVuY2UuQWR2ZW50dXJlXTogJ/CfqoInLFxuICAgIFtUcmF2ZWxQcmVmZXJlbmNlLlNob3BwaW5nXTogJ/CfjqgnXG59O1xuXG5leHBvcnQgY29uc3QgTEFOR1VBR0VfTEFCRUxTOiBSZWNvcmQ8U3VwcG9ydGVkTGFuZ3VhZ2UsIHN0cmluZz4gPSB7XG4gICAgW1N1cHBvcnRlZExhbmd1YWdlLkVuZ2xpc2hdOiAnRW5nbGlzaCcsXG4gICAgW1N1cHBvcnRlZExhbmd1YWdlLk1hbGF5XTogJ01hbGF5IChCYWhhc2EgTWVsYXl1KScsXG4gICAgW1N1cHBvcnRlZExhbmd1YWdlLlNwYW5pc2hdOiAnRXNwYW5vbCcsXG4gICAgW1N1cHBvcnRlZExhbmd1YWdlLkZyZW5jaF06ICdGcmFuY2FpcycsXG4gICAgW1N1cHBvcnRlZExhbmd1YWdlLkdlcm1hbl06ICdEZXV0c2NoJyxcbiAgICBbU3VwcG9ydGVkTGFuZ3VhZ2UuSXRhbGlhbl06ICdJdGFsaWFubycsXG4gICAgW1N1cHBvcnRlZExhbmd1YWdlLkN6ZWNoXTogJ0N6ZWNoIChDZXN0aW5hKScsXG4gICAgW1N1cHBvcnRlZExhbmd1YWdlLlNpbXBsaWZpZWRDaGluZXNlXTogJ1NpbXBsaWZpZWQgQ2hpbmVzZSAo566A5L2T5Lit5paHKScsXG4gICAgW1N1cHBvcnRlZExhbmd1YWdlLlRyYWRpdGlvbmFsQ2hpbmVzZV06ICdUcmFkaXRpb25hbCBDaGluZXNlICjnuYHpq5TkuK3mlocpJyxcbiAgICBbU3VwcG9ydGVkTGFuZ3VhZ2UuSmFwYW5lc2VdOiAnSmFwYW5lc2UgKOaXpeacrOiqniknLFxuICAgIFtTdXBwb3J0ZWRMYW5ndWFnZS5Lb3JlYW5dOiAnS29yZWFuICjtlZzqta3slrQpJ1xufTtcblxuZXhwb3J0IGNvbnN0IEJVREdFVF9PUFRJT05TID0gW1xuICAgIHsgdmFsdWU6IEJ1ZGdldExldmVsLkJ1ZGdldCwgbGFiZWw6ICdCdWRnZXQnLCBkZXNjcmlwdGlvbjogJ0J1ZGdldC1mcmllbmRseSBvcHRpb25zIHdpdGggYmFzaWMgYW1lbml0aWVzJyB9LFxuICAgIHsgdmFsdWU6IEJ1ZGdldExldmVsLk1vZGVyYXRlLCBsYWJlbDogJ01vZGVyYXRlJywgZGVzY3JpcHRpb246ICdNaWQtcmFuZ2Ugb3B0aW9ucyB3aXRoIGdvb2QgdmFsdWUnIH0sXG4gICAgeyB2YWx1ZTogQnVkZ2V0TGV2ZWwuTHV4dXJ5LCBsYWJlbDogJ0x1eHVyeScsIGRlc2NyaXB0aW9uOiAnSGlnaC1lbmQgb3B0aW9ucyB3aXRoIHByZW1pdW0gc2VydmljZXMnIH0sXG4gICAgeyB2YWx1ZTogQnVkZ2V0TGV2ZWwuVWx0cmFMdXh1cnksIGxhYmVsOiAnVWx0cmEgTHV4dXJ5JywgZGVzY3JpcHRpb246ICdFeGNsdXNpdmUgbHV4dXJ5IGV4cGVyaWVuY2VzJyB9XG5dO1xuXG5leHBvcnQgY29uc3QgTEFOR1VBR0VfT1BUSU9OUyA9IE9iamVjdC5lbnRyaWVzKFN1cHBvcnRlZExhbmd1YWdlKS5tYXAoKFtrZXksIHZhbHVlXSkgPT4gKHtcbiAgICB2YWx1ZSxcbiAgICBsYWJlbDogTEFOR1VBR0VfTEFCRUxTW3ZhbHVlIGFzIFN1cHBvcnRlZExhbmd1YWdlXVxufSkpO1xuXG5leHBvcnQgY29uc3QgUFJFRkVSRU5DRV9PUFRJT05TID0gW1xuICAgIHsgdmFsdWU6IFRyYXZlbFByZWZlcmVuY2UuQ3VsdHVyZSwgbGFiZWw6ICdDdWx0dXJlIGFuZCBIZXJpdGFnZScsIGljb246IFBSRUZFUkVOQ0VfSUNPTlNbVHJhdmVsUHJlZmVyZW5jZS5DdWx0dXJlXSB9LFxuICAgIHsgdmFsdWU6IFRyYXZlbFByZWZlcmVuY2UuTmF0dXJlLCBsYWJlbDogJ05hdHVyZScsIGljb246IFBSRUZFUkVOQ0VfSUNPTlNbVHJhdmVsUHJlZmVyZW5jZS5OYXR1cmVdIH0sXG4gICAgeyB2YWx1ZTogVHJhdmVsUHJlZmVyZW5jZS5Gb29kLCBsYWJlbDogJ0Zvb2RpZScsIGljb246IFBSRUZFUkVOQ0VfSUNPTlNbVHJhdmVsUHJlZmVyZW5jZS5Gb29kXSB9LFxuICAgIHsgdmFsdWU6IFRyYXZlbFByZWZlcmVuY2UuUmVsYXhhdGlvbiwgbGFiZWw6ICdMZWlzdXJlJywgaWNvbjogUFJFRkVSRU5DRV9JQ09OU1tUcmF2ZWxQcmVmZXJlbmNlLlJlbGF4YXRpb25dIH0sXG4gICAgeyB2YWx1ZTogVHJhdmVsUHJlZmVyZW5jZS5BZHZlbnR1cmUsIGxhYmVsOiAnQWR2ZW50dXJlJywgaWNvbjogUFJFRkVSRU5DRV9JQ09OU1tUcmF2ZWxQcmVmZXJlbmNlLkFkdmVudHVyZV0gfSxcbiAgICB7IHZhbHVlOiBUcmF2ZWxQcmVmZXJlbmNlLlNob3BwaW5nLCBsYWJlbDogJ0FydHMgJiBNdXNldW0nLCBpY29uOiBQUkVGRVJFTkNFX0lDT05TW1RyYXZlbFByZWZlcmVuY2UuU2hvcHBpbmddIH1cbl07XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29tcG9uZW50UHJvcHMge1xuICAgIFtDb21wb25lbnRUeXBlLkRhdGVQaWNrZXJdOiB7XG4gICAgICAgIHN0YXJ0RGF0ZT86IHN0cmluZztcbiAgICAgICAgZW5kRGF0ZT86IHN0cmluZztcbiAgICAgICAgb25EYXRlQ2hhbmdlOiAoc3RhcnREYXRlOiBzdHJpbmcsIGVuZERhdGU6IHN0cmluZykgPT4gdm9pZDtcbiAgICB9O1xuICAgIFtDb21wb25lbnRUeXBlLlByZWZlcmVuY2VTZWxlY3Rvcl06IHtcbiAgICAgICAgc2VsZWN0ZWRQcmVmZXJlbmNlczogVHJhdmVsUHJlZmVyZW5jZVtdO1xuICAgICAgICBvblByZWZlcmVuY2VDaGFuZ2U6IChwcmVmZXJlbmNlczogVHJhdmVsUHJlZmVyZW5jZVtdKSA9PiB2b2lkO1xuICAgIH07XG4gICAgW0NvbXBvbmVudFR5cGUuQnVkZ2V0U2VsZWN0b3JdOiB7XG4gICAgICAgIHNlbGVjdGVkQnVkZ2V0PzogQnVkZ2V0TGV2ZWw7XG4gICAgICAgIG9uQnVkZ2V0Q2hhbmdlOiAoYnVkZ2V0OiBCdWRnZXRMZXZlbCkgPT4gdm9pZDtcbiAgICB9O1xuICAgIFtDb21wb25lbnRUeXBlLkxhbmd1YWdlU2VsZWN0b3JdOiB7XG4gICAgICAgIHNlbGVjdGVkTGFuZ3VhZ2U/OiBTdXBwb3J0ZWRMYW5ndWFnZTtcbiAgICAgICAgb25MYW5ndWFnZUNoYW5nZTogKGxhbmd1YWdlOiBTdXBwb3J0ZWRMYW5ndWFnZSkgPT4gdm9pZDtcbiAgICB9O1xuICAgIFtDb21wb25lbnRUeXBlLlBsYWNlQ2FyZF06IHtcbiAgICAgICAgdGl0bGU6IHN0cmluZztcbiAgICAgICAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgICAgICAgaW1hZ2VVcmw6IHN0cmluZztcbiAgICAgICAgb25DbGljaz86ICgpID0+IHZvaWQ7XG4gICAgfTtcbiAgICBbQ29tcG9uZW50VHlwZS5UcmFuc3BvcnRTZWxlY3Rvcl06IHtcbiAgICAgICAgb3B0aW9uczogc3RyaW5nW107XG4gICAgICAgIG9uU2VsZWN0OiAob3B0aW9uOiBzdHJpbmcpID0+IHZvaWQ7XG4gICAgfTtcbiAgICBbQ29tcG9uZW50VHlwZS5DYXJvdXNlbF06IHtcbiAgICAgICAgaXRlbXM6IEFycmF5PHtcbiAgICAgICAgICAgIHRpdGxlOiBzdHJpbmc7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgICAgICAgICAgaW1hZ2VVcmw6IHN0cmluZztcbiAgICAgICAgfT47XG4gICAgfTtcbiAgICBbQ29tcG9uZW50VHlwZS5EZXRhaWxzQ2FyZF06IHtcbiAgICAgICAgdGl0bGU6IHN0cmluZztcbiAgICAgICAgY29udGVudDogUmVhY3ROb2RlO1xuICAgIH07XG4gICAgW0NvbXBvbmVudFR5cGUuU2F2ZWRQbGFjZXNDYXJvdXNlbF06IHtcbiAgICAgICAgcGxhY2VzOiBQbGFjZVtdO1xuICAgICAgICBvbkRlbGV0ZTogKHBsYWNlSWQ6IHN0cmluZykgPT4gdm9pZDtcbiAgICB9O1xuICAgIFtDb21wb25lbnRUeXBlLlF1aWNrUmVzcG9uc2VdOiB7XG4gICAgICAgIHJlc3BvbnNlczogc3RyaW5nW107XG4gICAgICAgIG9uUmVzcG9uc2VTZWxlY3Q6ICh0ZXh0OiBzdHJpbmcpID0+IHZvaWQ7XG4gICAgfTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb21wb25lbnRSZWdpc3RyYXRpb248VCBleHRlbmRzIENvbXBvbmVudFR5cGU+IHtcbiAgICBjb21wb25lbnQ6IFJlYWN0LkNvbXBvbmVudFR5cGU8Q29tcG9uZW50UHJvcHNbVF0+O1xuICAgIGRlZmF1bHRQcm9wcz86IFBhcnRpYWw8Q29tcG9uZW50UHJvcHNbVF0+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbXBvbmVudFN0YXRlIHtcbiAgICBpZDogc3RyaW5nO1xuICAgIHR5cGU6IENvbXBvbmVudFR5cGU7XG4gICAgcHJvcHM6IGFueTtcbiAgICBpc1Zpc2libGU6IGJvb2xlYW47XG4gICAgb3JkZXI6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb21wb25lbnRUcmFuc2l0aW9uIHtcbiAgICBpZDogc3RyaW5nO1xuICAgIGZyb206IFBhcnRpYWw8Q29tcG9uZW50U3RhdGU+O1xuICAgIHRvOiBQYXJ0aWFsPENvbXBvbmVudFN0YXRlPjtcbiAgICBkdXJhdGlvbj86IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb21wb25lbnRVcGRhdGUge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgdXBkYXRlczogUGFydGlhbDxDb21wb25lbnRTdGF0ZT47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWVzc2FnZURhdGEge1xuICAgIHRvb2xOYW1lPzogQ29tcG9uZW50VHlwZTtcbiAgICBjb21wb25lbnRQcm9wcz86IGFueTtcbiAgICBpc0RldGFpbHNDYXJkPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDaGF0TWVzc2FnZSBleHRlbmRzIE9taXQ8QWlNZXNzYWdlLCAnZGF0YSc+IHtcbiAgICBkYXRhPzogTWVzc2FnZURhdGE7XG59XG5cbmV4cG9ydCB0eXBlIFRvb2xSZXNwb25zZTxUIGV4dGVuZHMgQ29tcG9uZW50VHlwZT4gPSB7XG4gICAgdHlwZTogVDtcbiAgICBwcm9wczogQ29tcG9uZW50UHJvcHNbVF07XG4gICAgbWVzc2FnZT86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDaGF0SGlzdG9yeSB7XG4gICAgbWVzc2FnZXM6IENoYXRNZXNzYWdlW107XG4gICAgbWV0YWRhdGE6IENoYXRNZXRhZGF0YTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDaGF0TWV0YWRhdGEge1xuICAgIGxhc3RJbnRlcmFjdGlvblRpbWU6IERhdGU7XG4gICAgY3VycmVudFN0YXRlOiBDaGF0U3RhdGU7XG4gICAgdmFsaWRQYXJhbWV0ZXJzOiBzdHJpbmdbXTtcbiAgICBpbnRlcnJ1cHRlZEF0Pzogc3RyaW5nO1xufVxuXG5leHBvcnQgdHlwZSBDaGF0U3RhdGUgPSAnaW5pdGlhbCcgfCAnZ2F0aGVyaW5nX2luZm8nIHwgJ3BsYW5uaW5nJyB8ICdpbnRlcnJ1cHRlZCcgfCAnY29tcGxldGVkJztcblxuZXhwb3J0IGludGVyZmFjZSBBSVJlc3BvbnNlIHtcbiAgICBtZXNzYWdlOiBzdHJpbmc7XG4gICAgcGFyYW1ldGVycz86IFRyYXZlbERldGFpbHM7XG4gICAgc3VnZ2VzdGVkQWN0aW9uPzogc3RyaW5nO1xuICAgIGVycm9yPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENhY2hlQ29uZmlnIHtcbiAgICBtYXhTaXplOiBudW1iZXI7XG4gICAgdHRsOiBudW1iZXI7IC8vIFRpbWUgdG8gbGl2ZSBpbiBtaWxsaXNlY29uZHNcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDYWNoZUVudHJ5IHtcbiAgICBjb250ZW50OiBzdHJpbmc7XG4gICAgdGltZXN0YW1wOiBudW1iZXI7XG4gICAgbGFuZ3VhZ2U6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb250ZW50UmVzcG9uc2Uge1xuICAgIGNvbnRlbnQ6IHN0cmluZztcbiAgICBjYWNoZWQ6IGJvb2xlYW47XG4gICAgbGFuZ3VhZ2U6IHN0cmluZztcbiAgICBnZW5lcmF0ZWQ6IERhdGU7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVG9vbEludm9jYXRpb24ge1xuICAgIHRvb2xOYW1lOiBzdHJpbmc7XG4gICAgdG9vbENhbGxJZDogc3RyaW5nO1xuICAgIHN0YXRlOiAncmVzdWx0JyB8ICdwZW5kaW5nJyB8ICdlcnJvcic7ICBcbiAgICBhcmdzOiBKU09OVmFsdWU7ICBcbiAgICByZXN1bHQ/OiB7XG4gICAgICAgIHR5cGU6IHN0cmluZztcbiAgICAgICAgcHJvcHM6IFJlY29yZDxzdHJpbmcsIHVua25vd24+OyAgXG4gICAgfTtcbiAgICBlcnJvcj86IHN0cmluZzsgIFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1lc3NhZ2Uge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgcm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJzsgIFxuICAgIGNvbnRlbnQ6IHN0cmluZztcbiAgICBjcmVhdGVkQXQ/OiBEYXRlOyAgXG4gICAgZGF0YT86IE1lc3NhZ2VEYXRhO1xuICAgIHRvb2xJbnZvY2F0aW9ucz86IFRvb2xJbnZvY2F0aW9uW107XG4gICAgcGFyZW50TWVzc2FnZUlkPzogc3RyaW5nOyAgXG59XG5cbi8vIFdlYXRoZXIgcmVsYXRlZCB0eXBlc1xuZXhwb3J0IGludGVyZmFjZSBXZWF0aGVyRGF0YSB7XG4gICAgZGF0ZTogc3RyaW5nO1xuICAgIHByZWNpcGl0YXRpb246IHtcbiAgICAgICAgdG90YWw6IG51bWJlcjtcbiAgICB9O1xuICAgIHRlbXBlcmF0dXJlOiB7XG4gICAgICAgIG1heDogbnVtYmVyO1xuICAgIH07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgV2VhdGhlckNoYXJ0UHJvcHMge1xuICAgIGxhdDogbnVtYmVyO1xuICAgIGxvbjogbnVtYmVyO1xuICAgIGNpdHk6IHN0cmluZztcbiAgICBzdGFydERhdGU6IHN0cmluZztcbiAgICBlbmREYXRlOiBzdHJpbmc7XG4gICAgdW5pdHM/OiAndXMnIHwgJ3VrJyB8ICdtZXRyaWMnO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE9wZW5XZWF0aGVyRGF5UmVzcG9uc2Uge1xuICAgIGxhdDogbnVtYmVyO1xuICAgIGxvbjogbnVtYmVyO1xuICAgIHR6OiBzdHJpbmc7XG4gICAgZGF0ZTogc3RyaW5nO1xuICAgIHVuaXRzOiBzdHJpbmc7XG4gICAgY2xvdWRfY292ZXI6IHtcbiAgICBhZnRlcm5vb246IG51bWJlcjtcbiAgICB9O1xuICAgIGh1bWlkaXR5OiB7XG4gICAgYWZ0ZXJub29uOiBudW1iZXI7XG4gICAgfTtcbiAgICBwcmVjaXBpdGF0aW9uOiB7XG4gICAgdG90YWw6IG51bWJlcjtcbiAgICB9O1xuICAgIHRlbXBlcmF0dXJlOiB7XG4gICAgbWluOiBudW1iZXI7XG4gICAgbWF4OiBudW1iZXI7XG4gICAgYWZ0ZXJub29uOiBudW1iZXI7XG4gICAgbmlnaHQ6IG51bWJlcjtcbiAgICBldmVuaW5nOiBudW1iZXI7XG4gICAgbW9ybmluZzogbnVtYmVyO1xuICAgIH07XG4gICAgcHJlc3N1cmU6IHtcbiAgICBhZnRlcm5vb246IG51bWJlcjtcbiAgICB9O1xuICAgIHdpbmQ6IHtcbiAgICBtYXg6IHtcbiAgICAgICAgc3BlZWQ6IG51bWJlcjtcbiAgICAgICAgZGlyZWN0aW9uOiBudW1iZXI7XG4gICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBXZWF0aGVyUmVzcG9uc2Uge1xuICAgIGRhdGE6IE9wZW5XZWF0aGVyRGF5UmVzcG9uc2U7XG4gICAgeWVhcjogbnVtYmVyOyAgLy8gQWRkIHRoaXMgZmllbGRcbiAgICBlcnJvcj86IHN0cmluZztcbn1cblxuLy8gQ3VycmVuY3kgcmVsYXRlZCB0eXBlc1xuZXhwb3J0IGludGVyZmFjZSBDdXJyZW5jeVJhdGUge1xuICAgIGNvZGU6IHN0cmluZztcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgcmF0ZTogbnVtYmVyO1xuICAgIHN5bWJvbD86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDdXJyZW5jeUNvbnZlcnRlclByb3BzIHtcbiAgICBiYXNlQ3VycmVuY3k/OiBzdHJpbmc7XG4gICAgYmFzZUFtb3VudD86IG51bWJlcjtcbiAgICBvbkFtb3VudENoYW5nZT86IChhbW91bnQ6IG51bWJlcikgPT4gdm9pZDtcbiAgICBkZWZhdWx0Q3VycmVuY2llcz86IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEN1cnJlbmN5SW5mbyB7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHN5bWJvbDogc3RyaW5nO1xuICAgIHBvc2l0aW9uOiAnYmVmb3JlJyB8ICdhZnRlcic7XG59XG5cbmV4cG9ydCBjb25zdCBDVVJSRU5DWV9JTkZPOiB7IFtrZXk6IHN0cmluZ106IEN1cnJlbmN5SW5mbyB9ID0ge1xuICAgICdVU0QnOiB7IG5hbWU6ICdVUyBEb2xsYXInLCBzeW1ib2w6ICckJywgcG9zaXRpb246ICdiZWZvcmUnIH0sXG4gICAgJ0VVUic6IHsgbmFtZTogJ0V1cm8nLCBzeW1ib2w6ICfigqwnLCBwb3NpdGlvbjogJ2JlZm9yZScgfSxcbiAgICAnR0JQJzogeyBuYW1lOiAnQnJpdGlzaCBQb3VuZCcsIHN5bWJvbDogJ8KjJywgcG9zaXRpb246ICdiZWZvcmUnIH0sXG4gICAgJ0NOWSc6IHsgbmFtZTogJ0NoaW5lc2UgWXVhbicsIHN5bWJvbDogJ8KlJywgcG9zaXRpb246ICdiZWZvcmUnIH0sXG4gICAgJ0pQWSc6IHsgbmFtZTogJ0phcGFuZXNlIFllbicsIHN5bWJvbDogJ8KlJywgcG9zaXRpb246ICdiZWZvcmUnIH0sXG4gICAgJ1NHRCc6IHsgbmFtZTogJ1NpbmdhcG9yZSBEb2xsYXInLCBzeW1ib2w6ICdTJCcsIHBvc2l0aW9uOiAnYmVmb3JlJyB9LFxuICAgICdNWVInOiB7IG5hbWU6ICdNYWxheXNpYW4gUmluZ2dpdCcsIHN5bWJvbDogJ1JNJywgcG9zaXRpb246ICdiZWZvcmUnIH0sXG4gICAgJ0tSVyc6IHsgbmFtZTogJ1NvdXRoIEtvcmVhbiBXb24nLCBzeW1ib2w6ICfigqknLCBwb3NpdGlvbjogJ2JlZm9yZScgfSxcbiAgICAnQVVEJzogeyBuYW1lOiAnQXVzdHJhbGlhbiBEb2xsYXInLCBzeW1ib2w6ICdBJCcsIHBvc2l0aW9uOiAnYmVmb3JlJyB9LFxuICAgICdDQUQnOiB7IG5hbWU6ICdDYW5hZGlhbiBEb2xsYXInLCBzeW1ib2w6ICdDJCcsIHBvc2l0aW9uOiAnYmVmb3JlJyB9XG59O1xuXG5leHBvcnQgaW50ZXJmYWNlIEN1cnJlbmN5Q2FjaGUge1xuICAgIHRpbWVzdGFtcDogbnVtYmVyO1xuICAgIHJhdGVzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xuICAgIGJhc2VDdXJyZW5jeTogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEN1cnJlbmN5QXBpUmVzcG9uc2Uge1xuICAgIGRhdGE6IHsgW2tleTogc3RyaW5nXTogbnVtYmVyIH07XG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX0NVUlJFTkNJRVMgPSBbJ1VTRCcsICdFVVInLCAnR0JQJywgJ0NOWScsICdKUFknXTtcbiJdLCJuYW1lcyI6WyJDb21wb25lbnRUeXBlIiwiQnVkZ2V0TGV2ZWwiLCJUcmF2ZWxQcmVmZXJlbmNlIiwiU3VwcG9ydGVkTGFuZ3VhZ2UiLCJCVURHRVRfREVTQ1JJUFRJT05TIiwiUFJFRkVSRU5DRV9JQ09OUyIsIkxBTkdVQUdFX0xBQkVMUyIsIkJVREdFVF9PUFRJT05TIiwidmFsdWUiLCJsYWJlbCIsImRlc2NyaXB0aW9uIiwiTEFOR1VBR0VfT1BUSU9OUyIsIk9iamVjdCIsImVudHJpZXMiLCJtYXAiLCJrZXkiLCJQUkVGRVJFTkNFX09QVElPTlMiLCJpY29uIiwiQ1VSUkVOQ1lfSU5GTyIsIm5hbWUiLCJzeW1ib2wiLCJwb3NpdGlvbiIsIkRFRkFVTFRfQ1VSUkVOQ0lFUyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./managers/types.ts\n");

/***/ }),

/***/ "./utils/local-metrics.ts":
/*!********************************!*\
  !*** ./utils/local-metrics.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   METRICS_STORAGE_KEY: () => (/* binding */ METRICS_STORAGE_KEY),\n/* harmony export */   checkInputLimits: () => (/* binding */ checkInputLimits),\n/* harmony export */   checkSession: () => (/* binding */ checkSession),\n/* harmony export */   clearPaymentReference: () => (/* binding */ clearPaymentReference),\n/* harmony export */   getPaymentReference: () => (/* binding */ getPaymentReference),\n/* harmony export */   getPaymentReferenceId: () => (/* binding */ getPaymentReferenceId),\n/* harmony export */   getPaymentStatus: () => (/* binding */ getPaymentStatus),\n/* harmony export */   getStoredMetrics: () => (/* binding */ getStoredMetrics),\n/* harmony export */   resetMetrics: () => (/* binding */ resetMetrics),\n/* harmony export */   setPaymentReference: () => (/* binding */ setPaymentReference),\n/* harmony export */   setPaymentReferenceId: () => (/* binding */ setPaymentReferenceId),\n/* harmony export */   setPaymentStatus: () => (/* binding */ setPaymentStatus),\n/* harmony export */   updateStoredMetrics: () => (/* binding */ updateStoredMetrics)\n/* harmony export */ });\n/* harmony import */ var _managers_stage_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../managers/stage-manager */ \"./managers/stage-manager.ts\");\n/* harmony import */ var _session_manager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./session-manager */ \"./utils/session-manager.ts\");\n\n\nconst METRICS_STORAGE_KEY = \"travel_interaction_metrics\";\nconst SESSION_KEY = \"travel_session_id\";\nconst PAYMENT_REF_KEY = \"payment_reference_id\";\nconst MAX_TOTAL_INPUTS = 15;\nfunction getStoredMetrics() {\n    try {\n        // Check session validity first\n        if (!(0,_session_manager__WEBPACK_IMPORTED_MODULE_1__.checkSessionValidity)()) {\n            return resetMetrics();\n        }\n        const storedMetrics = localStorage.getItem(METRICS_STORAGE_KEY);\n        if (!storedMetrics) {\n            return resetMetrics();\n        }\n        const metrics = JSON.parse(storedMetrics);\n        // Ensure all fields exist\n        metrics.totalPrompts = metrics.totalPrompts || 0;\n        metrics.savedPlacesCount = metrics.savedPlacesCount || 0;\n        metrics.isPaid = metrics.isPaid || false;\n        metrics.stagePrompts = metrics.stagePrompts || {\n            1: 0,\n            2: 0,\n            3: 0\n        };\n        metrics.paymentReference = metrics.paymentReference || \"\";\n        return metrics;\n    } catch (error) {\n        console.error(\"[Metrics] Error retrieving metrics:\", error);\n        return resetMetrics();\n    }\n}\nfunction updateStoredMetrics(currentStage, incrementPrompt = true) {\n    try {\n        const metrics = getStoredMetrics();\n        if (incrementPrompt) {\n            // Only increment if explicitly requested and not already at limit\n            const { withinStageLimit } = checkInputLimits(currentStage);\n            if (withinStageLimit) {\n                metrics.totalPrompts += 1;\n                if (!metrics.stagePrompts) {\n                    metrics.stagePrompts = {};\n                }\n                metrics.stagePrompts[currentStage] = (metrics.stagePrompts[currentStage] || 0) + 1;\n            }\n        }\n        // Save to storage\n        localStorage.setItem(METRICS_STORAGE_KEY, JSON.stringify(metrics));\n        return metrics;\n    } catch (error) {\n        console.error(\"[Metrics] Error updating metrics:\", error);\n        return getStoredMetrics();\n    }\n}\nfunction checkInputLimits(currentStage) {\n    const metrics = getStoredMetrics();\n    const stagePrompts = metrics.stagePrompts?.[currentStage] || 0;\n    const totalPrompts = metrics.totalPrompts || 0;\n    // Only apply stage limits to stage 3, all other stages should be unlimited\n    const result = {\n        withinStageLimit: currentStage === 3 ? stagePrompts < _managers_stage_manager__WEBPACK_IMPORTED_MODULE_0__.STAGE_LIMITS[3].maxPrompts : true,\n        withinTotalLimit: currentStage === 3 ? totalPrompts < MAX_TOTAL_INPUTS : true,\n        stageInputCount: stagePrompts,\n        totalInputCount: totalPrompts\n    };\n    // console.log(`[Metrics] Input limit check for stage ${currentStage}:`, result);\n    return result;\n}\nfunction resetMetrics() {\n    const metrics = {\n        totalPrompts: 0,\n        savedPlacesCount: 0,\n        isPaid: false,\n        stagePrompts: {\n            1: 0,\n            2: 0,\n            3: 0\n        },\n        paymentReference: `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`\n    };\n    localStorage.setItem(METRICS_STORAGE_KEY, JSON.stringify(metrics));\n    (0,_session_manager__WEBPACK_IMPORTED_MODULE_1__.initializeSession)(); // Initialize a new session when metrics are reset\n    return metrics;\n}\nfunction checkSession() {\n    const currentSession = localStorage.getItem(SESSION_KEY);\n    if (!currentSession) {\n        const newSession = Date.now().toString();\n        localStorage.setItem(SESSION_KEY, newSession);\n        resetMetrics();\n        return false;\n    }\n    return true;\n}\nfunction setPaymentStatus(isPaid) {\n    try {\n        const metrics = getStoredMetrics();\n        metrics.isPaid = isPaid;\n        localStorage.setItem(METRICS_STORAGE_KEY, JSON.stringify(metrics));\n        return metrics;\n    } catch (error) {\n        console.error(\"[Metrics] Error updating payment status:\", error);\n        return getStoredMetrics();\n    }\n}\nfunction getPaymentStatus() {\n    const metrics = getStoredMetrics();\n    return metrics.isPaid || false;\n}\nfunction setPaymentReferenceId(referenceId) {\n    try {\n        localStorage.setItem(PAYMENT_REF_KEY, referenceId);\n        console.log(\"[Metrics] Stored payment reference ID:\", referenceId);\n    } catch (error) {\n        console.error(\"[Metrics] Error storing payment reference ID:\", error);\n    }\n}\nfunction getPaymentReferenceId() {\n    try {\n        return localStorage.getItem(PAYMENT_REF_KEY);\n    } catch (error) {\n        console.error(\"[Metrics] Error retrieving payment reference ID:\", error);\n        return null;\n    }\n}\nfunction setPaymentReference(reference) {\n    try {\n        const metrics = getStoredMetrics();\n        metrics.paymentReference = reference;\n        localStorage.setItem(METRICS_STORAGE_KEY, JSON.stringify(metrics));\n        console.log(\"[Metrics] Payment reference set:\", reference);\n    } catch (error) {\n        console.error(\"[Metrics] Error setting payment reference:\", error);\n    }\n}\nfunction getPaymentReference() {\n    try {\n        const metrics = getStoredMetrics();\n        return metrics.paymentReference;\n    } catch (error) {\n        console.error(\"[Metrics] Error getting payment reference:\", error);\n        return undefined;\n    }\n}\nfunction clearPaymentReference() {\n    try {\n        const metrics = getStoredMetrics();\n        delete metrics.paymentReference;\n        localStorage.setItem(METRICS_STORAGE_KEY, JSON.stringify(metrics));\n        console.log(\"[Metrics] Payment reference cleared\");\n    } catch (error) {\n        console.error(\"[Metrics] Error clearing payment reference:\", error);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGFBQWFpQixPQUFPLENBQUN4QixxQkFBcUJVLEtBQUtlLFNBQVMsQ0FBQ2hCO1FBQ3pEUyxRQUFRMEIsR0FBRyxDQUFDLG9DQUFvQ0c7SUFDbEQsRUFBRSxPQUFPOUIsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsOENBQThDQTtJQUM5RDtBQUNGO0FBRU8sU0FBUytCO0lBQ2QsSUFBSTtRQUNGLE1BQU12QyxVQUFVTDtRQUNoQixPQUFPSyxRQUFRTyxnQkFBZ0I7SUFDakMsRUFBRSxPQUFPQyxPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyw4Q0FBOENBO1FBQzVELE9BQU9nQztJQUNUO0FBQ0Y7QUFFTyxTQUFTQztJQUNkLElBQUk7UUFDRixNQUFNekMsVUFBVUw7UUFDaEIsT0FBT0ssUUFBUU8sZ0JBQWdCO1FBQy9CVCxhQUFhaUIsT0FBTyxDQUFDeEIscUJBQXFCVSxLQUFLZSxTQUFTLENBQUNoQjtRQUN6RFMsUUFBUTBCLEdBQUcsQ0FBQztJQUNkLEVBQUUsT0FBTzNCLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLCtDQUErQ0E7SUFDL0Q7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3RyYXZlbC1yaXp6Ly4vdXRpbHMvbG9jYWwtbWV0cmljcy50cz9mNDQxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFVzZXJJbnRlcmFjdGlvbk1ldHJpY3MsIFNUQUdFX0xJTUlUUyB9IGZyb20gJy4uL21hbmFnZXJzL3N0YWdlLW1hbmFnZXInO1xuaW1wb3J0IHsgY2hlY2tTZXNzaW9uVmFsaWRpdHksIGluaXRpYWxpemVTZXNzaW9uLCBjbGVhclNlc3Npb24gfSBmcm9tICcuL3Nlc3Npb24tbWFuYWdlcic7XG5cbmV4cG9ydCBjb25zdCBNRVRSSUNTX1NUT1JBR0VfS0VZID0gJ3RyYXZlbF9pbnRlcmFjdGlvbl9tZXRyaWNzJztcbmNvbnN0IFNFU1NJT05fS0VZID0gJ3RyYXZlbF9zZXNzaW9uX2lkJztcbmNvbnN0IFBBWU1FTlRfUkVGX0tFWSA9ICdwYXltZW50X3JlZmVyZW5jZV9pZCc7XG5jb25zdCBNQVhfVE9UQUxfSU5QVVRTID0gMTU7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRTdG9yZWRNZXRyaWNzKCk6IFVzZXJJbnRlcmFjdGlvbk1ldHJpY3Mge1xuICB0cnkge1xuICAgIC8vIENoZWNrIHNlc3Npb24gdmFsaWRpdHkgZmlyc3RcbiAgICBpZiAoIWNoZWNrU2Vzc2lvblZhbGlkaXR5KCkpIHtcbiAgICAgIHJldHVybiByZXNldE1ldHJpY3MoKTtcbiAgICB9XG5cbiAgICBjb25zdCBzdG9yZWRNZXRyaWNzID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oTUVUUklDU19TVE9SQUdFX0tFWSk7XG4gICAgaWYgKCFzdG9yZWRNZXRyaWNzKSB7XG4gICAgICByZXR1cm4gcmVzZXRNZXRyaWNzKCk7XG4gICAgfVxuXG4gICAgY29uc3QgbWV0cmljcyA9IEpTT04ucGFyc2Uoc3RvcmVkTWV0cmljcyk7XG4gICAgXG4gICAgLy8gRW5zdXJlIGFsbCBmaWVsZHMgZXhpc3RcbiAgICBtZXRyaWNzLnRvdGFsUHJvbXB0cyA9IG1ldHJpY3MudG90YWxQcm9tcHRzIHx8IDA7XG4gICAgbWV0cmljcy5zYXZlZFBsYWNlc0NvdW50ID0gbWV0cmljcy5zYXZlZFBsYWNlc0NvdW50IHx8IDA7XG4gICAgbWV0cmljcy5pc1BhaWQgPSBtZXRyaWNzLmlzUGFpZCB8fCBmYWxzZTtcbiAgICBtZXRyaWNzLnN0YWdlUHJvbXB0cyA9IG1ldHJpY3Muc3RhZ2VQcm9tcHRzIHx8IHsgMTogMCwgMjogMCwgMzogMCB9O1xuICAgIG1ldHJpY3MucGF5bWVudFJlZmVyZW5jZSA9IG1ldHJpY3MucGF5bWVudFJlZmVyZW5jZSB8fCAnJztcblxuICAgIHJldHVybiBtZXRyaWNzO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tNZXRyaWNzXSBFcnJvciByZXRyaWV2aW5nIG1ldHJpY3M6JywgZXJyb3IpO1xuICAgIHJldHVybiByZXNldE1ldHJpY3MoKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlU3RvcmVkTWV0cmljcyhcbiAgY3VycmVudFN0YWdlOiBudW1iZXIsIFxuICBpbmNyZW1lbnRQcm9tcHQ6IGJvb2xlYW4gPSB0cnVlXG4pOiBVc2VySW50ZXJhY3Rpb25NZXRyaWNzIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBtZXRyaWNzID0gZ2V0U3RvcmVkTWV0cmljcygpO1xuICAgIFxuICAgIGlmIChpbmNyZW1lbnRQcm9tcHQpIHtcbiAgICAgIC8vIE9ubHkgaW5jcmVtZW50IGlmIGV4cGxpY2l0bHkgcmVxdWVzdGVkIGFuZCBub3QgYWxyZWFkeSBhdCBsaW1pdFxuICAgICAgY29uc3QgeyB3aXRoaW5TdGFnZUxpbWl0IH0gPSBjaGVja0lucHV0TGltaXRzKGN1cnJlbnRTdGFnZSk7XG4gICAgICBpZiAod2l0aGluU3RhZ2VMaW1pdCkge1xuICAgICAgICBtZXRyaWNzLnRvdGFsUHJvbXB0cyArPSAxO1xuICAgICAgICBpZiAoIW1ldHJpY3Muc3RhZ2VQcm9tcHRzKSB7XG4gICAgICAgICAgbWV0cmljcy5zdGFnZVByb21wdHMgPSB7fTtcbiAgICAgICAgfVxuICAgICAgICBtZXRyaWNzLnN0YWdlUHJvbXB0c1tjdXJyZW50U3RhZ2VdID0gKG1ldHJpY3Muc3RhZ2VQcm9tcHRzW2N1cnJlbnRTdGFnZV0gfHwgMCkgKyAxO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBTYXZlIHRvIHN0b3JhZ2VcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShNRVRSSUNTX1NUT1JBR0VfS0VZLCBKU09OLnN0cmluZ2lmeShtZXRyaWNzKSk7XG4gICAgXG4gICAgcmV0dXJuIG1ldHJpY3M7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW01ldHJpY3NdIEVycm9yIHVwZGF0aW5nIG1ldHJpY3M6JywgZXJyb3IpO1xuICAgIHJldHVybiBnZXRTdG9yZWRNZXRyaWNzKCk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrSW5wdXRMaW1pdHMoXG4gIGN1cnJlbnRTdGFnZTogbnVtYmVyXG4pOiB7IFxuICB3aXRoaW5TdGFnZUxpbWl0OiBib29sZWFuLCBcbiAgd2l0aGluVG90YWxMaW1pdDogYm9vbGVhbixcbiAgc3RhZ2VJbnB1dENvdW50OiBudW1iZXIsXG4gIHRvdGFsSW5wdXRDb3VudDogbnVtYmVyXG59IHtcbiAgY29uc3QgbWV0cmljcyA9IGdldFN0b3JlZE1ldHJpY3MoKTtcbiAgXG4gIGNvbnN0IHN0YWdlUHJvbXB0cyA9IG1ldHJpY3Muc3RhZ2VQcm9tcHRzPy5bY3VycmVudFN0YWdlXSB8fCAwO1xuICBjb25zdCB0b3RhbFByb21wdHMgPSBtZXRyaWNzLnRvdGFsUHJvbXB0cyB8fCAwO1xuXG4gICAvLyBPbmx5IGFwcGx5IHN0YWdlIGxpbWl0cyB0byBzdGFnZSAzLCBhbGwgb3RoZXIgc3RhZ2VzIHNob3VsZCBiZSB1bmxpbWl0ZWRcbiAgY29uc3QgcmVzdWx0ID0ge1xuICAgIHdpdGhpblN0YWdlTGltaXQ6IGN1cnJlbnRTdGFnZSA9PT0gMyA/IFxuICAgICAgc3RhZ2VQcm9tcHRzIDwgU1RBR0VfTElNSVRTWzNdLm1heFByb21wdHMgOiBcbiAgICAgIHRydWUsICAvLyBBbHdheXMgdHJ1ZSBmb3Igbm9uLXN0YWdlIDNcbiAgICB3aXRoaW5Ub3RhbExpbWl0OiBjdXJyZW50U3RhZ2UgPT09IDMgPyBcbiAgICAgIHRvdGFsUHJvbXB0cyA8IE1BWF9UT1RBTF9JTlBVVFMgOlxuICAgICAgdHJ1ZSwgIC8vIEFsd2F5cyB0cnVlIGZvciBub24tc3RhZ2UgM1xuICAgIHN0YWdlSW5wdXRDb3VudDogc3RhZ2VQcm9tcHRzLFxuICAgIHRvdGFsSW5wdXRDb3VudDogdG90YWxQcm9tcHRzXG4gIH07XG5cbiAgLy8gY29uc29sZS5sb2coYFtNZXRyaWNzXSBJbnB1dCBsaW1pdCBjaGVjayBmb3Igc3RhZ2UgJHtjdXJyZW50U3RhZ2V9OmAsIHJlc3VsdCk7XG4gIFxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRNZXRyaWNzKCk6IFVzZXJJbnRlcmFjdGlvbk1ldHJpY3Mge1xuICBjb25zdCBtZXRyaWNzOiBVc2VySW50ZXJhY3Rpb25NZXRyaWNzID0ge1xuICAgIHRvdGFsUHJvbXB0czogMCxcbiAgICBzYXZlZFBsYWNlc0NvdW50OiAwLFxuICAgIGlzUGFpZDogZmFsc2UsXG4gICAgc3RhZ2VQcm9tcHRzOiB7IDE6IDAsIDI6IDAsIDM6IDAgfSxcbiAgICBwYXltZW50UmVmZXJlbmNlOiBgc2Vzc2lvbl8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWBcbiAgfTtcbiAgXG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKE1FVFJJQ1NfU1RPUkFHRV9LRVksIEpTT04uc3RyaW5naWZ5KG1ldHJpY3MpKTtcbiAgaW5pdGlhbGl6ZVNlc3Npb24oKTsgLy8gSW5pdGlhbGl6ZSBhIG5ldyBzZXNzaW9uIHdoZW4gbWV0cmljcyBhcmUgcmVzZXRcbiAgcmV0dXJuIG1ldHJpY3M7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjaGVja1Nlc3Npb24oKTogYm9vbGVhbiB7XG4gIGNvbnN0IGN1cnJlbnRTZXNzaW9uID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oU0VTU0lPTl9LRVkpO1xuICBcbiAgaWYgKCFjdXJyZW50U2Vzc2lvbikge1xuICAgIGNvbnN0IG5ld1Nlc3Npb24gPSBEYXRlLm5vdygpLnRvU3RyaW5nKCk7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oU0VTU0lPTl9LRVksIG5ld1Nlc3Npb24pO1xuICAgIHJlc2V0TWV0cmljcygpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldFBheW1lbnRTdGF0dXMoaXNQYWlkOiBib29sZWFuKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgbWV0cmljcyA9IGdldFN0b3JlZE1ldHJpY3MoKTtcbiAgICBtZXRyaWNzLmlzUGFpZCA9IGlzUGFpZDtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShNRVRSSUNTX1NUT1JBR0VfS0VZLCBKU09OLnN0cmluZ2lmeShtZXRyaWNzKSk7XG4gICAgcmV0dXJuIG1ldHJpY3M7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW01ldHJpY3NdIEVycm9yIHVwZGF0aW5nIHBheW1lbnQgc3RhdHVzOicsIGVycm9yKTtcbiAgICByZXR1cm4gZ2V0U3RvcmVkTWV0cmljcygpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQYXltZW50U3RhdHVzKCk6IGJvb2xlYW4ge1xuICBjb25zdCBtZXRyaWNzID0gZ2V0U3RvcmVkTWV0cmljcygpO1xuICByZXR1cm4gbWV0cmljcy5pc1BhaWQgfHwgZmFsc2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRQYXltZW50UmVmZXJlbmNlSWQocmVmZXJlbmNlSWQ6IHN0cmluZykge1xuICB0cnkge1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFBBWU1FTlRfUkVGX0tFWSwgcmVmZXJlbmNlSWQpO1xuICAgIGNvbnNvbGUubG9nKCdbTWV0cmljc10gU3RvcmVkIHBheW1lbnQgcmVmZXJlbmNlIElEOicsIHJlZmVyZW5jZUlkKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbTWV0cmljc10gRXJyb3Igc3RvcmluZyBwYXltZW50IHJlZmVyZW5jZSBJRDonLCBlcnJvcik7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFBheW1lbnRSZWZlcmVuY2VJZCgpOiBzdHJpbmcgfCBudWxsIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oUEFZTUVOVF9SRUZfS0VZKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbTWV0cmljc10gRXJyb3IgcmV0cmlldmluZyBwYXltZW50IHJlZmVyZW5jZSBJRDonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldFBheW1lbnRSZWZlcmVuY2UocmVmZXJlbmNlOiBzdHJpbmcpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBtZXRyaWNzID0gZ2V0U3RvcmVkTWV0cmljcygpO1xuICAgIG1ldHJpY3MucGF5bWVudFJlZmVyZW5jZSA9IHJlZmVyZW5jZTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShNRVRSSUNTX1NUT1JBR0VfS0VZLCBKU09OLnN0cmluZ2lmeShtZXRyaWNzKSk7XG4gICAgY29uc29sZS5sb2coJ1tNZXRyaWNzXSBQYXltZW50IHJlZmVyZW5jZSBzZXQ6JywgcmVmZXJlbmNlKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbTWV0cmljc10gRXJyb3Igc2V0dGluZyBwYXltZW50IHJlZmVyZW5jZTonLCBlcnJvcik7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFBheW1lbnRSZWZlcmVuY2UoKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBtZXRyaWNzID0gZ2V0U3RvcmVkTWV0cmljcygpO1xuICAgIHJldHVybiBtZXRyaWNzLnBheW1lbnRSZWZlcmVuY2U7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW01ldHJpY3NdIEVycm9yIGdldHRpbmcgcGF5bWVudCByZWZlcmVuY2U6JywgZXJyb3IpO1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyUGF5bWVudFJlZmVyZW5jZSgpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBtZXRyaWNzID0gZ2V0U3RvcmVkTWV0cmljcygpO1xuICAgIGRlbGV0ZSBtZXRyaWNzLnBheW1lbnRSZWZlcmVuY2U7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oTUVUUklDU19TVE9SQUdFX0tFWSwgSlNPTi5zdHJpbmdpZnkobWV0cmljcykpO1xuICAgIGNvbnNvbGUubG9nKCdbTWV0cmljc10gUGF5bWVudCByZWZlcmVuY2UgY2xlYXJlZCcpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tNZXRyaWNzXSBFcnJvciBjbGVhcmluZyBwYXltZW50IHJlZmVyZW5jZTonLCBlcnJvcik7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJTVEFHRV9MSU1JVFMiLCJjaGVja1Nlc3Npb25WYWxpZGl0eSIsImluaXRpYWxpemVTZXNzaW9uIiwiTUVUUklDU19TVE9SQUdFX0tFWSIsIlNFU1NJT05fS0VZIiwiUEFZTUVOVF9SRUZfS0VZIiwiTUFYX1RPVEFMX0lOUFVUUyIsImdldFN0b3JlZE1ldHJpY3MiLCJyZXNldE1ldHJpY3MiLCJzdG9yZWRNZXRyaWNzIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsIm1ldHJpY3MiLCJKU09OIiwicGFyc2UiLCJ0b3RhbFByb21wdHMiLCJzYXZlZFBsYWNlc0NvdW50IiwiaXNQYWlkIiwic3RhZ2VQcm9tcHRzIiwicGF5bWVudFJlZmVyZW5jZSIsImVycm9yIiwiY29uc29sZSIsInVwZGF0ZVN0b3JlZE1ldHJpY3MiLCJjdXJyZW50U3RhZ2UiLCJpbmNyZW1lbnRQcm9tcHQiLCJ3aXRoaW5TdGFnZUxpbWl0IiwiY2hlY2tJbnB1dExpbWl0cyIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJyZXN1bHQiLCJtYXhQcm9tcHRzIiwid2l0aGluVG90YWxMaW1pdCIsInN0YWdlSW5wdXRDb3VudCIsInRvdGFsSW5wdXRDb3VudCIsIkRhdGUiLCJub3ciLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHIiLCJjaGVja1Nlc3Npb24iLCJjdXJyZW50U2Vzc2lvbiIsIm5ld1Nlc3Npb24iLCJzZXRQYXltZW50U3RhdHVzIiwiZ2V0UGF5bWVudFN0YXR1cyIsInNldFBheW1lbnRSZWZlcmVuY2VJZCIsInJlZmVyZW5jZUlkIiwibG9nIiwiZ2V0UGF5bWVudFJlZmVyZW5jZUlkIiwic2V0UGF5bWVudFJlZmVyZW5jZSIsInJlZmVyZW5jZSIsImdldFBheW1lbnRSZWZlcmVuY2UiLCJ1bmRlZmluZWQiLCJjbGVhclBheW1lbnRSZWZlcmVuY2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./utils/local-metrics.ts\n");

/***/ }),

/***/ "./utils/places-utils.ts":
/*!*******************************!*\
  !*** ./utils/places-utils.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fetchPlaces: () => (/* binding */ fetchPlaces),\n/* harmony export */   filterUniquePlaces: () => (/* binding */ filterUniquePlaces),\n/* harmony export */   formatPrimaryType: () => (/* binding */ formatPrimaryType),\n/* harmony export */   getDisplayName: () => (/* binding */ getDisplayName),\n/* harmony export */   getPlaceTypesFromPreferences: () => (/* binding */ getPlaceTypesFromPreferences),\n/* harmony export */   metricsManager: () => (/* binding */ metricsManager),\n/* harmony export */   preferenceToPlaceTypes: () => (/* binding */ preferenceToPlaceTypes),\n/* harmony export */   savedPlacesManager: () => (/* binding */ savedPlacesManager),\n/* harmony export */   searchMultiplePlacesByText: () => (/* binding */ searchMultiplePlacesByText),\n/* harmony export */   searchPlaceByText: () => (/* binding */ searchPlaceByText)\n/* harmony export */ });\n/* harmony import */ var _managers_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../managers/types */ \"./managers/types.ts\");\n/* harmony import */ var _local_metrics__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./local-metrics */ \"./utils/local-metrics.ts\");\n// Place related interfaces\n\n\n// Updated preference to place types mapping based on travel-rizz.html\nconst preferenceToPlaceTypes = {\n    [_managers_types__WEBPACK_IMPORTED_MODULE_0__.TravelPreference.Culture]: [\n        \"museum\",\n        \"cultural_center\",\n        \"cultural_landmark\",\n        \"historical_landmark\",\n        \"monument\",\n        \"art_gallery\",\n        \"historical_place\"\n    ],\n    [_managers_types__WEBPACK_IMPORTED_MODULE_0__.TravelPreference.Nature]: [\n        \"national_park\",\n        \"state_park\",\n        \"botanical_garden\",\n        \"wildlife_park\",\n        \"garden\",\n        \"hiking_area\",\n        \"wildlife_refuge\"\n    ],\n    [_managers_types__WEBPACK_IMPORTED_MODULE_0__.TravelPreference.Food]: [\n        \"restaurant\",\n        \"fine_dining_restaurant\",\n        \"cafe\",\n        \"food_court\",\n        \"bakery\",\n        \"dessert_shop\",\n        \"bar_and_grill\"\n    ],\n    [_managers_types__WEBPACK_IMPORTED_MODULE_0__.TravelPreference.Relaxation]: [\n        \"spa\",\n        \"wellness_center\",\n        \"shopping_mall\",\n        \"beach\",\n        \"garden\",\n        \"plaza\",\n        \"yoga_studio\"\n    ],\n    [_managers_types__WEBPACK_IMPORTED_MODULE_0__.TravelPreference.Adventure]: [\n        \"adventure_sports_center\",\n        \"amusement_park\",\n        \"hiking_area\",\n        \"sports_complex\",\n        \"water_park\",\n        \"off_roading_area\",\n        \"sports_activity_location\"\n    ],\n    [_managers_types__WEBPACK_IMPORTED_MODULE_0__.TravelPreference.Shopping]: [\n        \"art_gallery\",\n        \"art_studio\",\n        \"performing_arts_theater\",\n        \"auditorium\",\n        \"concert_hall\",\n        \"museum\",\n        \"opera_house\"\n    ]\n};\n// Helper function to get place types based on preferences\nfunction getPlaceTypesFromPreferences(preferences) {\n    try {\n        // Track used types to avoid repeats\n        const usedTypes = new Set();\n        const resultTypes = [];\n        // Process each preference\n        preferences.forEach((pref)=>{\n            const availableTypes = preferenceToPlaceTypes[pref]?.filter((type)=>!usedTypes.has(type)) || [];\n            // Take 2-3 random types from each preference\n            const numTypes = Math.min(Math.floor(Math.random() * 2) + 2, availableTypes.length);\n            const selectedTypes = availableTypes.sort(()=>Math.random() - 0.5).slice(0, numTypes);\n            // Add to results and mark as used\n            selectedTypes.forEach((type)=>{\n                resultTypes.push(type);\n                usedTypes.add(type);\n            });\n        });\n        return resultTypes;\n    } catch (error) {\n        console.error(\"Error getting place types from preferences:\", error);\n        return [\n            \"tourist_attraction\"\n        ]; // Default fallback\n    }\n}\n// Helper function to format primary type\nconst formatPrimaryType = (type)=>{\n    return type.split(\"_\").map((word)=>word.charAt(0).toUpperCase() + word.slice(1)).join(\" \");\n};\n// Helper function to get display name for place type\nconst getDisplayName = (place)=>{\n    if (typeof place.displayName === \"string\") {\n        return place.displayName;\n    }\n    return place.displayName?.text || place.name || \"\";\n};\n// Function to filter out duplicate places\nfunction filterUniquePlaces(places) {\n    if (!places || !Array.isArray(places)) return [];\n    // Get saved places from global state if available\n    const savedPlaces = savedPlacesManager.getPlaces();\n    const savedPlaceIds = new Set(savedPlaces.map((place)=>place.id));\n    const savedPlaceNames = new Set(savedPlaces.map((place)=>typeof place.displayName === \"string\" ? place.displayName.toLowerCase() : place.displayName.text.toLowerCase()));\n    // Filter out places that:\n    // 1. Have same ID as saved place\n    // 2. Have same name as saved place\n    return places.filter((place)=>{\n        if (!place.id) return false;\n        if (savedPlaceIds.has(place.id)) return false;\n        const placeName = typeof place.displayName === \"string\" ? place.displayName.toLowerCase() : place.displayName.text.toLowerCase();\n        if (savedPlaceNames.has(placeName)) return false;\n        return true;\n    });\n}\nconst STORAGE_KEY = \"saved_places\";\n// SavedPlacesManager singleton\nconst createSavedPlacesManager = ()=>{\n    const places = new Map();\n    let initialized = false;\n    // Load places from localStorage\n    const loadFromStorage = ()=>{\n        if (!initialized && \"undefined\" !== \"undefined\") {}\n    };\n    return {\n        places,\n        addPlace (place) {\n            loadFromStorage(); // Ensure places are loaded\n            if (place?.id) {\n                places.set(place.id, place);\n                this._persist();\n                this._notifyChange();\n            }\n        },\n        removePlace (id) {\n            loadFromStorage(); // Ensure places are loaded\n            places.delete(id);\n            this._persist();\n            this._notifyChange();\n        },\n        getPlaces () {\n            loadFromStorage(); // Ensure places are loaded\n            return Array.from(places.values());\n        },\n        hasPlace (id) {\n            loadFromStorage(); // Ensure places are loaded\n            return places.has(id);\n        },\n        _persist () {\n            if (false) {}\n        },\n        _notifyChange () {\n            if (false) {}\n        },\n        serialize () {\n            return JSON.stringify(Array.from(places.values()));\n        }\n    };\n};\nconst savedPlacesManager = createSavedPlacesManager();\n// Initialize on client side\nif (false) {}\n// Helper function to handle different search strategies\nasync function searchWithStrategy(searchText, location, cityName, useAlternateSearch) {\n    if (false) {}\n    const headers = {\n        \"Content-Type\": \"application/json\",\n        \"X-Goog-Api-Key\": \"AIzaSyDvcgBgSprgTRQO_6BWh5EAOPu1vdS6KD4\",\n        \"X-Goog-FieldMask\": \"places.id,places.displayName,places.formattedAddress,places.location,places.primaryType,places.primaryTypeDisplayName,places.photos.name,places.photos.widthPx,places.photos.heightPx\"\n    };\n    // Choose query based on whether we're doing alternate search\n    const query = useAlternateSearch ? `different ${searchText} in ${cityName}` : `${searchText} ${cityName}`;\n    console.log(`[searchWithStrategy] Using ${useAlternateSearch ? \"alternate\" : \"original\"} search:`, query);\n    const result = await trySearch(query, headers, location);\n    return result;\n}\nasync function trySearch(query, headers, location) {\n    try {\n        const response = await fetch(\"https://places.googleapis.com/v1/places:searchText\", {\n            method: \"POST\",\n            headers,\n            body: JSON.stringify({\n                textQuery: query,\n                locationBias: {\n                    circle: {\n                        center: {\n                            latitude: location.latitude,\n                            longitude: location.longitude\n                        },\n                        radius: 20000.0\n                    }\n                },\n                maxResultCount: 1\n            })\n        });\n        if (!response.ok) {\n            console.error(\"[trySearch] Search failed:\", {\n                status: response.status,\n                statusText: response.statusText,\n                query\n            });\n            return null;\n        }\n        const data = await response.json();\n        if (!data.places?.[0]) {\n            console.log(\"[trySearch] No places found for query:\", query);\n            return null;\n        }\n        console.log(\"[trySearch] Found new place:\", {\n            id: data.places[0].id,\n            name: data.places[0].displayName?.text || data.places[0].name\n        });\n        return {\n            places: [\n                data.places[0]\n            ]\n        };\n    } catch (error) {\n        console.error(\"[trySearch] Error:\", error);\n        return null;\n    }\n}\nasync function searchPlaceByText(searchText, location, destination) {\n    console.log(\"[searchPlaceByText] Starting search with:\", {\n        searchText,\n        location,\n        destination\n    });\n    try {\n        const cityName = destination;\n        const result = await searchWithStrategy(searchText, location, cityName, false);\n        if (!result?.places?.[0]) {\n            return null;\n        }\n        const place = transformPlaceResponse(result.places[0]);\n        if (!place) {\n            return null;\n        }\n        // Check if place is already saved using savedPlacesManager\n        const isAlreadySaved = savedPlacesManager.hasPlace(place.id);\n        if (!isAlreadySaved) {\n            console.log(\"[searchPlaceByText] Adding new place:\", {\n                id: place.id,\n                name: getDisplayName(place)\n            });\n            savedPlacesManager.addPlace(place);\n            // Update metrics\n            const metrics = metricsManager.get();\n            metrics.savedPlacesCount = savedPlacesManager.places.size;\n            metricsManager.update(metrics);\n        }\n        console.log(\"[searchPlaceByText] Found place:\", {\n            id: place.id,\n            name: getDisplayName(place),\n            isAlreadySaved\n        });\n        return place;\n    } catch (error) {\n        console.error(\"[searchPlaceByText] Error searching for place:\", error);\n        return null;\n    }\n}\n// Initialize metrics in storage\nfunction initializeMetrics() {\n    if (true) {\n        return {\n            totalPrompts: 0,\n            savedPlacesCount: 0,\n            isPaid: false,\n            stagePrompts: {},\n            paymentReference: \"\" // Empty string instead of null to match type\n        };\n    }\n    const metrics = (0,_local_metrics__WEBPACK_IMPORTED_MODULE_1__.getStoredMetrics)();\n    // Always ensure savedPlacesCount matches actual saved places\n    metrics.savedPlacesCount = savedPlacesManager.places.size;\n    return metrics;\n}\n// Update metrics in storage\nfunction updateMetrics(metrics) {\n    if (true) return;\n    try {\n        localStorage.setItem(_local_metrics__WEBPACK_IMPORTED_MODULE_1__.METRICS_STORAGE_KEY, JSON.stringify(metrics));\n    } catch (error) {\n        console.error(\"[updateMetrics] Error:\", error);\n    }\n}\n// Export the metrics functions\nconst metricsManager = {\n    get: initializeMetrics,\n    update: updateMetrics\n};\n// Helper function to transform Google Places API response to our Place type\nfunction transformPlaceResponse(place) {\n    if (!place) return null;\n    console.log(\"[transformPlaceResponse] Input place:\", {\n        id: place.id,\n        photos: place.photos?.map((p)=>({\n                name: p.name\n            })),\n        primaryTypeDisplayName: place.primaryTypeDisplayName\n    });\n    const displayName = place.displayName?.text ? {\n        text: place.displayName.text,\n        languageCode: place.displayName.languageCode || \"en\"\n    } : place.name || \"\";\n    // Ensure photos array is properly formatted\n    const photos = (place.photos || []).filter((photo)=>Boolean(photo && photo.name)).map((photo)=>({\n            name: photo.name,\n            widthPx: photo.widthPx,\n            heightPx: photo.heightPx,\n            authorAttributions: photo.authorAttributions\n        }));\n    const transformed = {\n        id: place.id,\n        name: place.name,\n        displayName,\n        primaryType: place.primaryType || \"place\",\n        photos,\n        formattedAddress: place.formattedAddress,\n        location: place.location,\n        primaryTypeDisplayName: place.primaryTypeDisplayName ? {\n            text: place.primaryTypeDisplayName.text,\n            languageCode: place.primaryTypeDisplayName.languageCode || \"en\"\n        } : undefined\n    };\n    console.log(\"[transformPlaceResponse] Transformed place:\", {\n        id: transformed.id,\n        photos: transformed.photos.map((p)=>({\n                name: p.name\n            })),\n        primaryTypeDisplayName: transformed.primaryTypeDisplayName\n    });\n    return transformed;\n}\nconst searchMultiplePlacesByText = async (searchText, location, maxResults = 5)=>{\n    try {\n        if (false) {}\n        console.log(\"Executing searchMultiplePlacesByText with params:\", {\n            searchText,\n            location,\n            maxResults\n        });\n        const requestBody = {\n            textQuery: searchText,\n            locationBias: {\n                circle: {\n                    center: {\n                        latitude: location.latitude,\n                        longitude: location.longitude\n                    },\n                    radius: 20000.0 // 20km radius\n                }\n            },\n            maxResultCount: maxResults\n        };\n        const headers = {\n            \"Content-Type\": \"application/json\",\n            \"X-Goog-Api-Key\": \"AIzaSyDvcgBgSprgTRQO_6BWh5EAOPu1vdS6KD4\",\n            \"X-Goog-FieldMask\": \"places.id,places.displayName,places.formattedAddress,places.location,places.primaryType,places.primaryTypeDisplayName,places.photos.name,places.photos.widthPx,places.photos.heightPx\"\n        };\n        const response = await fetch(\"https://places.googleapis.com/v1/places:searchText\", {\n            method: \"POST\",\n            headers,\n            body: JSON.stringify(requestBody)\n        });\n        if (!response.ok) {\n            const errorData = await response.text();\n            console.error(\"Failed to search places:\", {\n                status: response.status,\n                statusText: response.statusText,\n                error: errorData\n            });\n            return [];\n        }\n        const data = await response.json();\n        if (!data.places || !Array.isArray(data.places) || data.places.length === 0) {\n            console.log(\"No places found for text search:\", searchText);\n            return [];\n        }\n        return data.places.map((place)=>({\n                id: place.id,\n                displayName: place.displayName?.text ? {\n                    text: place.displayName.text,\n                    languageCode: place.displayName.languageCode || \"en\"\n                } : place.displayName,\n                primaryType: place.primaryType || \"place\",\n                photos: place.photos?.map((photo)=>({\n                        name: photo.name,\n                        widthPx: photo.widthPx,\n                        heightPx: photo.heightPx\n                    })) || [],\n                formattedAddress: place.formattedAddress,\n                location: place.location,\n                primaryTypeDisplayName: place.primaryTypeDisplayName ? {\n                    text: place.primaryTypeDisplayName.text,\n                    languageCode: place.primaryTypeDisplayName.languageCode || \"en\"\n                } : undefined\n            }));\n    } catch (error) {\n        console.error(\"Error searching for places:\", error);\n        return [];\n    }\n};\n// Fetch places from Google Places API\nconst fetchPlaces = async (latitude, longitude, preferences, maxResults = 5, placeTypes)=>{\n    try {\n        if (false) {}\n        const fromPreferences = !!preferences && preferences.length > 0;\n        const fromPlaceTypes = !!placeTypes && placeTypes.length > 0;\n        if (!fromPreferences && !fromPlaceTypes) {\n            console.error(\"No preferences or place types provided\");\n            return [];\n        }\n        // Use preferences if provided, otherwise use placeTypes, otherwise use defaults\n        let includedTypes = [];\n        if (fromPreferences) {\n            includedTypes = getPlaceTypesFromPreferences(preferences);\n        } else if (fromPlaceTypes) {\n            includedTypes = placeTypes;\n        }\n        console.log(\"Executing fetchplaces with params:\", {\n            latitude,\n            longitude,\n            includedTypes,\n            maxResults,\n            fromPreferences: !!preferences?.length,\n            fromPlaceTypes: !!placeTypes?.length\n        });\n        // First try nearby search\n        try {\n            const requestBody = {\n                includedTypes,\n                maxResultCount: maxResults,\n                locationRestriction: {\n                    circle: {\n                        center: {\n                            latitude: latitude,\n                            longitude: longitude\n                        },\n                        radius: 20000.0 // 20km radius\n                    }\n                }\n            };\n            const headers = {\n                \"Content-Type\": \"application/json\",\n                \"X-Goog-Api-Key\": \"AIzaSyDvcgBgSprgTRQO_6BWh5EAOPu1vdS6KD4\",\n                \"X-Goog-FieldMask\": \"places.id,places.displayName,places.formattedAddress,places.location,places.primaryType,places.primaryTypeDisplayName,places.photos.name,places.photos.widthPx,places.photos.heightPx\"\n            };\n            const response = await fetch(\"https://places.googleapis.com/v1/places:searchNearby\", {\n                method: \"POST\",\n                headers,\n                body: JSON.stringify(requestBody)\n            });\n            if (response.ok) {\n                const data = await response.json();\n                if (data.places && Array.isArray(data.places) && data.places.length > 0) {\n                    return data.places.map((place)=>({\n                            id: place.id,\n                            displayName: place.displayName?.text ? {\n                                text: place.displayName.text,\n                                languageCode: place.displayName.languageCode || \"en\"\n                            } : place.displayName,\n                            primaryType: place.primaryType || \"place\",\n                            photos: place.photos?.map((photo)=>({\n                                    name: photo.name,\n                                    widthPx: photo.widthPx,\n                                    heightPx: photo.heightPx\n                                })) || [],\n                            formattedAddress: place.formattedAddress,\n                            location: place.location,\n                            primaryTypeDisplayName: place.primaryTypeDisplayName ? {\n                                text: place.primaryTypeDisplayName.text,\n                                languageCode: place.primaryTypeDisplayName.languageCode || \"en\"\n                            } : undefined\n                        }));\n                }\n            }\n            const errorData = await response.text();\n            console.error(\"Failed to fetch places:\", {\n                status: response.status,\n                statusText: response.statusText,\n                error: errorData\n            });\n        } catch (error) {\n            console.error(\"Error in nearby search:\", error);\n        }\n        // If nearby search fails, try text search as fallback\n        console.log(\"Falling back to text search...\");\n        const searchQuery = fromPlaceTypes ? placeTypes[0] : preferences[0];\n        return await searchMultiplePlacesByText(searchQuery, {\n            latitude,\n            longitude\n        }, maxResults);\n    } catch (error) {\n        console.error(\"Error fetching places:\", error);\n        return [];\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi91dGlscy9wbGFjZXMtdXRpbHMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsMkJBQTJCO0FBMkQwQjtBQUVtQjtBQUV4RSxzRUFBc0U7QUFDL0QsTUFBTUcseUJBQTZEO0lBQ3RFLENBQUNILDZEQUFnQkEsQ0FBQ0ksT0FBTyxDQUFDLEVBQUU7UUFDeEI7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7S0FDSDtJQUNELENBQUNKLDZEQUFnQkEsQ0FBQ0ssTUFBTSxDQUFDLEVBQUU7UUFDdkI7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7S0FDSDtJQUNELENBQUNMLDZEQUFnQkEsQ0FBQ00sSUFBSSxDQUFDLEVBQUU7UUFDckI7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7S0FDSDtJQUNELENBQUNOLDZEQUFnQkEsQ0FBQ08sVUFBVSxDQUFDLEVBQUU7UUFDM0I7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7S0FDSDtJQUNELENBQUNQLDZEQUFnQkEsQ0FBQ1EsU0FBUyxDQUFDLEVBQUU7UUFDMUI7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7S0FDSDtJQUNELENBQUNSLDZEQUFnQkEsQ0FBQ1MsUUFBUSxDQUFDLEVBQUU7UUFDekI7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7S0FDSDtBQUNMLEVBQUU7QUFFRiwwREFBMEQ7QUFDbkQsU0FBU0MsNkJBQTZCQyxXQUErQjtJQUN4RSxJQUFJO1FBQ0Esb0NBQW9DO1FBQ3BDLE1BQU1DLFlBQVksSUFBSUM7UUFDdEIsTUFBTUMsY0FBd0IsRUFBRTtRQUVoQywwQkFBMEI7UUFDMUJILFlBQVlJLE9BQU8sQ0FBQ0MsQ0FBQUE7WUFDaEIsTUFBTUMsaUJBQWlCZCxzQkFBc0IsQ0FBQ2EsS0FBSyxFQUFFRSxPQUNqREMsQ0FBQUEsT0FBUSxDQUFDUCxVQUFVUSxHQUFHLENBQUNELFVBQ3RCLEVBQUU7WUFFUCw2Q0FBNkM7WUFDN0MsTUFBTUUsV0FBV0MsS0FBS0MsR0FBRyxDQUFDRCxLQUFLRSxLQUFLLENBQUNGLEtBQUtHLE1BQU0sS0FBSyxLQUFLLEdBQUdSLGVBQWVTLE1BQU07WUFDbEYsTUFBTUMsZ0JBQWdCVixlQUNqQlcsSUFBSSxDQUFDLElBQU1OLEtBQUtHLE1BQU0sS0FBSyxLQUMzQkksS0FBSyxDQUFDLEdBQUdSO1lBRWQsa0NBQWtDO1lBQ2xDTSxjQUFjWixPQUFPLENBQUNJLENBQUFBO2dCQUNsQkwsWUFBWWdCLElBQUksQ0FBQ1g7Z0JBQ2pCUCxVQUFVbUIsR0FBRyxDQUFDWjtZQUNsQjtRQUNKO1FBRUEsT0FBT0w7SUFDWCxFQUFFLE9BQU9rQixPQUFPO1FBQ1pDLFFBQVFELEtBQUssQ0FBQywrQ0FBK0NBO1FBQzdELE9BQU87WUFBQztTQUFxQixFQUFFLG1CQUFtQjtJQUN0RDtBQUNKO0FBRUEseUNBQXlDO0FBQ2xDLE1BQU1FLG9CQUFvQixDQUFDZjtJQUM5QixPQUFPQSxLQUFLZ0IsS0FBSyxDQUFDLEtBQ2JDLEdBQUcsQ0FBQ0MsQ0FBQUEsT0FBUUEsS0FBS0MsTUFBTSxDQUFDLEdBQUdDLFdBQVcsS0FBS0YsS0FBS1IsS0FBSyxDQUFDLElBQ3REVyxJQUFJLENBQUM7QUFDZCxFQUFFO0FBRUYscURBQXFEO0FBQzlDLE1BQU1DLGlCQUFpQixDQUFDQztJQUMzQixJQUFJLE9BQU9BLE1BQU1DLFdBQVcsS0FBSyxVQUFVO1FBQ3ZDLE9BQU9ELE1BQU1DLFdBQVc7SUFDNUI7SUFDQSxPQUFPRCxNQUFNQyxXQUFXLEVBQUVDLFFBQVFGLE1BQU1HLElBQUksSUFBSTtBQUNwRCxFQUFFO0FBRUYsMENBQTBDO0FBQ25DLFNBQVNDLG1CQUFtQkMsTUFBZTtJQUM5QyxJQUFJLENBQUNBLFVBQVUsQ0FBQ0MsTUFBTUMsT0FBTyxDQUFDRixTQUFTLE9BQU8sRUFBRTtJQUVoRCxrREFBa0Q7SUFDbEQsTUFBTUcsY0FBY0MsbUJBQW1CQyxTQUFTO0lBRWhELE1BQU1DLGdCQUFnQixJQUFJeEMsSUFBSXFDLFlBQVlkLEdBQUcsQ0FBQ00sQ0FBQUEsUUFBU0EsTUFBTVksRUFBRTtJQUMvRCxNQUFNQyxrQkFBa0IsSUFBSTFDLElBQUlxQyxZQUFZZCxHQUFHLENBQUNNLENBQUFBLFFBQzVDLE9BQU9BLE1BQU1DLFdBQVcsS0FBSyxXQUN2QkQsTUFBTUMsV0FBVyxDQUFDYSxXQUFXLEtBQzdCZCxNQUFNQyxXQUFXLENBQUNDLElBQUksQ0FBQ1ksV0FBVztJQUczQywwQkFBMEI7SUFDM0IsaUNBQWlDO0lBQ2pDLG1DQUFtQztJQUNuQyxPQUFPVCxPQUFPN0IsTUFBTSxDQUFDd0IsQ0FBQUE7UUFDakIsSUFBSSxDQUFDQSxNQUFNWSxFQUFFLEVBQUUsT0FBTztRQUN0QixJQUFJRCxjQUFjakMsR0FBRyxDQUFDc0IsTUFBTVksRUFBRSxHQUFHLE9BQU87UUFFeEMsTUFBTUcsWUFBWSxPQUFPZixNQUFNQyxXQUFXLEtBQUssV0FDekNELE1BQU1DLFdBQVcsQ0FBQ2EsV0FBVyxLQUM3QmQsTUFBTUMsV0FBVyxDQUFDQyxJQUFJLENBQUNZLFdBQVc7UUFFeEMsSUFBSUQsZ0JBQWdCbkMsR0FBRyxDQUFDcUMsWUFBWSxPQUFPO1FBRTNDLE9BQU87SUFDWDtBQUNKO0FBY0EsTUFBTUMsY0FBYztBQUVwQiwrQkFBK0I7QUFDL0IsTUFBTUMsMkJBQTJCO0lBQzdCLE1BQU1aLFNBQVMsSUFBSWE7SUFDbkIsSUFBSUMsY0FBYztJQUVsQixnQ0FBZ0M7SUFDaEMsTUFBTUMsa0JBQWtCO1FBQ3BCLElBQUksQ0FBQ0QsZUFBZSxnQkFBa0IsYUFBYSxFQThCbEQ7SUFDTDtJQUVBLE9BQU87UUFDSGQ7UUFDQTZCLFVBQVNsQyxLQUFZO1lBQ2pCb0IsbUJBQW1CLDJCQUEyQjtZQUM5QyxJQUFJcEIsT0FBT1ksSUFBSTtnQkFDWFAsT0FBTzRCLEdBQUcsQ0FBQ2pDLE1BQU1ZLEVBQUUsRUFBRVo7Z0JBQ3JCLElBQUksQ0FBQ21DLFFBQVE7Z0JBQ2IsSUFBSSxDQUFDQyxhQUFhO1lBQ3RCO1FBQ0o7UUFDQUMsYUFBWXpCLEVBQVU7WUFDbEJRLG1CQUFtQiwyQkFBMkI7WUFDOUNmLE9BQU9pQyxNQUFNLENBQUMxQjtZQUNkLElBQUksQ0FBQ3VCLFFBQVE7WUFDYixJQUFJLENBQUNDLGFBQWE7UUFDdEI7UUFDQTFCO1lBQ0lVLG1CQUFtQiwyQkFBMkI7WUFDOUMsT0FBT2QsTUFBTWlDLElBQUksQ0FBQ2xDLE9BQU9tQyxNQUFNO1FBQ25DO1FBQ0FDLFVBQVM3QixFQUFVO1lBQ2ZRLG1CQUFtQiwyQkFBMkI7WUFDOUMsT0FBT2YsT0FBTzNCLEdBQUcsQ0FBQ2tDO1FBQ3RCO1FBQ0F1QjtZQUNJLElBQUksS0FBa0IsRUFBYSxFQVFsQztRQUNMO1FBQ0FDO1lBQ0ksSUFBSSxLQUFrQixFQUFhLEVBS2xDO1FBQ0w7UUFDQWlCO1lBQ0ksT0FBTzVCLEtBQUttQixTQUFTLENBQUN0QyxNQUFNaUMsSUFBSSxDQUFDbEMsT0FBT21DLE1BQU07UUFDbEQ7SUFDSjtBQUNKO0FBRU8sTUFBTS9CLHFCQUFxQlEsMkJBQTJCO0FBRTdELDRCQUE0QjtBQUM1QixJQUFJLEtBQWtCLEVBQWEsRUFFbEM7QUFnQkQsd0RBQXdEO0FBQ3hELGVBQWVxQyxtQkFDWEMsVUFBa0IsRUFDbEJDLFFBQWlELEVBQ2pEQyxRQUFnQixFQUNoQkMsa0JBQTJCO0lBRTNCLElBQUksS0FBNEMsRUFBRSxFQUVqRDtJQUVELE1BQU1LLFVBQVU7UUFDWixnQkFBZ0I7UUFDaEIsa0JBQWtCSix5Q0FBMkM7UUFDN0Qsb0JBQW9CO0lBQ3hCO0lBRUEsNkRBQTZEO0lBQzdELE1BQU1LLFFBQVFOLHFCQUNSLENBQUMsVUFBVSxFQUFFSCxXQUFXLElBQUksRUFBRUUsU0FBUyxDQUFDLEdBQ3hDLENBQUMsRUFBRUYsV0FBVyxDQUFDLEVBQUVFLFNBQVMsQ0FBQztJQUVqQ2xFLFFBQVFnQyxHQUFHLENBQUMsQ0FBQywyQkFBMkIsRUFBRW1DLHFCQUFxQixjQUFjLFdBQVcsUUFBUSxDQUFDLEVBQUVNO0lBRW5HLE1BQU1DLFNBQVMsTUFBTUMsVUFBVUYsT0FBT0QsU0FBU1A7SUFDL0MsT0FBT1M7QUFDWDtBQUVBLGVBQWVDLFVBQ1hGLEtBQWEsRUFDYkQsT0FBWSxFQUNaUCxRQUFpRDtJQUVqRCxJQUFJO1FBQ0EsTUFBTVcsV0FBVyxNQUFNQyxNQUFNLHNEQUFzRDtZQUMvRUMsUUFBUTtZQUNSTjtZQUNBTyxNQUFNN0MsS0FBS21CLFNBQVMsQ0FBQztnQkFDakIyQixXQUFXUDtnQkFDWFEsY0FBYztvQkFDVkMsUUFBUTt3QkFDSkMsUUFBUTs0QkFDSkMsVUFBVW5CLFNBQVNtQixRQUFROzRCQUMzQkMsV0FBV3BCLFNBQVNvQixTQUFTO3dCQUNqQzt3QkFDQUMsUUFBUTtvQkFDWjtnQkFDSjtnQkFDQUMsZ0JBQWdCO1lBQ3BCO1FBQ0o7UUFFQSxJQUFJLENBQUNYLFNBQVNZLEVBQUUsRUFBRTtZQUNkeEYsUUFBUUQsS0FBSyxDQUFDLDhCQUE4QjtnQkFDeEMwRixRQUFRYixTQUFTYSxNQUFNO2dCQUN2QkMsWUFBWWQsU0FBU2MsVUFBVTtnQkFDL0JqQjtZQUNKO1lBQ0EsT0FBTztRQUNYO1FBRUEsTUFBTWtCLE9BQU8sTUFBTWYsU0FBU2dCLElBQUk7UUFDaEMsSUFBSSxDQUFDRCxLQUFLN0UsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQ25CZCxRQUFRZ0MsR0FBRyxDQUFDLDBDQUEwQ3lDO1lBQ3RELE9BQU87UUFDWDtRQUVBekUsUUFBUWdDLEdBQUcsQ0FBQyxnQ0FBZ0M7WUFDeENYLElBQUlzRSxLQUFLN0UsTUFBTSxDQUFDLEVBQUUsQ0FBQ08sRUFBRTtZQUNyQlQsTUFBTStFLEtBQUs3RSxNQUFNLENBQUMsRUFBRSxDQUFDSixXQUFXLEVBQUVDLFFBQVFnRixLQUFLN0UsTUFBTSxDQUFDLEVBQUUsQ0FBQ0YsSUFBSTtRQUNqRTtRQUVBLE9BQU87WUFBRUUsUUFBUTtnQkFBQzZFLEtBQUs3RSxNQUFNLENBQUMsRUFBRTthQUFDO1FBQUM7SUFDdEMsRUFBRSxPQUFPZixPQUFPO1FBQ1pDLFFBQVFELEtBQUssQ0FBQyxzQkFBc0JBO1FBQ3BDLE9BQU87SUFDWDtBQUNKO0FBRU8sZUFBZThGLGtCQUNsQjdCLFVBQWtCLEVBQ2xCQyxRQUFpRCxFQUNqRDZCLFdBQW1CO0lBRW5COUYsUUFBUWdDLEdBQUcsQ0FBQyw2Q0FBNkM7UUFDckRnQztRQUNBQztRQUNBNkI7SUFDSjtJQUVBLElBQUk7UUFDQSxNQUFNNUIsV0FBVzRCO1FBQ2pCLE1BQU1wQixTQUFTLE1BQU1YLG1CQUFtQkMsWUFBWUMsVUFBVUMsVUFBVTtRQUV4RSxJQUFJLENBQUNRLFFBQVE1RCxRQUFRLENBQUMsRUFBRSxFQUFFO1lBQ3RCLE9BQU87UUFDWDtRQUVBLE1BQU1MLFFBQVFzRix1QkFBdUJyQixPQUFPNUQsTUFBTSxDQUFDLEVBQUU7UUFDckQsSUFBSSxDQUFDTCxPQUFPO1lBQ1IsT0FBTztRQUNYO1FBRUEsMkRBQTJEO1FBQzNELE1BQU11RixpQkFBaUI5RSxtQkFBbUJnQyxRQUFRLENBQUN6QyxNQUFNWSxFQUFFO1FBRTNELElBQUksQ0FBQzJFLGdCQUFnQjtZQUNqQmhHLFFBQVFnQyxHQUFHLENBQUMseUNBQXlDO2dCQUNqRFgsSUFBSVosTUFBTVksRUFBRTtnQkFDWlQsTUFBTUosZUFBZUM7WUFDekI7WUFDQVMsbUJBQW1CeUIsUUFBUSxDQUFDbEM7WUFFNUIsaUJBQWlCO1lBQ2pCLE1BQU02QyxVQUFVQyxlQUFlQyxHQUFHO1lBQ2xDRixRQUFRRyxnQkFBZ0IsR0FBR3ZDLG1CQUFtQkosTUFBTSxDQUFDNEMsSUFBSTtZQUN6REgsZUFBZUksTUFBTSxDQUFDTDtRQUMxQjtRQUVBdEQsUUFBUWdDLEdBQUcsQ0FBQyxvQ0FBb0M7WUFDNUNYLElBQUlaLE1BQU1ZLEVBQUU7WUFDWlQsTUFBTUosZUFBZUM7WUFDckJ1RjtRQUNKO1FBRUEsT0FBT3ZGO0lBQ1gsRUFBRSxPQUFPVixPQUFPO1FBQ1pDLFFBQVFELEtBQUssQ0FBQyxrREFBa0RBO1FBQ2hFLE9BQU87SUFDWDtBQUNKO0FBRUEsZ0NBQWdDO0FBQ2hDLFNBQVNrRztJQUNMLElBQUksSUFBa0IsRUFBYTtRQUMvQixPQUFPO1lBQ0hDLGNBQWM7WUFDZHpDLGtCQUFrQjtZQUNsQjBDLFFBQVE7WUFDUkMsY0FBYyxDQUFDO1lBQ2ZDLGtCQUFrQixHQUFJLDZDQUE2QztRQUN2RTtJQUNKO0lBRUEsTUFBTS9DLFVBQVVyRixnRUFBZ0JBO0lBQ2hDLDZEQUE2RDtJQUM3RHFGLFFBQVFHLGdCQUFnQixHQUFHdkMsbUJBQW1CSixNQUFNLENBQUM0QyxJQUFJO0lBQ3pELE9BQU9KO0FBQ1g7QUFFQSw0QkFBNEI7QUFDNUIsU0FBU2dELGNBQWNoRCxPQUErQjtJQUNsRCxJQUFJLElBQWtCLEVBQWE7SUFDbkMsSUFBSTtRQUNBeEIsYUFBYXNCLE9BQU8sQ0FBQ3BGLCtEQUFtQkEsRUFBRWtFLEtBQUttQixTQUFTLENBQUNDO0lBQzdELEVBQUUsT0FBT3ZELE9BQU87UUFDWkMsUUFBUUQsS0FBSyxDQUFDLDBCQUEwQkE7SUFDNUM7QUFDSjtBQUVBLCtCQUErQjtBQUN4QixNQUFNd0QsaUJBQWlCO0lBQzFCQyxLQUFLeUM7SUFDTHRDLFFBQVEyQztBQUNaLEVBQUU7QUFFRiw0RUFBNEU7QUFDNUUsU0FBU1AsdUJBQXVCdEYsS0FBMEI7SUFDdEQsSUFBSSxDQUFDQSxPQUFPLE9BQU87SUFFbkJULFFBQVFnQyxHQUFHLENBQUMseUNBQXlDO1FBQ2pEWCxJQUFJWixNQUFNWSxFQUFFO1FBQ1prQixRQUFROUIsTUFBTThCLE1BQU0sRUFBRXBDLElBQUlvRyxDQUFBQSxJQUFNO2dCQUFFM0YsTUFBTTJGLEVBQUUzRixJQUFJO1lBQUM7UUFDL0M0Rix3QkFBd0IvRixNQUFNK0Ysc0JBQXNCO0lBQ3hEO0lBRUEsTUFBTTlGLGNBQWNELE1BQU1DLFdBQVcsRUFBRUMsT0FDakM7UUFBRUEsTUFBTUYsTUFBTUMsV0FBVyxDQUFDQyxJQUFJO1FBQUU4RixjQUFjaEcsTUFBTUMsV0FBVyxDQUFDK0YsWUFBWSxJQUFJO0lBQUssSUFDckZoRyxNQUFNRyxJQUFJLElBQUk7SUFFcEIsNENBQTRDO0lBQzVDLE1BQU0yQixTQUFTLENBQUM5QixNQUFNOEIsTUFBTSxJQUFJLEVBQUUsRUFDN0J0RCxNQUFNLENBQUMsQ0FBQ3lILFFBQ0xwRSxRQUFRb0UsU0FBU0EsTUFBTTlGLElBQUksR0FFOUJULEdBQUcsQ0FBQ3VHLENBQUFBLFFBQVU7WUFDWDlGLE1BQU04RixNQUFNOUYsSUFBSTtZQUNoQitGLFNBQVNELE1BQU1DLE9BQU87WUFDdEJDLFVBQVVGLE1BQU1FLFFBQVE7WUFDeEJDLG9CQUFvQkgsTUFBTUcsa0JBQWtCO1FBQ2hEO0lBRUosTUFBTUMsY0FBYztRQUNoQnpGLElBQUlaLE1BQU1ZLEVBQUU7UUFDWlQsTUFBTUgsTUFBTUcsSUFBSTtRQUNoQkY7UUFDQXFHLGFBQWF0RyxNQUFNc0csV0FBVyxJQUFJO1FBQ2xDeEU7UUFDQXlFLGtCQUFrQnZHLE1BQU11RyxnQkFBZ0I7UUFDeEMvQyxVQUFVeEQsTUFBTXdELFFBQVE7UUFDeEJ1Qyx3QkFBd0IvRixNQUFNK0Ysc0JBQXNCLEdBQzlDO1lBQUU3RixNQUFNRixNQUFNK0Ysc0JBQXNCLENBQUM3RixJQUFJO1lBQUU4RixjQUFjaEcsTUFBTStGLHNCQUFzQixDQUFDQyxZQUFZLElBQUk7UUFBSyxJQUMzR1E7SUFDVjtJQUVBakgsUUFBUWdDLEdBQUcsQ0FBQywrQ0FBK0M7UUFDdkRYLElBQUl5RixZQUFZekYsRUFBRTtRQUNsQmtCLFFBQVF1RSxZQUFZdkUsTUFBTSxDQUFDcEMsR0FBRyxDQUFDb0csQ0FBQUEsSUFBTTtnQkFBRTNGLE1BQU0yRixFQUFFM0YsSUFBSTtZQUFDO1FBQ3BENEYsd0JBQXdCTSxZQUFZTixzQkFBc0I7SUFDOUQ7SUFFQSxPQUFPTTtBQUNYO0FBRU8sTUFBTUksNkJBQTZCLE9BQ3RDbEQsWUFDQUMsVUFDQWtELGFBQXFCLENBQUM7SUFFdEIsSUFBSTtRQUNBLElBQUksS0FBNEMsRUFBRSxFQUdqRDtRQUVEbkgsUUFBUWdDLEdBQUcsQ0FBQyxxREFBcUQ7WUFDN0RnQztZQUNBQztZQUNBa0Q7UUFDSjtRQUVBLE1BQU1DLGNBQWM7WUFDaEJwQyxXQUFXaEI7WUFDWGlCLGNBQWM7Z0JBQ1ZDLFFBQVE7b0JBQ0pDLFFBQVE7d0JBQ0pDLFVBQVVuQixTQUFTbUIsUUFBUTt3QkFDM0JDLFdBQVdwQixTQUFTb0IsU0FBUztvQkFDakM7b0JBQ0FDLFFBQVEsUUFBUSxjQUFjO2dCQUNsQztZQUNKO1lBQ0FDLGdCQUFnQjRCO1FBQ3BCO1FBRUEsTUFBTTNDLFVBQVU7WUFDWixnQkFBZ0I7WUFDaEIsa0JBQWtCSix5Q0FBMkM7WUFDN0Qsb0JBQW9CO1FBQ3hCO1FBRUEsTUFBTVEsV0FBVyxNQUFNQyxNQUFNLHNEQUFzRDtZQUMvRUMsUUFBUTtZQUNSTjtZQUNBTyxNQUFNN0MsS0FBS21CLFNBQVMsQ0FBQytEO1FBQ3pCO1FBRUEsSUFBSSxDQUFDeEMsU0FBU1ksRUFBRSxFQUFFO1lBQ2QsTUFBTTZCLFlBQVksTUFBTXpDLFNBQVNqRSxJQUFJO1lBQ3JDWCxRQUFRRCxLQUFLLENBQUMsNEJBQTRCO2dCQUN0QzBGLFFBQVFiLFNBQVNhLE1BQU07Z0JBQ3ZCQyxZQUFZZCxTQUFTYyxVQUFVO2dCQUMvQjNGLE9BQU9zSDtZQUNYO1lBQ0EsT0FBTyxFQUFFO1FBQ2I7UUFFQSxNQUFNMUIsT0FBTyxNQUFNZixTQUFTZ0IsSUFBSTtRQUVoQyxJQUFJLENBQUNELEtBQUs3RSxNQUFNLElBQUksQ0FBQ0MsTUFBTUMsT0FBTyxDQUFDMkUsS0FBSzdFLE1BQU0sS0FBSzZFLEtBQUs3RSxNQUFNLENBQUNyQixNQUFNLEtBQUssR0FBRztZQUN6RU8sUUFBUWdDLEdBQUcsQ0FBQyxvQ0FBb0NnQztZQUNoRCxPQUFPLEVBQUU7UUFDYjtRQUVBLE9BQU8yQixLQUFLN0UsTUFBTSxDQUFDWCxHQUFHLENBQUMsQ0FBQ00sUUFBZ0I7Z0JBQ3BDWSxJQUFJWixNQUFNWSxFQUFFO2dCQUNaWCxhQUFhRCxNQUFNQyxXQUFXLEVBQUVDLE9BQU87b0JBQ25DQSxNQUFNRixNQUFNQyxXQUFXLENBQUNDLElBQUk7b0JBQzVCOEYsY0FBY2hHLE1BQU1DLFdBQVcsQ0FBQytGLFlBQVksSUFBSTtnQkFDcEQsSUFBSWhHLE1BQU1DLFdBQVc7Z0JBQ3JCcUcsYUFBYXRHLE1BQU1zRyxXQUFXLElBQUk7Z0JBQ2xDeEUsUUFBUTlCLE1BQU04QixNQUFNLEVBQUVwQyxJQUFJLENBQUN1RyxRQUFnQjt3QkFDdkM5RixNQUFNOEYsTUFBTTlGLElBQUk7d0JBQ2hCK0YsU0FBU0QsTUFBTUMsT0FBTzt3QkFDdEJDLFVBQVVGLE1BQU1FLFFBQVE7b0JBQzVCLE9BQU8sRUFBRTtnQkFDVEksa0JBQWtCdkcsTUFBTXVHLGdCQUFnQjtnQkFDeEMvQyxVQUFVeEQsTUFBTXdELFFBQVE7Z0JBQ3hCdUMsd0JBQXdCL0YsTUFBTStGLHNCQUFzQixHQUFHO29CQUNuRDdGLE1BQU1GLE1BQU0rRixzQkFBc0IsQ0FBQzdGLElBQUk7b0JBQ3ZDOEYsY0FBY2hHLE1BQU0rRixzQkFBc0IsQ0FBQ0MsWUFBWSxJQUFJO2dCQUMvRCxJQUFJUTtZQUNSO0lBQ0osRUFBRSxPQUFPbEgsT0FBTztRQUNaQyxRQUFRRCxLQUFLLENBQUMsK0JBQStCQTtRQUM3QyxPQUFPLEVBQUU7SUFDYjtBQUNKLEVBQUU7QUFFRixzQ0FBc0M7QUFDL0IsTUFBTXVILGNBQWMsT0FDdkJsQyxVQUNBQyxXQUNBM0csYUFDQXlJLGFBQXFCLENBQUMsRUFDdEJJO0lBRUEsSUFBSTtRQUNBLElBQUksS0FBNEMsRUFBRSxFQUdqRDtRQUVELE1BQU1DLGtCQUFrQixDQUFDLENBQUM5SSxlQUFlQSxZQUFZZSxNQUFNLEdBQUc7UUFDOUQsTUFBTWdJLGlCQUFpQixDQUFDLENBQUNGLGNBQWNBLFdBQVc5SCxNQUFNLEdBQUc7UUFFM0QsSUFBSSxDQUFDK0gsbUJBQW1CLENBQUNDLGdCQUFnQjtZQUNyQ3pILFFBQVFELEtBQUssQ0FBQztZQUNkLE9BQU8sRUFBRTtRQUNiO1FBRUEsZ0ZBQWdGO1FBQ2hGLElBQUkySCxnQkFBMEIsRUFBRTtRQUNoQyxJQUFJRixpQkFBaUI7WUFDakJFLGdCQUFnQmpKLDZCQUE2QkM7UUFDakQsT0FBTyxJQUFJK0ksZ0JBQWdCO1lBQ3ZCQyxnQkFBZ0JIO1FBQ3BCO1FBRUF2SCxRQUFRZ0MsR0FBRyxDQUFDLHNDQUFzQztZQUM5Q29EO1lBQ0FDO1lBQ0FxQztZQUNBUDtZQUNBSyxpQkFBaUIsQ0FBQyxDQUFDOUksYUFBYWU7WUFDaENnSSxnQkFBZ0IsQ0FBQyxDQUFDRixZQUFZOUg7UUFDbEM7UUFFQSwwQkFBMEI7UUFDMUIsSUFBSTtZQUNBLE1BQU0ySCxjQUFjO2dCQUNoQk07Z0JBQ0FuQyxnQkFBZ0I0QjtnQkFDaEJRLHFCQUFxQjtvQkFDakJ6QyxRQUFRO3dCQUNKQyxRQUFROzRCQUNKQyxVQUFVQTs0QkFDVkMsV0FBV0E7d0JBQ2Y7d0JBQ0FDLFFBQVEsUUFBUSxjQUFjO29CQUNsQztnQkFDSjtZQUNKO1lBRUEsTUFBTWQsVUFBVTtnQkFDWixnQkFBZ0I7Z0JBQ2hCLGtCQUFrQkoseUNBQTJDO2dCQUM3RCxvQkFBb0I7WUFDeEI7WUFFQSxNQUFNUSxXQUFXLE1BQU1DLE1BQU0sd0RBQXdEO2dCQUNqRkMsUUFBUTtnQkFDUk47Z0JBQ0FPLE1BQU03QyxLQUFLbUIsU0FBUyxDQUFDK0Q7WUFDekI7WUFFQSxJQUFJeEMsU0FBU1ksRUFBRSxFQUFFO2dCQUNiLE1BQU1HLE9BQU8sTUFBTWYsU0FBU2dCLElBQUk7Z0JBQ2hDLElBQUlELEtBQUs3RSxNQUFNLElBQUlDLE1BQU1DLE9BQU8sQ0FBQzJFLEtBQUs3RSxNQUFNLEtBQUs2RSxLQUFLN0UsTUFBTSxDQUFDckIsTUFBTSxHQUFHLEdBQUc7b0JBQ3JFLE9BQU9rRyxLQUFLN0UsTUFBTSxDQUFDWCxHQUFHLENBQUMsQ0FBQ00sUUFBZ0I7NEJBQ3BDWSxJQUFJWixNQUFNWSxFQUFFOzRCQUNaWCxhQUFhRCxNQUFNQyxXQUFXLEVBQUVDLE9BQU87Z0NBQ25DQSxNQUFNRixNQUFNQyxXQUFXLENBQUNDLElBQUk7Z0NBQzVCOEYsY0FBY2hHLE1BQU1DLFdBQVcsQ0FBQytGLFlBQVksSUFBSTs0QkFDcEQsSUFBSWhHLE1BQU1DLFdBQVc7NEJBQ3JCcUcsYUFBYXRHLE1BQU1zRyxXQUFXLElBQUk7NEJBQ2xDeEUsUUFBUTlCLE1BQU04QixNQUFNLEVBQUVwQyxJQUFJLENBQUN1RyxRQUFnQjtvQ0FDdkM5RixNQUFNOEYsTUFBTTlGLElBQUk7b0NBQ2hCK0YsU0FBU0QsTUFBTUMsT0FBTztvQ0FDdEJDLFVBQVVGLE1BQU1FLFFBQVE7Z0NBQzVCLE9BQU8sRUFBRTs0QkFDVEksa0JBQWtCdkcsTUFBTXVHLGdCQUFnQjs0QkFDeEMvQyxVQUFVeEQsTUFBTXdELFFBQVE7NEJBQ3hCdUMsd0JBQXdCL0YsTUFBTStGLHNCQUFzQixHQUFHO2dDQUNuRDdGLE1BQU1GLE1BQU0rRixzQkFBc0IsQ0FBQzdGLElBQUk7Z0NBQ3ZDOEYsY0FBY2hHLE1BQU0rRixzQkFBc0IsQ0FBQ0MsWUFBWSxJQUFJOzRCQUMvRCxJQUFJUTt3QkFDUjtnQkFDSjtZQUNKO1lBRUEsTUFBTUksWUFBWSxNQUFNekMsU0FBU2pFLElBQUk7WUFDckNYLFFBQVFELEtBQUssQ0FBQywyQkFBMkI7Z0JBQ3JDMEYsUUFBUWIsU0FBU2EsTUFBTTtnQkFDdkJDLFlBQVlkLFNBQVNjLFVBQVU7Z0JBQy9CM0YsT0FBT3NIO1lBQ1g7UUFDSixFQUFFLE9BQU90SCxPQUFPO1lBQ1pDLFFBQVFELEtBQUssQ0FBQywyQkFBMkJBO1FBQzdDO1FBRUEsc0RBQXNEO1FBQ3REQyxRQUFRZ0MsR0FBRyxDQUFDO1FBQ1osTUFBTTRGLGNBQWNILGlCQUFpQkYsVUFBVyxDQUFDLEVBQUUsR0FBRzdJLFdBQVksQ0FBQyxFQUFFO1FBQ3JFLE9BQU8sTUFBTXdJLDJCQUEyQlUsYUFBYTtZQUFFeEM7WUFBVUM7UUFBVSxHQUFHOEI7SUFFbEYsRUFBRSxPQUFPcEgsT0FBTztRQUNaQyxRQUFRRCxLQUFLLENBQUMsMEJBQTBCQTtRQUN4QyxPQUFPLEVBQUU7SUFDYjtBQUNKLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cmF2ZWwtcml6ei8uL3V0aWxzL3BsYWNlcy11dGlscy50cz81NTVjIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFBsYWNlIHJlbGF0ZWQgaW50ZXJmYWNlc1xuZXhwb3J0IGludGVyZmFjZSBQbGFjZSB7XG4gICAgbmFtZTogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgIGlkOiBzdHJpbmc7XG4gICAgZGlzcGxheU5hbWU6IHtcbiAgICAgICAgdGV4dDogc3RyaW5nO1xuICAgICAgICBsYW5ndWFnZUNvZGU6IHN0cmluZztcbiAgICB9IHwgc3RyaW5nO1xuICAgIGZvcm1hdHRlZEFkZHJlc3M/OiBzdHJpbmc7XG4gICAgbG9jYXRpb24/OiB7XG4gICAgICAgIGxhdGl0dWRlOiBudW1iZXI7XG4gICAgICAgIGxvbmdpdHVkZTogbnVtYmVyO1xuICAgIH07XG4gICAgcHJpbWFyeVR5cGU6IHN0cmluZztcbiAgICBwcmltYXJ5VHlwZURpc3BsYXlOYW1lPzoge1xuICAgICAgICB0ZXh0OiBzdHJpbmc7XG4gICAgICAgIGxhbmd1YWdlQ29kZTogc3RyaW5nO1xuICAgIH07XG4gICAgcGhvdG9zOiB7IFxuICAgICAgICBuYW1lOiBzdHJpbmc7XG4gICAgICAgIHdpZHRoUHg/OiBudW1iZXI7XG4gICAgICAgIGhlaWdodFB4PzogbnVtYmVyO1xuICAgICAgICBhdXRob3JBdHRyaWJ1dGlvbnM/OiBBcnJheTx7XG4gICAgICAgICAgICBkaXNwbGF5TmFtZT86IHN0cmluZztcbiAgICAgICAgICAgIHVyaT86IHN0cmluZztcbiAgICAgICAgICAgIHBob3RvVXJpPzogc3RyaW5nO1xuICAgICAgICB9PjtcbiAgICB9W107XG59XG5cbmludGVyZmFjZSBHb29nbGVQbGFjZVJlc3BvbnNlIHtcbiAgICBpZDogc3RyaW5nO1xuICAgIG5hbWU/OiBzdHJpbmc7XG4gICAgZGlzcGxheU5hbWU/OiB7XG4gICAgICAgIHRleHQ6IHN0cmluZztcbiAgICAgICAgbGFuZ3VhZ2VDb2RlOiBzdHJpbmc7XG4gICAgfTtcbiAgICBmb3JtYXR0ZWRBZGRyZXNzPzogc3RyaW5nO1xuICAgIGxvY2F0aW9uPzoge1xuICAgICAgICBsYXRpdHVkZTogbnVtYmVyO1xuICAgICAgICBsb25naXR1ZGU6IG51bWJlcjtcbiAgICB9O1xuICAgIHByaW1hcnlUeXBlPzogc3RyaW5nO1xuICAgIHByaW1hcnlUeXBlRGlzcGxheU5hbWU/OiB7XG4gICAgICAgIHRleHQ6IHN0cmluZztcbiAgICAgICAgbGFuZ3VhZ2VDb2RlOiBzdHJpbmc7XG4gICAgfTtcbiAgICBwaG90b3M/OiBBcnJheTx7XG4gICAgICAgIG5hbWU6IHN0cmluZztcbiAgICAgICAgd2lkdGhQeD86IG51bWJlcjtcbiAgICAgICAgaGVpZ2h0UHg/OiBudW1iZXI7XG4gICAgICAgIGF1dGhvckF0dHJpYnV0aW9ucz86IEFycmF5PHtcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lPzogc3RyaW5nO1xuICAgICAgICAgICAgdXJpPzogc3RyaW5nO1xuICAgICAgICAgICAgcGhvdG9Vcmk/OiBzdHJpbmc7XG4gICAgICAgIH0+O1xuICAgIH0+O1xufVxuXG5pbXBvcnQgeyBUcmF2ZWxQcmVmZXJlbmNlIH0gZnJvbSAnLi4vbWFuYWdlcnMvdHlwZXMnO1xuaW1wb3J0IHsgVXNlckludGVyYWN0aW9uTWV0cmljcyB9IGZyb20gJy4uL21hbmFnZXJzL3N0YWdlLW1hbmFnZXInO1xuaW1wb3J0IHsgTUVUUklDU19TVE9SQUdFX0tFWSwgZ2V0U3RvcmVkTWV0cmljcyB9IGZyb20gJy4vbG9jYWwtbWV0cmljcyc7XG5cbi8vIFVwZGF0ZWQgcHJlZmVyZW5jZSB0byBwbGFjZSB0eXBlcyBtYXBwaW5nIGJhc2VkIG9uIHRyYXZlbC1yaXp6Lmh0bWxcbmV4cG9ydCBjb25zdCBwcmVmZXJlbmNlVG9QbGFjZVR5cGVzOiBSZWNvcmQ8VHJhdmVsUHJlZmVyZW5jZSwgc3RyaW5nW10+ID0ge1xuICAgIFtUcmF2ZWxQcmVmZXJlbmNlLkN1bHR1cmVdOiBbXG4gICAgICAgICdtdXNldW0nLFxuICAgICAgICAnY3VsdHVyYWxfY2VudGVyJyxcbiAgICAgICAgJ2N1bHR1cmFsX2xhbmRtYXJrJyxcbiAgICAgICAgJ2hpc3RvcmljYWxfbGFuZG1hcmsnLFxuICAgICAgICAnbW9udW1lbnQnLFxuICAgICAgICAnYXJ0X2dhbGxlcnknLFxuICAgICAgICAnaGlzdG9yaWNhbF9wbGFjZSdcbiAgICBdLFxuICAgIFtUcmF2ZWxQcmVmZXJlbmNlLk5hdHVyZV06IFtcbiAgICAgICAgJ25hdGlvbmFsX3BhcmsnLFxuICAgICAgICAnc3RhdGVfcGFyaycsXG4gICAgICAgICdib3RhbmljYWxfZ2FyZGVuJyxcbiAgICAgICAgJ3dpbGRsaWZlX3BhcmsnLFxuICAgICAgICAnZ2FyZGVuJyxcbiAgICAgICAgJ2hpa2luZ19hcmVhJyxcbiAgICAgICAgJ3dpbGRsaWZlX3JlZnVnZSdcbiAgICBdLFxuICAgIFtUcmF2ZWxQcmVmZXJlbmNlLkZvb2RdOiBbXG4gICAgICAgICdyZXN0YXVyYW50JyxcbiAgICAgICAgJ2ZpbmVfZGluaW5nX3Jlc3RhdXJhbnQnLFxuICAgICAgICAnY2FmZScsXG4gICAgICAgICdmb29kX2NvdXJ0JyxcbiAgICAgICAgJ2Jha2VyeScsXG4gICAgICAgICdkZXNzZXJ0X3Nob3AnLFxuICAgICAgICAnYmFyX2FuZF9ncmlsbCdcbiAgICBdLFxuICAgIFtUcmF2ZWxQcmVmZXJlbmNlLlJlbGF4YXRpb25dOiBbXG4gICAgICAgICdzcGEnLFxuICAgICAgICAnd2VsbG5lc3NfY2VudGVyJyxcbiAgICAgICAgJ3Nob3BwaW5nX21hbGwnLFxuICAgICAgICAnYmVhY2gnLFxuICAgICAgICAnZ2FyZGVuJyxcbiAgICAgICAgJ3BsYXphJyxcbiAgICAgICAgJ3lvZ2Ffc3R1ZGlvJ1xuICAgIF0sXG4gICAgW1RyYXZlbFByZWZlcmVuY2UuQWR2ZW50dXJlXTogW1xuICAgICAgICAnYWR2ZW50dXJlX3Nwb3J0c19jZW50ZXInLFxuICAgICAgICAnYW11c2VtZW50X3BhcmsnLFxuICAgICAgICAnaGlraW5nX2FyZWEnLFxuICAgICAgICAnc3BvcnRzX2NvbXBsZXgnLFxuICAgICAgICAnd2F0ZXJfcGFyaycsXG4gICAgICAgICdvZmZfcm9hZGluZ19hcmVhJyxcbiAgICAgICAgJ3Nwb3J0c19hY3Rpdml0eV9sb2NhdGlvbidcbiAgICBdLFxuICAgIFtUcmF2ZWxQcmVmZXJlbmNlLlNob3BwaW5nXTogWyAvLyBBcnRzICYgTXVzZXVtXG4gICAgICAgICdhcnRfZ2FsbGVyeScsXG4gICAgICAgICdhcnRfc3R1ZGlvJyxcbiAgICAgICAgJ3BlcmZvcm1pbmdfYXJ0c190aGVhdGVyJyxcbiAgICAgICAgJ2F1ZGl0b3JpdW0nLFxuICAgICAgICAnY29uY2VydF9oYWxsJyxcbiAgICAgICAgJ211c2V1bScsXG4gICAgICAgICdvcGVyYV9ob3VzZSdcbiAgICBdXG59O1xuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gZ2V0IHBsYWNlIHR5cGVzIGJhc2VkIG9uIHByZWZlcmVuY2VzXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGxhY2VUeXBlc0Zyb21QcmVmZXJlbmNlcyhwcmVmZXJlbmNlczogVHJhdmVsUHJlZmVyZW5jZVtdKTogc3RyaW5nW10ge1xuICAgIHRyeSB7XG4gICAgICAgIC8vIFRyYWNrIHVzZWQgdHlwZXMgdG8gYXZvaWQgcmVwZWF0c1xuICAgICAgICBjb25zdCB1c2VkVHlwZXMgPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgICAgICAgY29uc3QgcmVzdWx0VHlwZXM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIFxuICAgICAgICAvLyBQcm9jZXNzIGVhY2ggcHJlZmVyZW5jZVxuICAgICAgICBwcmVmZXJlbmNlcy5mb3JFYWNoKHByZWYgPT4ge1xuICAgICAgICAgICAgY29uc3QgYXZhaWxhYmxlVHlwZXMgPSBwcmVmZXJlbmNlVG9QbGFjZVR5cGVzW3ByZWZdPy5maWx0ZXIoXG4gICAgICAgICAgICAgICAgdHlwZSA9PiAhdXNlZFR5cGVzLmhhcyh0eXBlKVxuICAgICAgICAgICAgKSB8fCBbXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVGFrZSAyLTMgcmFuZG9tIHR5cGVzIGZyb20gZWFjaCBwcmVmZXJlbmNlXG4gICAgICAgICAgICBjb25zdCBudW1UeXBlcyA9IE1hdGgubWluKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIpICsgMiwgYXZhaWxhYmxlVHlwZXMubGVuZ3RoKTtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkVHlwZXMgPSBhdmFpbGFibGVUeXBlc1xuICAgICAgICAgICAgICAgIC5zb3J0KCgpID0+IE1hdGgucmFuZG9tKCkgLSAwLjUpXG4gICAgICAgICAgICAgICAgLnNsaWNlKDAsIG51bVR5cGVzKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCB0byByZXN1bHRzIGFuZCBtYXJrIGFzIHVzZWRcbiAgICAgICAgICAgIHNlbGVjdGVkVHlwZXMuZm9yRWFjaCh0eXBlID0+IHtcbiAgICAgICAgICAgICAgICByZXN1bHRUeXBlcy5wdXNoKHR5cGUpO1xuICAgICAgICAgICAgICAgIHVzZWRUeXBlcy5hZGQodHlwZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdFR5cGVzO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgcGxhY2UgdHlwZXMgZnJvbSBwcmVmZXJlbmNlczonLCBlcnJvcik7XG4gICAgICAgIHJldHVybiBbJ3RvdXJpc3RfYXR0cmFjdGlvbiddOyAvLyBEZWZhdWx0IGZhbGxiYWNrXG4gICAgfVxufVxuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gZm9ybWF0IHByaW1hcnkgdHlwZVxuZXhwb3J0IGNvbnN0IGZvcm1hdFByaW1hcnlUeXBlID0gKHR5cGU6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gICAgcmV0dXJuIHR5cGUuc3BsaXQoJ18nKVxuICAgICAgICAubWFwKHdvcmQgPT4gd29yZC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHdvcmQuc2xpY2UoMSkpXG4gICAgICAgIC5qb2luKCcgJyk7XG59O1xuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gZ2V0IGRpc3BsYXkgbmFtZSBmb3IgcGxhY2UgdHlwZVxuZXhwb3J0IGNvbnN0IGdldERpc3BsYXlOYW1lID0gKHBsYWNlOiBQbGFjZSk6IHN0cmluZyA9PiB7XG4gICAgaWYgKHR5cGVvZiBwbGFjZS5kaXNwbGF5TmFtZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgcmV0dXJuIHBsYWNlLmRpc3BsYXlOYW1lO1xuICAgIH1cbiAgICByZXR1cm4gcGxhY2UuZGlzcGxheU5hbWU/LnRleHQgfHwgcGxhY2UubmFtZSB8fCAnJztcbn07XG5cbi8vIEZ1bmN0aW9uIHRvIGZpbHRlciBvdXQgZHVwbGljYXRlIHBsYWNlc1xuZXhwb3J0IGZ1bmN0aW9uIGZpbHRlclVuaXF1ZVBsYWNlcyhwbGFjZXM6IFBsYWNlW10pOiBQbGFjZVtdIHtcbiAgICBpZiAoIXBsYWNlcyB8fCAhQXJyYXkuaXNBcnJheShwbGFjZXMpKSByZXR1cm4gW107XG5cbiAgICAvLyBHZXQgc2F2ZWQgcGxhY2VzIGZyb20gZ2xvYmFsIHN0YXRlIGlmIGF2YWlsYWJsZVxuICAgIGNvbnN0IHNhdmVkUGxhY2VzID0gc2F2ZWRQbGFjZXNNYW5hZ2VyLmdldFBsYWNlcygpO1xuXG4gICAgY29uc3Qgc2F2ZWRQbGFjZUlkcyA9IG5ldyBTZXQoc2F2ZWRQbGFjZXMubWFwKHBsYWNlID0+IHBsYWNlLmlkKSk7XG4gICAgY29uc3Qgc2F2ZWRQbGFjZU5hbWVzID0gbmV3IFNldChzYXZlZFBsYWNlcy5tYXAocGxhY2UgPT4gXG4gICAgICAgIHR5cGVvZiBwbGFjZS5kaXNwbGF5TmFtZSA9PT0gJ3N0cmluZycgXG4gICAgICAgICAgICA/IHBsYWNlLmRpc3BsYXlOYW1lLnRvTG93ZXJDYXNlKCkgXG4gICAgICAgICAgICA6IHBsYWNlLmRpc3BsYXlOYW1lLnRleHQudG9Mb3dlckNhc2UoKVxuICAgICkpO1xuXG4gICAgIC8vIEZpbHRlciBvdXQgcGxhY2VzIHRoYXQ6XG4gICAgLy8gMS4gSGF2ZSBzYW1lIElEIGFzIHNhdmVkIHBsYWNlXG4gICAgLy8gMi4gSGF2ZSBzYW1lIG5hbWUgYXMgc2F2ZWQgcGxhY2VcbiAgICByZXR1cm4gcGxhY2VzLmZpbHRlcihwbGFjZSA9PiB7XG4gICAgICAgIGlmICghcGxhY2UuaWQpIHJldHVybiBmYWxzZTtcbiAgICAgICAgaWYgKHNhdmVkUGxhY2VJZHMuaGFzKHBsYWNlLmlkKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgcGxhY2VOYW1lID0gdHlwZW9mIHBsYWNlLmRpc3BsYXlOYW1lID09PSAnc3RyaW5nJyBcbiAgICAgICAgICAgID8gcGxhY2UuZGlzcGxheU5hbWUudG9Mb3dlckNhc2UoKVxuICAgICAgICAgICAgOiBwbGFjZS5kaXNwbGF5TmFtZS50ZXh0LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgaWYgKHNhdmVkUGxhY2VOYW1lcy5oYXMocGxhY2VOYW1lKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSk7XG59XG5cbi8vIEFkZCBTYXZlZFBsYWNlc01hbmFnZXIgaW50ZXJmYWNlXG5leHBvcnQgaW50ZXJmYWNlIFNhdmVkUGxhY2VzTWFuYWdlciB7XG4gICAgcGxhY2VzOiBNYXA8c3RyaW5nLCBQbGFjZT47XG4gICAgYWRkUGxhY2U6IChwbGFjZTogUGxhY2UpID0+IHZvaWQ7XG4gICAgcmVtb3ZlUGxhY2U6IChpZDogc3RyaW5nKSA9PiB2b2lkO1xuICAgIGdldFBsYWNlczogKCkgPT4gUGxhY2VbXTtcbiAgICBoYXNQbGFjZTogKGlkOiBzdHJpbmcpID0+IGJvb2xlYW47XG4gICAgX3BlcnNpc3Q6ICgpID0+IHZvaWQ7XG4gICAgX25vdGlmeUNoYW5nZTogKCkgPT4gdm9pZDtcbiAgICBzZXJpYWxpemU6ICgpID0+IHN0cmluZztcbn1cblxuY29uc3QgU1RPUkFHRV9LRVkgPSAnc2F2ZWRfcGxhY2VzJztcblxuLy8gU2F2ZWRQbGFjZXNNYW5hZ2VyIHNpbmdsZXRvblxuY29uc3QgY3JlYXRlU2F2ZWRQbGFjZXNNYW5hZ2VyID0gKCk6IFNhdmVkUGxhY2VzTWFuYWdlciA9PiB7XG4gICAgY29uc3QgcGxhY2VzID0gbmV3IE1hcDxzdHJpbmcsIFBsYWNlPigpO1xuICAgIGxldCBpbml0aWFsaXplZCA9IGZhbHNlO1xuXG4gICAgLy8gTG9hZCBwbGFjZXMgZnJvbSBsb2NhbFN0b3JhZ2VcbiAgICBjb25zdCBsb2FkRnJvbVN0b3JhZ2UgPSAoKSA9PiB7XG4gICAgICAgIGlmICghaW5pdGlhbGl6ZWQgJiYgdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIGNvbnN0IHNhdmVkUGxhY2VzID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oU1RPUkFHRV9LRVkpO1xuICAgICAgICAgICAgaWYgKHNhdmVkUGxhY2VzKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tzYXZlZFBsYWNlc01hbmFnZXJdIFJhdyBzYXZlZCBwbGFjZXM6Jywgc2F2ZWRQbGFjZXMpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJzZWRQbGFjZXMgPSBKU09OLnBhcnNlKHNhdmVkUGxhY2VzKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tzYXZlZFBsYWNlc01hbmFnZXJdIFBhcnNlZCBwbGFjZXM6JywgcGFyc2VkUGxhY2VzKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHBhcnNlZFBsYWNlcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENsZWFyIGV4aXN0aW5nIHBsYWNlcyBiZWZvcmUgbG9hZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2VzLmNsZWFyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlZFBsYWNlcy5mb3JFYWNoKHBsYWNlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW3NhdmVkUGxhY2VzTWFuYWdlcl0gUHJvY2Vzc2luZyBwbGFjZTonLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBwbGFjZS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzUGhvdG9zOiBCb29sZWFuKHBsYWNlLnBob3RvcyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBob3RvQ291bnQ6IHBsYWNlLnBob3Rvcz8ubGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdFBob3RvOiBwbGFjZS5waG90b3M/LlswXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwbGFjZT8uaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2VzLnNldChwbGFjZS5pZCwgcGxhY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignW3NhdmVkUGxhY2VzTWFuYWdlcl0gRXJyb3IgbG9hZGluZyBwbGFjZXM6JywgZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBwbGFjZXMsXG4gICAgICAgIGFkZFBsYWNlKHBsYWNlOiBQbGFjZSkge1xuICAgICAgICAgICAgbG9hZEZyb21TdG9yYWdlKCk7IC8vIEVuc3VyZSBwbGFjZXMgYXJlIGxvYWRlZFxuICAgICAgICAgICAgaWYgKHBsYWNlPy5pZCkge1xuICAgICAgICAgICAgICAgIHBsYWNlcy5zZXQocGxhY2UuaWQsIHBsYWNlKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9wZXJzaXN0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbm90aWZ5Q2hhbmdlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlbW92ZVBsYWNlKGlkOiBzdHJpbmcpIHtcbiAgICAgICAgICAgIGxvYWRGcm9tU3RvcmFnZSgpOyAvLyBFbnN1cmUgcGxhY2VzIGFyZSBsb2FkZWRcbiAgICAgICAgICAgIHBsYWNlcy5kZWxldGUoaWQpO1xuICAgICAgICAgICAgdGhpcy5fcGVyc2lzdCgpO1xuICAgICAgICAgICAgdGhpcy5fbm90aWZ5Q2hhbmdlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGdldFBsYWNlcygpOiBQbGFjZVtdIHtcbiAgICAgICAgICAgIGxvYWRGcm9tU3RvcmFnZSgpOyAvLyBFbnN1cmUgcGxhY2VzIGFyZSBsb2FkZWRcbiAgICAgICAgICAgIHJldHVybiBBcnJheS5mcm9tKHBsYWNlcy52YWx1ZXMoKSk7XG4gICAgICAgIH0sXG4gICAgICAgIGhhc1BsYWNlKGlkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgICAgIGxvYWRGcm9tU3RvcmFnZSgpOyAvLyBFbnN1cmUgcGxhY2VzIGFyZSBsb2FkZWRcbiAgICAgICAgICAgIHJldHVybiBwbGFjZXMuaGFzKGlkKTtcbiAgICAgICAgfSxcbiAgICAgICAgX3BlcnNpc3QoKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwbGFjZXNBcnJheSA9IEFycmF5LmZyb20ocGxhY2VzLnZhbHVlcygpKTtcbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShTVE9SQUdFX0tFWSwgSlNPTi5zdHJpbmdpZnkocGxhY2VzQXJyYXkpKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgbWV0cmljc1xuICAgICAgICAgICAgICAgIGNvbnN0IG1ldHJpY3MgPSBtZXRyaWNzTWFuYWdlci5nZXQoKTtcbiAgICAgICAgICAgICAgICBtZXRyaWNzLnNhdmVkUGxhY2VzQ291bnQgPSBwbGFjZXMuc2l6ZTtcbiAgICAgICAgICAgICAgICBtZXRyaWNzTWFuYWdlci51cGRhdGUobWV0cmljcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIF9ub3RpZnlDaGFuZ2UoKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2F2ZWRQbGFjZXMgPSBBcnJheS5mcm9tKHBsYWNlcy52YWx1ZXMoKSk7XG4gICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5nZXRTYXZlZFBsYWNlcykge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZ2V0U2F2ZWRQbGFjZXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHNlcmlhbGl6ZSgpIHtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShBcnJheS5mcm9tKHBsYWNlcy52YWx1ZXMoKSkpO1xuICAgICAgICB9XG4gICAgfTtcbn07XG5cbmV4cG9ydCBjb25zdCBzYXZlZFBsYWNlc01hbmFnZXIgPSBjcmVhdGVTYXZlZFBsYWNlc01hbmFnZXIoKTtcblxuLy8gSW5pdGlhbGl6ZSBvbiBjbGllbnQgc2lkZVxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgc2F2ZWRQbGFjZXNNYW5hZ2VyLnBsYWNlcyA9IG5ldyBNYXA8c3RyaW5nLCBQbGFjZT4oKTtcbn1cblxuLy8gRGVjbGFyZSB3aW5kb3cgaW50ZXJmYWNlIGZvciBzYXZlZCBwbGFjZXNcbmRlY2xhcmUgZ2xvYmFsIHtcbiAgICBpbnRlcmZhY2UgV2luZG93IHtcbiAgICAgICAgc2F2ZWRQbGFjZXM6IFBsYWNlW107XG4gICAgICAgIGFkZFBsYWNlVG9NYXA/OiAocGxhY2U6IHtcbiAgICAgICAgICAgIGxhdGl0dWRlOiBudW1iZXI7XG4gICAgICAgICAgICBsb25naXR1ZGU6IG51bWJlcjtcbiAgICAgICAgICAgIHRpdGxlPzogc3RyaW5nO1xuICAgICAgICAgICAgcGxhY2U/OiBQbGFjZTtcbiAgICAgICAgfSkgPT4gdm9pZDtcbiAgICAgICAgZ2V0U2F2ZWRQbGFjZXM/OiAoKSA9PiBQbGFjZVtdO1xuICAgIH1cbn1cblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGhhbmRsZSBkaWZmZXJlbnQgc2VhcmNoIHN0cmF0ZWdpZXNcbmFzeW5jIGZ1bmN0aW9uIHNlYXJjaFdpdGhTdHJhdGVneShcbiAgICBzZWFyY2hUZXh0OiBzdHJpbmcsXG4gICAgbG9jYXRpb246IHsgbGF0aXR1ZGU6IG51bWJlcjsgbG9uZ2l0dWRlOiBudW1iZXIgfSxcbiAgICBjaXR5TmFtZTogc3RyaW5nLFxuICAgIHVzZUFsdGVybmF0ZVNlYXJjaDogYm9vbGVhblxuKTogUHJvbWlzZTxhbnk+IHtcbiAgICBpZiAoIXByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0dPT0dMRV9NQVBTX0FQSV9LRVkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdHb29nbGUgTWFwcyBBUEkga2V5IGlzIG1pc3NpbmcnKTtcbiAgICB9XG5cbiAgICBjb25zdCBoZWFkZXJzID0ge1xuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAnWC1Hb29nLUFwaS1LZXknOiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19HT09HTEVfTUFQU19BUElfS0VZLFxuICAgICAgICAnWC1Hb29nLUZpZWxkTWFzayc6ICdwbGFjZXMuaWQscGxhY2VzLmRpc3BsYXlOYW1lLHBsYWNlcy5mb3JtYXR0ZWRBZGRyZXNzLHBsYWNlcy5sb2NhdGlvbixwbGFjZXMucHJpbWFyeVR5cGUscGxhY2VzLnByaW1hcnlUeXBlRGlzcGxheU5hbWUscGxhY2VzLnBob3Rvcy5uYW1lLHBsYWNlcy5waG90b3Mud2lkdGhQeCxwbGFjZXMucGhvdG9zLmhlaWdodFB4J1xuICAgIH0gYXMgY29uc3Q7XG5cbiAgICAvLyBDaG9vc2UgcXVlcnkgYmFzZWQgb24gd2hldGhlciB3ZSdyZSBkb2luZyBhbHRlcm5hdGUgc2VhcmNoXG4gICAgY29uc3QgcXVlcnkgPSB1c2VBbHRlcm5hdGVTZWFyY2ggXG4gICAgICAgID8gYGRpZmZlcmVudCAke3NlYXJjaFRleHR9IGluICR7Y2l0eU5hbWV9YFxuICAgICAgICA6IGAke3NlYXJjaFRleHR9ICR7Y2l0eU5hbWV9YDtcblxuICAgIGNvbnNvbGUubG9nKGBbc2VhcmNoV2l0aFN0cmF0ZWd5XSBVc2luZyAke3VzZUFsdGVybmF0ZVNlYXJjaCA/ICdhbHRlcm5hdGUnIDogJ29yaWdpbmFsJ30gc2VhcmNoOmAsIHF1ZXJ5KTtcbiAgICBcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0cnlTZWFyY2gocXVlcnksIGhlYWRlcnMsIGxvY2F0aW9uKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuXG5hc3luYyBmdW5jdGlvbiB0cnlTZWFyY2goXG4gICAgcXVlcnk6IHN0cmluZyxcbiAgICBoZWFkZXJzOiBhbnksXG4gICAgbG9jYXRpb246IHsgbGF0aXR1ZGU6IG51bWJlcjsgbG9uZ2l0dWRlOiBudW1iZXIgfVxuKTogUHJvbWlzZTxhbnk+IHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL3BsYWNlcy5nb29nbGVhcGlzLmNvbS92MS9wbGFjZXM6c2VhcmNoVGV4dCcsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVycyxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICB0ZXh0UXVlcnk6IHF1ZXJ5LFxuICAgICAgICAgICAgICAgIGxvY2F0aW9uQmlhczoge1xuICAgICAgICAgICAgICAgICAgICBjaXJjbGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlbnRlcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhdGl0dWRlOiBsb2NhdGlvbi5sYXRpdHVkZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb25naXR1ZGU6IGxvY2F0aW9uLmxvbmdpdHVkZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhZGl1czogMjAwMDAuMFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBtYXhSZXN1bHRDb3VudDogMVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignW3RyeVNlYXJjaF0gU2VhcmNoIGZhaWxlZDonLCB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgICAgICAgc3RhdHVzVGV4dDogcmVzcG9uc2Uuc3RhdHVzVGV4dCxcbiAgICAgICAgICAgICAgICBxdWVyeVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIGlmICghZGF0YS5wbGFjZXM/LlswXSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1t0cnlTZWFyY2hdIE5vIHBsYWNlcyBmb3VuZCBmb3IgcXVlcnk6JywgcXVlcnkpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zb2xlLmxvZygnW3RyeVNlYXJjaF0gRm91bmQgbmV3IHBsYWNlOicsIHtcbiAgICAgICAgICAgIGlkOiBkYXRhLnBsYWNlc1swXS5pZCxcbiAgICAgICAgICAgIG5hbWU6IGRhdGEucGxhY2VzWzBdLmRpc3BsYXlOYW1lPy50ZXh0IHx8IGRhdGEucGxhY2VzWzBdLm5hbWVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHsgcGxhY2VzOiBbZGF0YS5wbGFjZXNbMF1dIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignW3RyeVNlYXJjaF0gRXJyb3I6JywgZXJyb3IpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZWFyY2hQbGFjZUJ5VGV4dChcbiAgICBzZWFyY2hUZXh0OiBzdHJpbmcsXG4gICAgbG9jYXRpb246IHsgbGF0aXR1ZGU6IG51bWJlcjsgbG9uZ2l0dWRlOiBudW1iZXIgfSxcbiAgICBkZXN0aW5hdGlvbjogc3RyaW5nXG4pOiBQcm9taXNlPFBsYWNlIHwgbnVsbD4ge1xuICAgIGNvbnNvbGUubG9nKCdbc2VhcmNoUGxhY2VCeVRleHRdIFN0YXJ0aW5nIHNlYXJjaCB3aXRoOicsIHtcbiAgICAgICAgc2VhcmNoVGV4dCxcbiAgICAgICAgbG9jYXRpb24sXG4gICAgICAgIGRlc3RpbmF0aW9uXG4gICAgfSk7XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBjaXR5TmFtZSA9IGRlc3RpbmF0aW9uO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZWFyY2hXaXRoU3RyYXRlZ3koc2VhcmNoVGV4dCwgbG9jYXRpb24sIGNpdHlOYW1lLCBmYWxzZSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIXJlc3VsdD8ucGxhY2VzPy5bMF0pIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcGxhY2UgPSB0cmFuc2Zvcm1QbGFjZVJlc3BvbnNlKHJlc3VsdC5wbGFjZXNbMF0pO1xuICAgICAgICBpZiAoIXBsYWNlKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGlmIHBsYWNlIGlzIGFscmVhZHkgc2F2ZWQgdXNpbmcgc2F2ZWRQbGFjZXNNYW5hZ2VyXG4gICAgICAgIGNvbnN0IGlzQWxyZWFkeVNhdmVkID0gc2F2ZWRQbGFjZXNNYW5hZ2VyLmhhc1BsYWNlKHBsYWNlLmlkKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghaXNBbHJlYWR5U2F2ZWQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc2VhcmNoUGxhY2VCeVRleHRdIEFkZGluZyBuZXcgcGxhY2U6Jywge1xuICAgICAgICAgICAgICAgIGlkOiBwbGFjZS5pZCxcbiAgICAgICAgICAgICAgICBuYW1lOiBnZXREaXNwbGF5TmFtZShwbGFjZSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc2F2ZWRQbGFjZXNNYW5hZ2VyLmFkZFBsYWNlKHBsYWNlKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVXBkYXRlIG1ldHJpY3NcbiAgICAgICAgICAgIGNvbnN0IG1ldHJpY3MgPSBtZXRyaWNzTWFuYWdlci5nZXQoKTtcbiAgICAgICAgICAgIG1ldHJpY3Muc2F2ZWRQbGFjZXNDb3VudCA9IHNhdmVkUGxhY2VzTWFuYWdlci5wbGFjZXMuc2l6ZTtcbiAgICAgICAgICAgIG1ldHJpY3NNYW5hZ2VyLnVwZGF0ZShtZXRyaWNzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnNvbGUubG9nKCdbc2VhcmNoUGxhY2VCeVRleHRdIEZvdW5kIHBsYWNlOicsIHtcbiAgICAgICAgICAgIGlkOiBwbGFjZS5pZCxcbiAgICAgICAgICAgIG5hbWU6IGdldERpc3BsYXlOYW1lKHBsYWNlKSxcbiAgICAgICAgICAgIGlzQWxyZWFkeVNhdmVkXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBwbGFjZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbc2VhcmNoUGxhY2VCeVRleHRdIEVycm9yIHNlYXJjaGluZyBmb3IgcGxhY2U6JywgZXJyb3IpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG59XG5cbi8vIEluaXRpYWxpemUgbWV0cmljcyBpbiBzdG9yYWdlXG5mdW5jdGlvbiBpbml0aWFsaXplTWV0cmljcygpOiBVc2VySW50ZXJhY3Rpb25NZXRyaWNzIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRvdGFsUHJvbXB0czogMCxcbiAgICAgICAgICAgIHNhdmVkUGxhY2VzQ291bnQ6IDAsXG4gICAgICAgICAgICBpc1BhaWQ6IGZhbHNlLFxuICAgICAgICAgICAgc3RhZ2VQcm9tcHRzOiB7fSxcbiAgICAgICAgICAgIHBheW1lbnRSZWZlcmVuY2U6ICcnICAvLyBFbXB0eSBzdHJpbmcgaW5zdGVhZCBvZiBudWxsIHRvIG1hdGNoIHR5cGVcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBjb25zdCBtZXRyaWNzID0gZ2V0U3RvcmVkTWV0cmljcygpO1xuICAgIC8vIEFsd2F5cyBlbnN1cmUgc2F2ZWRQbGFjZXNDb3VudCBtYXRjaGVzIGFjdHVhbCBzYXZlZCBwbGFjZXNcbiAgICBtZXRyaWNzLnNhdmVkUGxhY2VzQ291bnQgPSBzYXZlZFBsYWNlc01hbmFnZXIucGxhY2VzLnNpemU7XG4gICAgcmV0dXJuIG1ldHJpY3M7XG59XG5cbi8vIFVwZGF0ZSBtZXRyaWNzIGluIHN0b3JhZ2VcbmZ1bmN0aW9uIHVwZGF0ZU1ldHJpY3MobWV0cmljczogVXNlckludGVyYWN0aW9uTWV0cmljcykge1xuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykgcmV0dXJuO1xuICAgIHRyeSB7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKE1FVFJJQ1NfU1RPUkFHRV9LRVksIEpTT04uc3RyaW5naWZ5KG1ldHJpY3MpKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbdXBkYXRlTWV0cmljc10gRXJyb3I6JywgZXJyb3IpO1xuICAgIH1cbn1cblxuLy8gRXhwb3J0IHRoZSBtZXRyaWNzIGZ1bmN0aW9uc1xuZXhwb3J0IGNvbnN0IG1ldHJpY3NNYW5hZ2VyID0ge1xuICAgIGdldDogaW5pdGlhbGl6ZU1ldHJpY3MsXG4gICAgdXBkYXRlOiB1cGRhdGVNZXRyaWNzXG59O1xuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gdHJhbnNmb3JtIEdvb2dsZSBQbGFjZXMgQVBJIHJlc3BvbnNlIHRvIG91ciBQbGFjZSB0eXBlXG5mdW5jdGlvbiB0cmFuc2Zvcm1QbGFjZVJlc3BvbnNlKHBsYWNlOiBHb29nbGVQbGFjZVJlc3BvbnNlKTogUGxhY2UgfCBudWxsIHtcbiAgICBpZiAoIXBsYWNlKSByZXR1cm4gbnVsbDtcblxuICAgIGNvbnNvbGUubG9nKCdbdHJhbnNmb3JtUGxhY2VSZXNwb25zZV0gSW5wdXQgcGxhY2U6Jywge1xuICAgICAgICBpZDogcGxhY2UuaWQsXG4gICAgICAgIHBob3RvczogcGxhY2UucGhvdG9zPy5tYXAocCA9PiAoeyBuYW1lOiBwLm5hbWUgfSkpLFxuICAgICAgICBwcmltYXJ5VHlwZURpc3BsYXlOYW1lOiBwbGFjZS5wcmltYXJ5VHlwZURpc3BsYXlOYW1lXG4gICAgfSk7XG5cbiAgICBjb25zdCBkaXNwbGF5TmFtZSA9IHBsYWNlLmRpc3BsYXlOYW1lPy50ZXh0IFxuICAgICAgICA/IHsgdGV4dDogcGxhY2UuZGlzcGxheU5hbWUudGV4dCwgbGFuZ3VhZ2VDb2RlOiBwbGFjZS5kaXNwbGF5TmFtZS5sYW5ndWFnZUNvZGUgfHwgJ2VuJyB9XG4gICAgICAgIDogcGxhY2UubmFtZSB8fCAnJztcblxuICAgIC8vIEVuc3VyZSBwaG90b3MgYXJyYXkgaXMgcHJvcGVybHkgZm9ybWF0dGVkXG4gICAgY29uc3QgcGhvdG9zID0gKHBsYWNlLnBob3RvcyB8fCBbXSlcbiAgICAgICAgLmZpbHRlcigocGhvdG8pOiBwaG90byBpcyBOb25OdWxsYWJsZTx0eXBlb2YgcGhvdG8+ID0+IFxuICAgICAgICAgICAgQm9vbGVhbihwaG90byAmJiBwaG90by5uYW1lKVxuICAgICAgICApXG4gICAgICAgIC5tYXAocGhvdG8gPT4gKHtcbiAgICAgICAgICAgIG5hbWU6IHBob3RvLm5hbWUsXG4gICAgICAgICAgICB3aWR0aFB4OiBwaG90by53aWR0aFB4LFxuICAgICAgICAgICAgaGVpZ2h0UHg6IHBob3RvLmhlaWdodFB4LFxuICAgICAgICAgICAgYXV0aG9yQXR0cmlidXRpb25zOiBwaG90by5hdXRob3JBdHRyaWJ1dGlvbnNcbiAgICAgICAgfSkpO1xuXG4gICAgY29uc3QgdHJhbnNmb3JtZWQgPSB7XG4gICAgICAgIGlkOiBwbGFjZS5pZCxcbiAgICAgICAgbmFtZTogcGxhY2UubmFtZSxcbiAgICAgICAgZGlzcGxheU5hbWUsXG4gICAgICAgIHByaW1hcnlUeXBlOiBwbGFjZS5wcmltYXJ5VHlwZSB8fCAncGxhY2UnLFxuICAgICAgICBwaG90b3MsXG4gICAgICAgIGZvcm1hdHRlZEFkZHJlc3M6IHBsYWNlLmZvcm1hdHRlZEFkZHJlc3MsXG4gICAgICAgIGxvY2F0aW9uOiBwbGFjZS5sb2NhdGlvbixcbiAgICAgICAgcHJpbWFyeVR5cGVEaXNwbGF5TmFtZTogcGxhY2UucHJpbWFyeVR5cGVEaXNwbGF5TmFtZSBcbiAgICAgICAgICAgID8geyB0ZXh0OiBwbGFjZS5wcmltYXJ5VHlwZURpc3BsYXlOYW1lLnRleHQsIGxhbmd1YWdlQ29kZTogcGxhY2UucHJpbWFyeVR5cGVEaXNwbGF5TmFtZS5sYW5ndWFnZUNvZGUgfHwgJ2VuJyB9XG4gICAgICAgICAgICA6IHVuZGVmaW5lZFxuICAgIH07XG5cbiAgICBjb25zb2xlLmxvZygnW3RyYW5zZm9ybVBsYWNlUmVzcG9uc2VdIFRyYW5zZm9ybWVkIHBsYWNlOicsIHtcbiAgICAgICAgaWQ6IHRyYW5zZm9ybWVkLmlkLFxuICAgICAgICBwaG90b3M6IHRyYW5zZm9ybWVkLnBob3Rvcy5tYXAocCA9PiAoeyBuYW1lOiBwLm5hbWUgfSkpLFxuICAgICAgICBwcmltYXJ5VHlwZURpc3BsYXlOYW1lOiB0cmFuc2Zvcm1lZC5wcmltYXJ5VHlwZURpc3BsYXlOYW1lXG4gICAgfSk7XG5cbiAgICByZXR1cm4gdHJhbnNmb3JtZWQ7XG59XG5cbmV4cG9ydCBjb25zdCBzZWFyY2hNdWx0aXBsZVBsYWNlc0J5VGV4dCA9IGFzeW5jIChcbiAgICBzZWFyY2hUZXh0OiBzdHJpbmcsXG4gICAgbG9jYXRpb246IHsgbGF0aXR1ZGU6IG51bWJlcjsgbG9uZ2l0dWRlOiBudW1iZXIgfSxcbiAgICBtYXhSZXN1bHRzOiBudW1iZXIgPSA1XG4pOiBQcm9taXNlPFBsYWNlW10+ID0+IHtcbiAgICB0cnkge1xuICAgICAgICBpZiAoIXByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0dPT0dMRV9NQVBTX0FQSV9LRVkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0dvb2dsZSBNYXBzIEFQSSBrZXkgaXMgbWlzc2luZycpO1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc29sZS5sb2coJ0V4ZWN1dGluZyBzZWFyY2hNdWx0aXBsZVBsYWNlc0J5VGV4dCB3aXRoIHBhcmFtczonLCB7XG4gICAgICAgICAgICBzZWFyY2hUZXh0LFxuICAgICAgICAgICAgbG9jYXRpb24sXG4gICAgICAgICAgICBtYXhSZXN1bHRzXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHJlcXVlc3RCb2R5ID0ge1xuICAgICAgICAgICAgdGV4dFF1ZXJ5OiBzZWFyY2hUZXh0LFxuICAgICAgICAgICAgbG9jYXRpb25CaWFzOiB7XG4gICAgICAgICAgICAgICAgY2lyY2xlOiB7XG4gICAgICAgICAgICAgICAgICAgIGNlbnRlcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGF0aXR1ZGU6IGxvY2F0aW9uLmxhdGl0dWRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbG9uZ2l0dWRlOiBsb2NhdGlvbi5sb25naXR1ZGVcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcmFkaXVzOiAyMDAwMC4wIC8vIDIwa20gcmFkaXVzXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG1heFJlc3VsdENvdW50OiBtYXhSZXN1bHRzXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgaGVhZGVycyA9IHtcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAnWC1Hb29nLUFwaS1LZXknOiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19HT09HTEVfTUFQU19BUElfS0VZLFxuICAgICAgICAgICAgJ1gtR29vZy1GaWVsZE1hc2snOiAncGxhY2VzLmlkLHBsYWNlcy5kaXNwbGF5TmFtZSxwbGFjZXMuZm9ybWF0dGVkQWRkcmVzcyxwbGFjZXMubG9jYXRpb24scGxhY2VzLnByaW1hcnlUeXBlLHBsYWNlcy5wcmltYXJ5VHlwZURpc3BsYXlOYW1lLHBsYWNlcy5waG90b3MubmFtZSxwbGFjZXMucGhvdG9zLndpZHRoUHgscGxhY2VzLnBob3Rvcy5oZWlnaHRQeCdcbiAgICAgICAgfSBhcyBjb25zdDtcblxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL3BsYWNlcy5nb29nbGVhcGlzLmNvbS92MS9wbGFjZXM6c2VhcmNoVGV4dCcsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVycyxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHJlcXVlc3RCb2R5KVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2VhcmNoIHBsYWNlczonLCB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgICAgICAgc3RhdHVzVGV4dDogcmVzcG9uc2Uuc3RhdHVzVGV4dCxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3JEYXRhXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWRhdGEucGxhY2VzIHx8ICFBcnJheS5pc0FycmF5KGRhdGEucGxhY2VzKSB8fCBkYXRhLnBsYWNlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdObyBwbGFjZXMgZm91bmQgZm9yIHRleHQgc2VhcmNoOicsIHNlYXJjaFRleHQpO1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGRhdGEucGxhY2VzLm1hcCgocGxhY2U6IGFueSkgPT4gKHtcbiAgICAgICAgICAgIGlkOiBwbGFjZS5pZCxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBwbGFjZS5kaXNwbGF5TmFtZT8udGV4dCA/IHtcbiAgICAgICAgICAgICAgICB0ZXh0OiBwbGFjZS5kaXNwbGF5TmFtZS50ZXh0LFxuICAgICAgICAgICAgICAgIGxhbmd1YWdlQ29kZTogcGxhY2UuZGlzcGxheU5hbWUubGFuZ3VhZ2VDb2RlIHx8ICdlbidcbiAgICAgICAgICAgIH0gOiBwbGFjZS5kaXNwbGF5TmFtZSxcbiAgICAgICAgICAgIHByaW1hcnlUeXBlOiBwbGFjZS5wcmltYXJ5VHlwZSB8fCAncGxhY2UnLFxuICAgICAgICAgICAgcGhvdG9zOiBwbGFjZS5waG90b3M/Lm1hcCgocGhvdG86IGFueSkgPT4gKHsgXG4gICAgICAgICAgICAgICAgbmFtZTogcGhvdG8ubmFtZSxcbiAgICAgICAgICAgICAgICB3aWR0aFB4OiBwaG90by53aWR0aFB4LFxuICAgICAgICAgICAgICAgIGhlaWdodFB4OiBwaG90by5oZWlnaHRQeFxuICAgICAgICAgICAgfSkpIHx8IFtdLFxuICAgICAgICAgICAgZm9ybWF0dGVkQWRkcmVzczogcGxhY2UuZm9ybWF0dGVkQWRkcmVzcyxcbiAgICAgICAgICAgIGxvY2F0aW9uOiBwbGFjZS5sb2NhdGlvbixcbiAgICAgICAgICAgIHByaW1hcnlUeXBlRGlzcGxheU5hbWU6IHBsYWNlLnByaW1hcnlUeXBlRGlzcGxheU5hbWUgPyB7XG4gICAgICAgICAgICAgICAgdGV4dDogcGxhY2UucHJpbWFyeVR5cGVEaXNwbGF5TmFtZS50ZXh0LFxuICAgICAgICAgICAgICAgIGxhbmd1YWdlQ29kZTogcGxhY2UucHJpbWFyeVR5cGVEaXNwbGF5TmFtZS5sYW5ndWFnZUNvZGUgfHwgJ2VuJ1xuICAgICAgICAgICAgfSA6IHVuZGVmaW5lZFxuICAgICAgICB9KSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igc2VhcmNoaW5nIGZvciBwbGFjZXM6JywgZXJyb3IpO1xuICAgICAgICByZXR1cm4gW107XG4gICAgfVxufTtcblxuLy8gRmV0Y2ggcGxhY2VzIGZyb20gR29vZ2xlIFBsYWNlcyBBUElcbmV4cG9ydCBjb25zdCBmZXRjaFBsYWNlcyA9IGFzeW5jIChcbiAgICBsYXRpdHVkZTogbnVtYmVyLFxuICAgIGxvbmdpdHVkZTogbnVtYmVyLFxuICAgIHByZWZlcmVuY2VzPzogVHJhdmVsUHJlZmVyZW5jZVtdLFxuICAgIG1heFJlc3VsdHM6IG51bWJlciA9IDUsXG4gICAgcGxhY2VUeXBlcz86IHN0cmluZ1tdXG4pOiBQcm9taXNlPFBsYWNlW10+ID0+IHtcbiAgICB0cnkge1xuICAgICAgICBpZiAoIXByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0dPT0dMRV9NQVBTX0FQSV9LRVkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0dvb2dsZSBNYXBzIEFQSSBrZXkgaXMgbWlzc2luZycpO1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZnJvbVByZWZlcmVuY2VzID0gISFwcmVmZXJlbmNlcyAmJiBwcmVmZXJlbmNlcy5sZW5ndGggPiAwO1xuICAgICAgICBjb25zdCBmcm9tUGxhY2VUeXBlcyA9ICEhcGxhY2VUeXBlcyAmJiBwbGFjZVR5cGVzLmxlbmd0aCA+IDA7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWZyb21QcmVmZXJlbmNlcyAmJiAhZnJvbVBsYWNlVHlwZXMpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ05vIHByZWZlcmVuY2VzIG9yIHBsYWNlIHR5cGVzIHByb3ZpZGVkJyk7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cblxuICAgICAgICAvLyBVc2UgcHJlZmVyZW5jZXMgaWYgcHJvdmlkZWQsIG90aGVyd2lzZSB1c2UgcGxhY2VUeXBlcywgb3RoZXJ3aXNlIHVzZSBkZWZhdWx0c1xuICAgICAgICBsZXQgaW5jbHVkZWRUeXBlczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgaWYgKGZyb21QcmVmZXJlbmNlcykge1xuICAgICAgICAgICAgaW5jbHVkZWRUeXBlcyA9IGdldFBsYWNlVHlwZXNGcm9tUHJlZmVyZW5jZXMocHJlZmVyZW5jZXMhKTtcbiAgICAgICAgfSBlbHNlIGlmIChmcm9tUGxhY2VUeXBlcykge1xuICAgICAgICAgICAgaW5jbHVkZWRUeXBlcyA9IHBsYWNlVHlwZXMhO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc29sZS5sb2coJ0V4ZWN1dGluZyBmZXRjaHBsYWNlcyB3aXRoIHBhcmFtczonLCB7XG4gICAgICAgICAgICBsYXRpdHVkZSxcbiAgICAgICAgICAgIGxvbmdpdHVkZSxcbiAgICAgICAgICAgIGluY2x1ZGVkVHlwZXMsXG4gICAgICAgICAgICBtYXhSZXN1bHRzLFxuICAgICAgICAgICAgZnJvbVByZWZlcmVuY2VzOiAhIXByZWZlcmVuY2VzPy5sZW5ndGgsXG4gICAgICAgICAgICBmcm9tUGxhY2VUeXBlczogISFwbGFjZVR5cGVzPy5sZW5ndGhcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gRmlyc3QgdHJ5IG5lYXJieSBzZWFyY2hcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RCb2R5ID0ge1xuICAgICAgICAgICAgICAgIGluY2x1ZGVkVHlwZXMsXG4gICAgICAgICAgICAgICAgbWF4UmVzdWx0Q291bnQ6IG1heFJlc3VsdHMsXG4gICAgICAgICAgICAgICAgbG9jYXRpb25SZXN0cmljdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICBjaXJjbGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlbnRlcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhdGl0dWRlOiBsYXRpdHVkZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb25naXR1ZGU6IGxvbmdpdHVkZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhZGl1czogMjAwMDAuMCAvLyAyMGttIHJhZGl1c1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29uc3QgaGVhZGVycyA9IHtcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgICAgICdYLUdvb2ctQXBpLUtleSc6IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0dPT0dMRV9NQVBTX0FQSV9LRVksXG4gICAgICAgICAgICAgICAgJ1gtR29vZy1GaWVsZE1hc2snOiAncGxhY2VzLmlkLHBsYWNlcy5kaXNwbGF5TmFtZSxwbGFjZXMuZm9ybWF0dGVkQWRkcmVzcyxwbGFjZXMubG9jYXRpb24scGxhY2VzLnByaW1hcnlUeXBlLHBsYWNlcy5wcmltYXJ5VHlwZURpc3BsYXlOYW1lLHBsYWNlcy5waG90b3MubmFtZSxwbGFjZXMucGhvdG9zLndpZHRoUHgscGxhY2VzLnBob3Rvcy5oZWlnaHRQeCdcbiAgICAgICAgICAgIH0gYXMgY29uc3Q7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vcGxhY2VzLmdvb2dsZWFwaXMuY29tL3YxL3BsYWNlczpzZWFyY2hOZWFyYnknLCB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgaGVhZGVycyxcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShyZXF1ZXN0Qm9keSlcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLnBsYWNlcyAmJiBBcnJheS5pc0FycmF5KGRhdGEucGxhY2VzKSAmJiBkYXRhLnBsYWNlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLnBsYWNlcy5tYXAoKHBsYWNlOiBhbnkpID0+ICh7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogcGxhY2UuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogcGxhY2UuZGlzcGxheU5hbWU/LnRleHQgPyB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogcGxhY2UuZGlzcGxheU5hbWUudGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZUNvZGU6IHBsYWNlLmRpc3BsYXlOYW1lLmxhbmd1YWdlQ29kZSB8fCAnZW4nXG4gICAgICAgICAgICAgICAgICAgICAgICB9IDogcGxhY2UuZGlzcGxheU5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmltYXJ5VHlwZTogcGxhY2UucHJpbWFyeVR5cGUgfHwgJ3BsYWNlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBob3RvczogcGxhY2UucGhvdG9zPy5tYXAoKHBob3RvOiBhbnkpID0+ICh7IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHBob3RvLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGhQeDogcGhvdG8ud2lkdGhQeCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHRQeDogcGhvdG8uaGVpZ2h0UHhcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKSB8fCBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlZEFkZHJlc3M6IHBsYWNlLmZvcm1hdHRlZEFkZHJlc3MsXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbjogcGxhY2UubG9jYXRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmltYXJ5VHlwZURpc3BsYXlOYW1lOiBwbGFjZS5wcmltYXJ5VHlwZURpc3BsYXlOYW1lID8ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHBsYWNlLnByaW1hcnlUeXBlRGlzcGxheU5hbWUudGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZUNvZGU6IHBsYWNlLnByaW1hcnlUeXBlRGlzcGxheU5hbWUubGFuZ3VhZ2VDb2RlIHx8ICdlbidcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGZldGNoIHBsYWNlczonLCB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgICAgICAgc3RhdHVzVGV4dDogcmVzcG9uc2Uuc3RhdHVzVGV4dCxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3JEYXRhXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIG5lYXJieSBzZWFyY2g6JywgZXJyb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSWYgbmVhcmJ5IHNlYXJjaCBmYWlscywgdHJ5IHRleHQgc2VhcmNoIGFzIGZhbGxiYWNrXG4gICAgICAgIGNvbnNvbGUubG9nKCdGYWxsaW5nIGJhY2sgdG8gdGV4dCBzZWFyY2guLi4nKTtcbiAgICAgICAgY29uc3Qgc2VhcmNoUXVlcnkgPSBmcm9tUGxhY2VUeXBlcyA/IHBsYWNlVHlwZXMhWzBdIDogcHJlZmVyZW5jZXMhWzBdO1xuICAgICAgICByZXR1cm4gYXdhaXQgc2VhcmNoTXVsdGlwbGVQbGFjZXNCeVRleHQoc2VhcmNoUXVlcnksIHsgbGF0aXR1ZGUsIGxvbmdpdHVkZSB9LCBtYXhSZXN1bHRzKTtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHBsYWNlczonLCBlcnJvcik7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG59OyJdLCJuYW1lcyI6WyJUcmF2ZWxQcmVmZXJlbmNlIiwiTUVUUklDU19TVE9SQUdFX0tFWSIsImdldFN0b3JlZE1ldHJpY3MiLCJwcmVmZXJlbmNlVG9QbGFjZVR5cGVzIiwiQ3VsdHVyZSIsIk5hdHVyZSIsIkZvb2QiLCJSZWxheGF0aW9uIiwiQWR2ZW50dXJlIiwiU2hvcHBpbmciLCJnZXRQbGFjZVR5cGVzRnJvbVByZWZlcmVuY2VzIiwicHJlZmVyZW5jZXMiLCJ1c2VkVHlwZXMiLCJTZXQiLCJyZXN1bHRUeXBlcyIsImZvckVhY2giLCJwcmVmIiwiYXZhaWxhYmxlVHlwZXMiLCJmaWx0ZXIiLCJ0eXBlIiwiaGFzIiwibnVtVHlwZXMiLCJNYXRoIiwibWluIiwiZmxvb3IiLCJyYW5kb20iLCJsZW5ndGgiLCJzZWxlY3RlZFR5cGVzIiwic29ydCIsInNsaWNlIiwicHVzaCIsImFkZCIsImVycm9yIiwiY29uc29sZSIsImZvcm1hdFByaW1hcnlUeXBlIiwic3BsaXQiLCJtYXAiLCJ3b3JkIiwiY2hhckF0IiwidG9VcHBlckNhc2UiLCJqb2luIiwiZ2V0RGlzcGxheU5hbWUiLCJwbGFjZSIsImRpc3BsYXlOYW1lIiwidGV4dCIsIm5hbWUiLCJmaWx0ZXJVbmlxdWVQbGFjZXMiLCJwbGFjZXMiLCJBcnJheSIsImlzQXJyYXkiLCJzYXZlZFBsYWNlcyIsInNhdmVkUGxhY2VzTWFuYWdlciIsImdldFBsYWNlcyIsInNhdmVkUGxhY2VJZHMiLCJpZCIsInNhdmVkUGxhY2VOYW1lcyIsInRvTG93ZXJDYXNlIiwicGxhY2VOYW1lIiwiU1RPUkFHRV9LRVkiLCJjcmVhdGVTYXZlZFBsYWNlc01hbmFnZXIiLCJNYXAiLCJpbml0aWFsaXplZCIsImxvYWRGcm9tU3RvcmFnZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJsb2ciLCJwYXJzZWRQbGFjZXMiLCJKU09OIiwicGFyc2UiLCJjbGVhciIsImhhc1Bob3RvcyIsIkJvb2xlYW4iLCJwaG90b3MiLCJwaG90b0NvdW50IiwiZmlyc3RQaG90byIsInNldCIsImFkZFBsYWNlIiwiX3BlcnNpc3QiLCJfbm90aWZ5Q2hhbmdlIiwicmVtb3ZlUGxhY2UiLCJkZWxldGUiLCJmcm9tIiwidmFsdWVzIiwiaGFzUGxhY2UiLCJwbGFjZXNBcnJheSIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJtZXRyaWNzIiwibWV0cmljc01hbmFnZXIiLCJnZXQiLCJzYXZlZFBsYWNlc0NvdW50Iiwic2l6ZSIsInVwZGF0ZSIsIndpbmRvdyIsImdldFNhdmVkUGxhY2VzIiwic2VyaWFsaXplIiwic2VhcmNoV2l0aFN0cmF0ZWd5Iiwic2VhcmNoVGV4dCIsImxvY2F0aW9uIiwiY2l0eU5hbWUiLCJ1c2VBbHRlcm5hdGVTZWFyY2giLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfR09PR0xFX01BUFNfQVBJX0tFWSIsIkVycm9yIiwiaGVhZGVycyIsInF1ZXJ5IiwicmVzdWx0IiwidHJ5U2VhcmNoIiwicmVzcG9uc2UiLCJmZXRjaCIsIm1ldGhvZCIsImJvZHkiLCJ0ZXh0UXVlcnkiLCJsb2NhdGlvbkJpYXMiLCJjaXJjbGUiLCJjZW50ZXIiLCJsYXRpdHVkZSIsImxvbmdpdHVkZSIsInJhZGl1cyIsIm1heFJlc3VsdENvdW50Iiwib2siLCJzdGF0dXMiLCJzdGF0dXNUZXh0IiwiZGF0YSIsImpzb24iLCJzZWFyY2hQbGFjZUJ5VGV4dCIsImRlc3RpbmF0aW9uIiwidHJhbnNmb3JtUGxhY2VSZXNwb25zZSIsImlzQWxyZWFkeVNhdmVkIiwiaW5pdGlhbGl6ZU1ldHJpY3MiLCJ0b3RhbFByb21wdHMiLCJpc1BhaWQiLCJzdGFnZVByb21wdHMiLCJwYXltZW50UmVmZXJlbmNlIiwidXBkYXRlTWV0cmljcyIsInAiLCJwcmltYXJ5VHlwZURpc3BsYXlOYW1lIiwibGFuZ3VhZ2VDb2RlIiwicGhvdG8iLCJ3aWR0aFB4IiwiaGVpZ2h0UHgiLCJhdXRob3JBdHRyaWJ1dGlvbnMiLCJ0cmFuc2Zvcm1lZCIsInByaW1hcnlUeXBlIiwiZm9ybWF0dGVkQWRkcmVzcyIsInVuZGVmaW5lZCIsInNlYXJjaE11bHRpcGxlUGxhY2VzQnlUZXh0IiwibWF4UmVzdWx0cyIsInJlcXVlc3RCb2R5IiwiZXJyb3JEYXRhIiwiZmV0Y2hQbGFjZXMiLCJwbGFjZVR5cGVzIiwiZnJvbVByZWZlcmVuY2VzIiwiZnJvbVBsYWNlVHlwZXMiLCJpbmNsdWRlZFR5cGVzIiwibG9jYXRpb25SZXN0cmljdGlvbiIsInNlYXJjaFF1ZXJ5Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./utils/places-utils.ts\n");

/***/ }),

/***/ "./utils/session-manager.ts":
/*!**********************************!*\
  !*** ./utils/session-manager.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkSessionValidity: () => (/* binding */ checkSessionValidity),\n/* harmony export */   checkSessionWithWarning: () => (/* binding */ checkSessionWithWarning),\n/* harmony export */   clearSession: () => (/* binding */ clearSession),\n/* harmony export */   getStoredMetricsWithSession: () => (/* binding */ getStoredMetricsWithSession),\n/* harmony export */   handleSessionExpiry: () => (/* binding */ handleSessionExpiry),\n/* harmony export */   initializeSession: () => (/* binding */ initializeSession),\n/* harmony export */   updateLastActive: () => (/* binding */ updateLastActive)\n/* harmony export */ });\nconst SESSION_CONFIG = {\n    INACTIVITY_TIMEOUT: 2 * 60 * 60 * 1000,\n    ABSOLUTE_TIMEOUT: 24 * 60 * 60 * 1000,\n    WARNING_BEFORE_TIMEOUT: 5 * 60 * 1000,\n    STORAGE_KEYS: {\n        SESSION: \"travel_session\",\n        METRICS: \"travel_interaction_metrics\"\n    }\n};\nfunction initializeSession() {\n    const now = Date.now();\n    const session = {\n        sessionId: generateSessionId(),\n        startTime: now,\n        lastActive: now,\n        expiresAt: now + SESSION_CONFIG.ABSOLUTE_TIMEOUT\n    };\n    localStorage.setItem(SESSION_CONFIG.STORAGE_KEYS.SESSION, JSON.stringify(session));\n    return session;\n}\n// Add warning mechanism\nfunction checkSessionWithWarning() {\n    const sessionData = localStorage.getItem(SESSION_CONFIG.STORAGE_KEYS.SESSION);\n    if (!sessionData) return {\n        isValid: false,\n        shouldWarn: false\n    };\n    try {\n        const session = JSON.parse(sessionData);\n        const now = Date.now();\n        const timeUntilInactivity = session.lastActive + SESSION_CONFIG.INACTIVITY_TIMEOUT - now;\n        // Check if we should show warning\n        if (timeUntilInactivity > 0 && timeUntilInactivity <= SESSION_CONFIG.WARNING_BEFORE_TIMEOUT) {\n            return {\n                isValid: true,\n                shouldWarn: true\n            };\n        }\n        // Regular validity check\n        if (now >= session.expiresAt || now - session.lastActive >= SESSION_CONFIG.INACTIVITY_TIMEOUT) {\n            return {\n                isValid: false,\n                shouldWarn: false\n            };\n        }\n        return {\n            isValid: true,\n            shouldWarn: false\n        };\n    } catch (error) {\n        console.error(\"[SessionManager] Error checking session:\", error);\n        return {\n            isValid: false,\n            shouldWarn: false\n        };\n    }\n}\nfunction checkSessionValidity() {\n    const sessionData = localStorage.getItem(SESSION_CONFIG.STORAGE_KEYS.SESSION);\n    if (!sessionData) return false;\n    try {\n        const session = JSON.parse(sessionData);\n        const now = Date.now();\n        // Check absolute timeout\n        if (now >= session.expiresAt) {\n            clearSession();\n            return false;\n        }\n        // Check inactivity timeout\n        if (now - session.lastActive >= SESSION_CONFIG.INACTIVITY_TIMEOUT) {\n            clearSession();\n            return false;\n        }\n        // Update last active timestamp\n        session.lastActive = now;\n        localStorage.setItem(SESSION_CONFIG.STORAGE_KEYS.SESSION, JSON.stringify(session));\n        return true;\n    } catch (error) {\n        console.error(\"[SessionManager] Error parsing session:\", error);\n        clearSession();\n        return false;\n    }\n}\n// ession expiry handler\nfunction handleSessionExpiry() {\n    // Save current state if needed\n    const currentState = {\n        messages: window.getSavedPlaces?.() || [],\n        lastUrl: window.location.pathname\n    };\n    localStorage.setItem(\"expiredSessionState\", JSON.stringify(currentState));\n    // Clear session\n    clearSession();\n    // Redirect to landing page with return path\n    window.location.href = `/?return=${encodeURIComponent(currentState.lastUrl)}`;\n}\nfunction clearSession() {\n    localStorage.removeItem(SESSION_CONFIG.STORAGE_KEYS.SESSION);\n    localStorage.removeItem(SESSION_CONFIG.STORAGE_KEYS.METRICS);\n}\nfunction updateLastActive() {\n    const sessionData = localStorage.getItem(SESSION_CONFIG.STORAGE_KEYS.SESSION);\n    if (!sessionData) return;\n    try {\n        const session = JSON.parse(sessionData);\n        session.lastActive = Date.now();\n        localStorage.setItem(SESSION_CONFIG.STORAGE_KEYS.SESSION, JSON.stringify(session));\n    } catch (error) {\n        console.error(\"[SessionManager] Error updating last active:\", error);\n    }\n}\nfunction generateSessionId() {\n    return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n}\n// Hook this into metrics management\nfunction getStoredMetricsWithSession() {\n    if (!checkSessionValidity()) {\n        clearSession();\n        return null;\n    }\n    const metricsData = localStorage.getItem(SESSION_CONFIG.STORAGE_KEYS.METRICS);\n    if (!metricsData) return null;\n    try {\n        return JSON.parse(metricsData);\n    } catch (error) {\n        console.error(\"[SessionManager] Error parsing metrics:\", error);\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUFDekQsT0FBTztJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cmF2ZWwtcml6ei8uL3V0aWxzL3Nlc3Npb24tbWFuYWdlci50cz8xMzNmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFVzZXJJbnRlcmFjdGlvbk1ldHJpY3MgfSBmcm9tICcuLi9tYW5hZ2Vycy9zdGFnZS1tYW5hZ2VyJztcblxuY29uc3QgU0VTU0lPTl9DT05GSUcgPSB7XG4gIElOQUNUSVZJVFlfVElNRU9VVDogMiAqIDYwICogNjAgKiAxMDAwLCAvLyAyIGhvdXJzXG4gIEFCU09MVVRFX1RJTUVPVVQ6IDI0ICogNjAgKiA2MCAqIDEwMDAsIC8vIGtlZXAgMjQgaG91cnNcbiAgV0FSTklOR19CRUZPUkVfVElNRU9VVDogNSAqIDYwICogMTAwMCwgLy8gNSBtaW51dGVzIHdhcm5pbmdcbiAgU1RPUkFHRV9LRVlTOiB7XG4gICAgU0VTU0lPTjogJ3RyYXZlbF9zZXNzaW9uJyxcbiAgICBNRVRSSUNTOiAndHJhdmVsX2ludGVyYWN0aW9uX21ldHJpY3MnXG4gIH1cbn07XG5cblxuXG5pbnRlcmZhY2UgU2Vzc2lvbk1ldGFkYXRhIHtcbiAgc2Vzc2lvbklkOiBzdHJpbmc7XG4gIHN0YXJ0VGltZTogbnVtYmVyO1xuICBsYXN0QWN0aXZlOiBudW1iZXI7XG4gIGV4cGlyZXNBdDogbnVtYmVyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaW5pdGlhbGl6ZVNlc3Npb24oKTogU2Vzc2lvbk1ldGFkYXRhIHtcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgY29uc3Qgc2Vzc2lvbjogU2Vzc2lvbk1ldGFkYXRhID0ge1xuICAgIHNlc3Npb25JZDogZ2VuZXJhdGVTZXNzaW9uSWQoKSxcbiAgICBzdGFydFRpbWU6IG5vdyxcbiAgICBsYXN0QWN0aXZlOiBub3csXG4gICAgZXhwaXJlc0F0OiBub3cgKyBTRVNTSU9OX0NPTkZJRy5BQlNPTFVURV9USU1FT1VUXG4gIH07XG4gIFxuICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShTRVNTSU9OX0NPTkZJRy5TVE9SQUdFX0tFWVMuU0VTU0lPTiwgSlNPTi5zdHJpbmdpZnkoc2Vzc2lvbikpO1xuICByZXR1cm4gc2Vzc2lvbjtcbn1cblxuLy8gQWRkIHdhcm5pbmcgbWVjaGFuaXNtXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tTZXNzaW9uV2l0aFdhcm5pbmcoKTogeyBpc1ZhbGlkOiBib29sZWFuOyBzaG91bGRXYXJuOiBib29sZWFuIH0ge1xuICBjb25zdCBzZXNzaW9uRGF0YSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFNFU1NJT05fQ09ORklHLlNUT1JBR0VfS0VZUy5TRVNTSU9OKTtcbiAgaWYgKCFzZXNzaW9uRGF0YSkgcmV0dXJuIHsgaXNWYWxpZDogZmFsc2UsIHNob3VsZFdhcm46IGZhbHNlIH07XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBzZXNzaW9uOiBTZXNzaW9uTWV0YWRhdGEgPSBKU09OLnBhcnNlKHNlc3Npb25EYXRhKTtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IHRpbWVVbnRpbEluYWN0aXZpdHkgPSAoc2Vzc2lvbi5sYXN0QWN0aXZlICsgU0VTU0lPTl9DT05GSUcuSU5BQ1RJVklUWV9USU1FT1VUKSAtIG5vdztcbiAgICBcbiAgICAvLyBDaGVjayBpZiB3ZSBzaG91bGQgc2hvdyB3YXJuaW5nXG4gICAgaWYgKHRpbWVVbnRpbEluYWN0aXZpdHkgPiAwICYmIHRpbWVVbnRpbEluYWN0aXZpdHkgPD0gU0VTU0lPTl9DT05GSUcuV0FSTklOR19CRUZPUkVfVElNRU9VVCkge1xuICAgICAgcmV0dXJuIHsgaXNWYWxpZDogdHJ1ZSwgc2hvdWxkV2FybjogdHJ1ZSB9O1xuICAgIH1cblxuICAgIC8vIFJlZ3VsYXIgdmFsaWRpdHkgY2hlY2tcbiAgICBpZiAobm93ID49IHNlc3Npb24uZXhwaXJlc0F0IHx8IG5vdyAtIHNlc3Npb24ubGFzdEFjdGl2ZSA+PSBTRVNTSU9OX0NPTkZJRy5JTkFDVElWSVRZX1RJTUVPVVQpIHtcbiAgICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBzaG91bGRXYXJuOiBmYWxzZSB9O1xuICAgIH1cblxuICAgIHJldHVybiB7IGlzVmFsaWQ6IHRydWUsIHNob3VsZFdhcm46IGZhbHNlIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW1Nlc3Npb25NYW5hZ2VyXSBFcnJvciBjaGVja2luZyBzZXNzaW9uOicsIGVycm9yKTtcbiAgICByZXR1cm4geyBpc1ZhbGlkOiBmYWxzZSwgc2hvdWxkV2FybjogZmFsc2UgfTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tTZXNzaW9uVmFsaWRpdHkoKTogYm9vbGVhbiB7XG4gIGNvbnN0IHNlc3Npb25EYXRhID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oU0VTU0lPTl9DT05GSUcuU1RPUkFHRV9LRVlTLlNFU1NJT04pO1xuICBpZiAoIXNlc3Npb25EYXRhKSByZXR1cm4gZmFsc2U7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBzZXNzaW9uOiBTZXNzaW9uTWV0YWRhdGEgPSBKU09OLnBhcnNlKHNlc3Npb25EYXRhKTtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuXG4gICAgLy8gQ2hlY2sgYWJzb2x1dGUgdGltZW91dFxuICAgIGlmIChub3cgPj0gc2Vzc2lvbi5leHBpcmVzQXQpIHtcbiAgICAgIGNsZWFyU2Vzc2lvbigpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGluYWN0aXZpdHkgdGltZW91dFxuICAgIGlmIChub3cgLSBzZXNzaW9uLmxhc3RBY3RpdmUgPj0gU0VTU0lPTl9DT05GSUcuSU5BQ1RJVklUWV9USU1FT1VUKSB7XG4gICAgICBjbGVhclNlc3Npb24oKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgbGFzdCBhY3RpdmUgdGltZXN0YW1wXG4gICAgc2Vzc2lvbi5sYXN0QWN0aXZlID0gbm93O1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFNFU1NJT05fQ09ORklHLlNUT1JBR0VfS0VZUy5TRVNTSU9OLCBKU09OLnN0cmluZ2lmeShzZXNzaW9uKSk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW1Nlc3Npb25NYW5hZ2VyXSBFcnJvciBwYXJzaW5nIHNlc3Npb246JywgZXJyb3IpO1xuICAgIGNsZWFyU2Vzc2lvbigpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vLyBlc3Npb24gZXhwaXJ5IGhhbmRsZXJcbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVTZXNzaW9uRXhwaXJ5KCkge1xuICAvLyBTYXZlIGN1cnJlbnQgc3RhdGUgaWYgbmVlZGVkXG4gIGNvbnN0IGN1cnJlbnRTdGF0ZSA9IHtcbiAgICBtZXNzYWdlczogd2luZG93LmdldFNhdmVkUGxhY2VzPy4oKSB8fCBbXSxcbiAgICBsYXN0VXJsOiB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWVcbiAgfTtcbiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2V4cGlyZWRTZXNzaW9uU3RhdGUnLCBKU09OLnN0cmluZ2lmeShjdXJyZW50U3RhdGUpKTtcbiAgXG4gIC8vIENsZWFyIHNlc3Npb25cbiAgY2xlYXJTZXNzaW9uKCk7XG4gIFxuICAvLyBSZWRpcmVjdCB0byBsYW5kaW5nIHBhZ2Ugd2l0aCByZXR1cm4gcGF0aFxuICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGAvP3JldHVybj0ke2VuY29kZVVSSUNvbXBvbmVudChjdXJyZW50U3RhdGUubGFzdFVybCl9YDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyU2Vzc2lvbigpIHtcbiAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oU0VTU0lPTl9DT05GSUcuU1RPUkFHRV9LRVlTLlNFU1NJT04pO1xuICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShTRVNTSU9OX0NPTkZJRy5TVE9SQUdFX0tFWVMuTUVUUklDUyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVMYXN0QWN0aXZlKCkge1xuICBjb25zdCBzZXNzaW9uRGF0YSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFNFU1NJT05fQ09ORklHLlNUT1JBR0VfS0VZUy5TRVNTSU9OKTtcbiAgaWYgKCFzZXNzaW9uRGF0YSkgcmV0dXJuO1xuXG4gIHRyeSB7XG4gICAgY29uc3Qgc2Vzc2lvbjogU2Vzc2lvbk1ldGFkYXRhID0gSlNPTi5wYXJzZShzZXNzaW9uRGF0YSk7XG4gICAgc2Vzc2lvbi5sYXN0QWN0aXZlID0gRGF0ZS5ub3coKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShTRVNTSU9OX0NPTkZJRy5TVE9SQUdFX0tFWVMuU0VTU0lPTiwgSlNPTi5zdHJpbmdpZnkoc2Vzc2lvbikpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tTZXNzaW9uTWFuYWdlcl0gRXJyb3IgdXBkYXRpbmcgbGFzdCBhY3RpdmU6JywgZXJyb3IpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlU2Vzc2lvbklkKCk6IHN0cmluZyB7XG4gIHJldHVybiBgJHtEYXRlLm5vdygpfS0ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KX1gO1xufVxuXG4vLyBIb29rIHRoaXMgaW50byBtZXRyaWNzIG1hbmFnZW1lbnRcbmV4cG9ydCBmdW5jdGlvbiBnZXRTdG9yZWRNZXRyaWNzV2l0aFNlc3Npb24oKTogVXNlckludGVyYWN0aW9uTWV0cmljcyB8IG51bGwge1xuICBpZiAoIWNoZWNrU2Vzc2lvblZhbGlkaXR5KCkpIHtcbiAgICBjbGVhclNlc3Npb24oKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGNvbnN0IG1ldHJpY3NEYXRhID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oU0VTU0lPTl9DT05GSUcuU1RPUkFHRV9LRVlTLk1FVFJJQ1MpO1xuICBpZiAoIW1ldHJpY3NEYXRhKSByZXR1cm4gbnVsbDtcblxuICB0cnkge1xuICAgIHJldHVybiBKU09OLnBhcnNlKG1ldHJpY3NEYXRhKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbU2Vzc2lvbk1hbmFnZXJdIEVycm9yIHBhcnNpbmcgbWV0cmljczonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJTRVNTSU9OX0NPTkZJRyIsIklOQUNUSVZJVFlfVElNRU9VVCIsIkFCU09MVVRFX1RJTUVPVVQiLCJXQVJOSU5HX0JFRk9SRV9USU1FT1VUIiwiU1RPUkFHRV9LRVlTIiwiU0VTU0lPTiIsIk1FVFJJQ1MiLCJpbml0aWFsaXplU2Vzc2lvbiIsIm5vdyIsIkRhdGUiLCJzZXNzaW9uIiwic2Vzc2lvbklkIiwiZ2VuZXJhdGVTZXNzaW9uSWQiLCJzdGFydFRpbWUiLCJsYXN0QWN0aXZlIiwiZXhwaXJlc0F0IiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJjaGVja1Nlc3Npb25XaXRoV2FybmluZyIsInNlc3Npb25EYXRhIiwiZ2V0SXRlbSIsImlzVmFsaWQiLCJzaG91bGRXYXJuIiwicGFyc2UiLCJ0aW1lVW50aWxJbmFjdGl2aXR5IiwiZXJyb3IiLCJjb25zb2xlIiwiY2hlY2tTZXNzaW9uVmFsaWRpdHkiLCJjbGVhclNlc3Npb24iLCJoYW5kbGVTZXNzaW9uRXhwaXJ5IiwiY3VycmVudFN0YXRlIiwibWVzc2FnZXMiLCJ3aW5kb3ciLCJnZXRTYXZlZFBsYWNlcyIsImxhc3RVcmwiLCJsb2NhdGlvbiIsInBhdGhuYW1lIiwiaHJlZiIsImVuY29kZVVSSUNvbXBvbmVudCIsInJlbW92ZUl0ZW0iLCJ1cGRhdGVMYXN0QWN0aXZlIiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyIiwiZ2V0U3RvcmVkTWV0cmljc1dpdGhTZXNzaW9uIiwibWV0cmljc0RhdGEiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./utils/session-manager.ts\n");

/***/ })

};
;